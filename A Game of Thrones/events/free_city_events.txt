###Free City Events go here###

namespace = free_cities
#############################
# Free Cities Flavor Events #
#############################

# Free Cities teenagers want to become bravos
character_event = {
	id = free_cities.100
	desc = "EVTDESCFREECITIES100"
	picture = GFX_evt_child_sword
	
	min_age = 10
	max_age = 18
	capable_only = yes
	prisoner = no
	culture_group = free_cities
	
	trigger = {	
		# Some code to the effect that they should be in one of the free cities goes here
		NOT = { trait = duelist }
	}
	
	mean_time_to_happen = {
		months = 600
		
		modifier = {
			factor = 0.8
			trait = poor_warrior
		}
		modifier = {
			factor = 0.6
			trait = trained_warrior
		}
		modifier = {
			factor = 0.4
			trait = skilled_warrior
		}
		modifier = {
			factor = 0.2
			trait = master_warrior
		}
		
		modifier = {
			factor = 4
			trait = craven
		}
		modifier = {
			factor = 0.25
			trait = brave
		}
		modifier = {
			factor = 2
			trait = humble
		}
		modifier = {
			factor = 0.5
			trait = proud
		}
		modifier = {
			factor = 2
			trait = patient
		}
		modifier = {
			factor = 0.5
			trait = wroth
		}
		modifier = {
			factor = 2
			trait = kind
		}
		modifier = {
			factor = 0.5
			trait = cruel
		}
		
		modifier = {
			factor = 0.5
			educator = { trait = duelist }
		}
		
		modifier = {
			factor = 0.5
			any_friend = { trait = duelist }
		}
	}
	
	option = {
		name = "EVTOPTAFREECITIES100"
		add_trait = duelist
		hidden_tooltip = { educator = { character_event = { id = free_cities.1001 days = 30 random = 10 } } }
	}
}

character_event = {
	id = free_cities.1001
	desc = "EVTDESCFREECITIES1001"
	picture = GFX_evt_child_sword
	is_triggered_only = yes
	
	immediate = { FROM = { remove_trait = duelist } } # This decision will overwrite the previous event
	
	option = {
		name = "EVTOPTAFREECITIES1001"
		FROM = {
			add_trait = duelist
			hidden_tooltip = { character_event = { id = free_cities.1002 } }
		}
		ai_chance = {
			factor = 100
			
			modifier = {
				factor = 2
				trait = duelist
			}
			
			modifier = {
				factor = 0.1
				FROM = { is_female = yes }
				NOT = {
					AND = {
						is_female = yes
						trait = duelist
					}
				}
			}
			
			modifier = {
				factor = 0.5
				FROM = { is_weak_trigger = yes }
			}
			modifier = {
				factor = 2
				FROM = { is_strong_trigger = yes }
			}
		}
	}
	
	option = {
		name = "EVTOPTBFREECITIES1001"
		hidden_tooltip = { FROM = { character_event = { id = free_cities.1003 } } }
		ai_chance = { factor = 100 }
	}
}

character_event = {
	id = free_cities.1002
	desc = "EVTDESCFREECITIES1002"
	picture = GFX_evt_child_sword
	is_triggered_only = yes
	
	option = { name = "EVTOPTAFREECITIES1002" }
}

character_event = {
	id = free_cities.1003
	desc = "EVTDESCFREECITIES1003"
	picture = GFX_evt_child_sword
	is_triggered_only = yes
	
	option = { name = "EVTOPTAFREECITIES1003" }
}
# Pentos famine- kill Prince?
character_event = {
	id = free_cities.101
	desc = "EVTDESCFREECITIES101"
	picture = GFX_evt_child_sword
	
	only_playable = yes
	
	trigger = {
		has_landed_title = k_pentos
		is_republic = yes
		any_vassal = { 
			has_landed_title = d_prince_pentos
			is_patrician = no
			NOT = { character = ROOT }
		}
	}
	
	mean_time_to_happen = {
		years = 100
		
		modifier = {
			factor = 0.8
			capital_scope = { has_province_modifier = asoiaf_mild_winter }
		}
		modifier = {
			factor = 0.6
			capital_scope = { has_province_modifier = asoiaf_normal_winter }
		}
		modifier = {
			factor = 0.3
			capital_scope = { has_province_modifier = asoiaf_harsh_winter }
		}
		modifier = {
			factor = 0.8
			NOT = { stewardship = 5 }
		}
		modifier = {
			factor = 0.8
			NOT = { stewardship = 8 }
		}
		modifier = {
			factor = 0.8
			NOT = { stewardship = 11 }
		}
		modifier = {
			factor = 1.2
			stewardship = 15
		}
		modifier = {
			factor = 1.2
			stewardship = 18
		}
		modifier = {
			factor = 1.2
			stewardship = 21
		}
		modifier = {
			factor = 1.2
			stewardship = 24
		}
		modifier = {
			factor = 1.2
			stewardship = 27
		}
	}
	
	option = {
		name = "EVTOPTAFREECITIES101" #It must be done
		trigger = {
			prisoner = no
			NOT = { trait = incapable }
		}
		ai_chance = {
			factor = 75
			modifier = {
				factor = 2
				culture = pentosi
			}
			modifier = {
				factor = 0.5
				d_prince_pentos = {
					holder_scope = { is_close_relative = ROOT }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -24 } } }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -49 } } }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -74 } } }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -99 } } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 24 } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 49 } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 74 } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 99 } }
				}
			}		
			modifier = {
				factor = 2
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = just
			}
			modifier = {
				factor = 2
				trait = ruthless
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = cruel
			}
			modifier = {
				factor = 0.5
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = honorable
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.5
				trait = kind
			}
		}
		piety = 50
		d_prince_pentos = {
			holder_scope = { character_event = { id = free_cities.1011 tooltip = TOOLTIPfree_cities.1011 } }
		}
	}
	
	option = {
		name = "EVTOPTCFREECITIES101" #Not my choice
		trigger = {
			OR = {
				prisoner = yes
				trait = incapable
			}	
		}
		regent = {
			piety = 50
		}
		d_prince_pentos = {
			holder_scope = { character_event = { id = free_cities.1011 tooltip = TOOLTIPfree_cities.1011 } }
		}
	}
	
	option = {
		name = "EVTOPTBFREECITIES101" #No
		trigger = {
			prisoner = no
			NOT = { trait = incapable }
		}
		ai_chance = {
			factor = 5
		}
		piety = -50
		prestige = -50
		any_vassal = {
			limit = { culture = pentosi } 
			opinion = {
				who = ROOT
				modifier = opinion_no_execution
			}
		}
	}
}
#Prince informed
character_event = {
	id = free_cities.1011
	desc = "EVTDESCFREECITIES1011"
	picture = "GFX_evt_beheading"
	
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAFREECITIES1011" 
		hidden_tooltip = {
			FROM = {
				any_realm_lord = {
					limit = { 
						ai = no 
						NOT = { character = ROOT }
						NOT = { character = FROM }
					}
					character_event = { id = free_cities.1012 }
				}
			}
		}
		death = { 
			death_reason = death_sacrificed
			killer = FROM
		}
	}
}
#Realm informed
character_event = {
	id = free_cities.1012
	desc = "EVTDESCFREECITIES1012"
	picture = "GFX_evt_beheading"
	
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAFREECITIES1012" 
		FROM = { FROM = { tooltip = { } } }
	}
}

#Pentos lost war- kill Prince?
character_event = { #pentos lose aggressive war, root is defender
	id = free_cities.1023
	
	is_triggered_only = yes	
	hide_window = yes
	
	trigger = {
		FROM = {
			has_landed_title = k_pentos
			OR = {
				is_merchant_republic = yes
				is_republic = yes
			}
		}	
	}
	
	immediate = {
		FROM = { character_event = { id = free_cities.102 days = 1 } }
	}
	
	option = {
		name = OK
	}
}	
character_event = { #pentos lose defensive war, root is defender
	id = free_cities.102
	desc = "EVTDESCFREECITIES102"
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	trigger = {
		has_landed_title = k_pentos
		OR = {
			is_merchant_republic = yes
			is_republic = yes
		}
		any_vassal = { 
			has_landed_title = d_prince_pentos
			is_patrician = no
			NOT = { character = ROOT }
		}
		# NOT = { has_character_modifier = victory_timer }
		# OR = {
			# FROM = { has_character_modifier = victory_timer }
			# FROMFROM = { has_character_modifier = victory_timer } 
		# }
	}
	
	option = {
		name = "EVTOPTAFREECITIES101" #It must be done		
		trigger = {
			prisoner = no
			NOT = { trait = incapable }
		}
		ai_chance = {
			factor = 95
			modifier = {
				factor = 0.5
				d_prince_pentos = {
					holder_scope = { is_close_relative = ROOT }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -24 } } }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -49 } } }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -74 } } }
				}
			}
			modifier = {
				factor = 1.25
				d_prince_pentos = {
					holder_scope = { NOT = { reverse_opinion = { who = ROOT value = -99 } } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 24 } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 49 } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 74 } }
				}
			}
			modifier = {
				factor = 0.8
				d_prince_pentos = {
					holder_scope = { reverse_opinion = { who = ROOT value = 99 } }
				}
			}		
			modifier = {
				factor = 2
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = just
			}
			modifier = {
				factor = 2
				trait = ruthless
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = cruel
			}
			modifier = {
				factor = 0.5
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = honorable
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.5
				trait = kind
			}
		}
		piety = 50
		d_prince_pentos = {
			holder_scope = { character_event = { id = free_cities.1021 tooltip = TOOLTIPfree_cities.1011 } }
		}
	}
	
	option = {
		name = "EVTOPTCFREECITIES101" #Not my choice
		trigger = {
			OR = {
				prisoner = yes
				trait = incapable
			}	
		}
		regent = {
			piety = 50
		}
		d_prince_pentos = {
			holder_scope = { character_event = { id = free_cities.1021 tooltip = TOOLTIPfree_cities.1011 } }
		}
	}
	
	option = {
		name = "EVTOPTBFREECITIES101" #No
		trigger = {
			prisoner = no
			NOT = { trait = incapable }
		}
		ai_chance = {
			factor = 5
		}
		piety = -50
		prestige = -50
		any_vassal = {
			limit = { culture = pentosi } 
			opinion = {
				who = ROOT
				modifier = opinion_no_execution
			}
		}
	}
}
#Prince informed
character_event = {
	id = free_cities.1021
	desc = "EVTDESCFREECITIES1021"
	picture = "GFX_evt_beheading"
	
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAFREECITIES1011" 
		hidden_tooltip = {
			FROM = {
				any_realm_lord = {
					limit = { 
						ai = no 
						NOT = { character = ROOT }
						NOT = { character = FROM }
					}
					character_event = { id = free_cities.1022 }
				}
			}
		}
		death = { 
			death_reason = death_sacrificed
			killer = FROM
		}
	}
}
#Realm informed
character_event = {
	id = free_cities.1022
	desc = "EVTDESCFREECITIES1022"
	picture = "GFX_evt_beheading"
	
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAFREECITIES1022" 
		FROM = { FROM = { tooltip = { } } }
	}
}
#Inform character they are neww Prince
character_event = {
	id = free_cities.1025
	desc = "EVTDESCFREECITIES1025"
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAFREECITIES1025" 
		if = {
			limit = { is_feudal = yes }
			primary_title = { succession = primogeniture }
			recalc_succession = yes
		}
		k_pentos = {
			holder_scope = {
				character_event = { id = free_cities.1026 days = 1 }
				any_realm_lord = { 
					limit = { ai = no }
					character_event = { id = free_cities.1026 days = 1 } 
				}
			}
		}
	}
}
#Inform realm of new prince
character_event = {
	id = free_cities.1026	
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	desc = { #Inherited after death
		text = "EVTDESCFREECITIES1026"
		trigger = { FROMFROM = { is_alive = no } 	}	
	}
	desc = { #Nominated by magister
		text = "EVTDESCFREECITIES1026B"
		trigger = { FROMFROM = { is_alive = yes } }	
	}
	
	option = { 
		name = "EVTOPTAFREECITIES1026" 
	}
}
#prince succession maintenance
character_event = { #move courtiers back
	id = free_cities.1926
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		event_target:prince_successor = { 
			if = {
				limit = { is_ruler = yes }
				ROOT = { move_character = PREV }
			}	
			if = {
				limit = { is_ruler = no }
				liege = { ROOT = { move_character = PREV } }
			}
		}
	}

	option = {
		name = OK
	}
}
# Assign "Maid of the Fields" minor title
character_event = {
	id = free_cities.1027
	desc = "EVT_DESC_free_cities_1207"
	picture = "GFX_evt_throne_room"
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_landed_title = d_prince_pentos
		is_feudal = yes
		NOT = { higher_tier_than = DUKE }
		is_patrician = no
		liege = {
			is_republic = yes
			has_landed_title = k_pentos
		}
		NOT = {
			any_courtier = {
				is_female = yes
				is_married = no
				has_minor_title = title_maid_fields
			}
		}
	}
	
	option = { 
		name = "HIDDEN" 
		random_courtier = {
			limit = {
				is_female = yes
				culture = pentosi
				is_ruler = no
				is_married = no
				NOT = { has_minor_title = title_maid_fields }
				NOT = { has_minor_title = title_maid_seas }
				age = 14
				NOT = { age = 17 }
				trait = fair
			}
			give_minor_title = title_maid_fields
			add_trait = disinherited
			add_trait = forbid_marriage
			ROOT = { set_character_flag = maid_fields_chosen }
		}
		if = {
			limit = { NOT = { ROOT = { has_character_flag = maid_fields_chosen } } }
			random_courtier = {
				limit = {
					is_female = yes
					culture = pentosi
					is_ruler = no
					is_married = no
					NOT = { has_minor_title = title_maid_fields }
					NOT = { has_minor_title = title_maid_seas }
					age = 14
					NOT = { age = 17 }
				}
				give_minor_title = title_maid_fields
				add_trait = disinherited
				add_trait = forbid_marriage
				ROOT = { set_character_flag = maid_fields_chosen }
			}
		}
		if = {
			limit = { NOT = { ROOT = { has_character_flag = maid_fields_chosen } } }
			create_character = {
				random_traits = yes
				dynasty = NONE
				female = yes
				age = 16
			}
			new_character = {
				remove_trait = imbecile
				remove_trait = inbred
				remove_trait = slow
				remove_trait = infirm
				remove_trait = incapable
				remove_trait = leper
				remove_trait = possessed
				remove_trait = ill
				remove_trait = pneumonic
				remove_trait = maimed
				remove_trait = crippled
				add_trait = fair
				add_trait = disinherited
				add_trait = forbid_marriage
				give_minor_title = title_maid_fields
				ROOT = { set_character_flag = maid_fields_chosen }
			}
		}
		clr_character_flag = maid_fields_chosen
	}
}
# Assign "Maid of the Seas" minor title
character_event = {
	id = free_cities.1028
	desc = "HIDDEN"
	picture = "GFX_evt_throne_room"
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		has_landed_title = d_prince_pentos
		is_feudal = yes
		NOT = { higher_tier_than = DUKE }
		is_patrician = no
		liege = {
			is_republic = yes
			has_landed_title = k_pentos
		}
		NOT = {
			any_courtier = {
				is_female = yes
				is_married = no
				has_minor_title = title_maid_seas
			}
		}
	}
	
	option = { 
		name = "HIDDEN" 
		random_courtier = {
			limit = {
				is_female = yes
				culture = pentosi
				is_ruler = no
				is_married = no
				NOT = { has_minor_title = title_maid_fields }
				NOT = { has_minor_title = title_maid_seas }
				age = 14
				NOT = { age = 17 }
				trait = fair
			}
			give_minor_title = title_maid_seas
			add_trait = disinherited
			add_trait = forbid_marriage
			ROOT = { set_character_flag = maid_seas_chosen }
		}
		if = {
			limit = { NOT = { ROOT = { has_character_flag = maid_seas_chosen } } }
			random_courtier = {
				limit = {
					is_female = yes
					culture = pentosi
					is_ruler = no
					is_married = no
					NOT = { has_minor_title = title_maid_fields }
					NOT = { has_minor_title = title_maid_seas }
					age = 14
					NOT = { age = 17 }
				}
				give_minor_title = title_maid_seas
				add_trait = disinherited
				add_trait = forbid_marriage
				ROOT = { set_character_flag = maid_seas_chosen }
			}
		}
		if = {
			limit = { NOT = { ROOT = { has_character_flag = maid_seas_chosen } } }
			create_character = {
				random_traits = yes
				dynasty = NONE
				female = yes
				age = 16
			}
			new_character = {
				remove_trait = imbecile
				remove_trait = inbred
				remove_trait = slow
				remove_trait = infirm
				remove_trait = incapable
				remove_trait = leper
				remove_trait = possessed
				remove_trait = ill
				remove_trait = pneumonic
				remove_trait = maimed
				remove_trait = crippled
				add_trait = fair
				add_trait = disinherited
				add_trait = forbid_marriage
				give_minor_title = title_maid_seas
				ROOT = { set_character_flag = maid_seas_chosen }
			}
		}
		clr_character_flag = maid_seas_chosen
	}
}
# Have a feast and the Prince of Pentos deflowers the maids
character_event = {
	id = free_cities.1029
	desc = "EVT_DESC_free_cities_1209"
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	only_playable = yes
	prisoner = no
	war = no
	
	trigger = {
		has_landed_title = k_pentos
		is_republic = yes
		d_prince_pentos = {
			holder_scope = {
				liege = { character = ROOT }
				any_courtier = {
					has_minor_title = title_maid_fields
				}
				any_courtier = {
					has_minor_title = title_maid_seas
				}
			}
		}
		NOT = { has_character_modifier = holding_large_feast }	
	}
	
	option = {
		name = "EVT_OPTA_free_cities_1209" # Hold the feast
		ai_chance = {
			factor = 45
			modifier = {
				factor = 1.2
				trait = gregarious
			}
			modifier = {
				factor = 1.2
				trait = drunkard
			}
			modifier = {
				factor = 1.2
				trait = ambitious
			}
			modifier = {
				factor = 1.2
				trait = kind
			}
		}
		treasury = -50			
		add_character_modifier = {
			name = holding_large_feast
			duration = 365
		}		
		hidden_tooltip = {
			set_character_flag = feastcooldown
			clr_character_flag = coming_to_feast		
			clr_character_flag = guest_feast_started				
			character_event = {
				id = 72003
				days = 25
				random = 10
			}			
			letter_event = { 
				id = 72109  
			}
			character_event = { id = 72999 days = 150 } # Safety catch flag clearing
			set_character_flag = prince_deflower_maids
		}
	}
	
	option = {
		name = "EVT_OPTB_free_cities_1209" # Do not hold the feast
		ai_chance = {
			factor = 5
			modifier = {
				factor = 1.2
				trait = paranoid
			}
			modifier = {
				factor = 1.2
				trait = arbitrary
			}
			modifier = {
				factor = 1.2
				trait = selfish
			}
			modifier = {
				factor = 1.2
				has_character_flag = loan_default
			}
		}
		any_vassal = {
			limit = {
				culture = pentosi
			}
			opinion = {
				who = ROOT
				modifier = opinion_disappointed
				years = 2
			}
		}
		prestige = -150
	}
		
}
###Golden Company hiring events###
character_event = {
	id = free_cities.2
	desc = "EVTDESCfree_cities.2"
	
	is_triggered_only = yes
	war = no
	
	trigger = {
		FROM = { is_alive = yes }
		in_command = no
		NOT = { demesne_size = 1 }
	}
	
	option = {
		name = "EVTOPTAfree_cities.2" #I demand much gold
		trigger = { FROM = { ai = no } }
		ai_chance = {
			factor = 20
			modifier = {
				factor = 4
				trait = greedy
			}
			modifier = {
				factor = 0.5
				trait = charitable
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 2
				trait = deceitful
			}
			modifier = {
				factor = 0.5
				trait = honest
			}
			modifier = {
				factor = 0.9
				NOT = { opinion = { who = FROM value = 0 } }
			}
			modifier = {
				factor = 0.9
				NOT = { opinion = { who = FROM value = -20 } }
			}
			modifier = {
				factor = 0.9
				NOT = { opinion = { who = FROM value = -40 } }
			}
			modifier = {
				factor = 0.9
				NOT = { opinion = { who = FROM value = -60 } }
			}
			modifier = {
				factor = 0.9
				NOT = { opinion = { who = FROM value = -80 } }
			}
			modifier = {
				factor = 0.9
				NOT = { opinion = { who = FROM value = -99 } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 12 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 10 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 8 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 6 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 4 } } }
			}
		}
		if = {
			limit = { trait = greedy }
			random_list = {
				20 = { set_character_flag = demand_500_gold }
				20 = { set_character_flag = demand_400_gold }
				20 = { set_character_flag = demand_300_gold }
				20 = { set_character_flag = demand_200_gold }
				20 = { set_character_flag = demand_100_gold }
			}
		}
		if = {
			limit = { NOT = { trait = greedy } }
			random_list = {
				5 = { set_character_flag = demand_500_gold }
				10 = { set_character_flag = demand_400_gold }
				20 = { set_character_flag = demand_300_gold }
				30 = { set_character_flag = demand_200_gold }
				35 = { set_character_flag = demand_100_gold }
			}
		}
		FROM = { letter_event = { id = free_cities.3 } }
	}	
	option = {
		name = "EVTOPTBfree_cities.2" #Yes
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				FROM = { ai = yes }
			}
			modifier = {
				factor = 1.5
				trait = ambitious
			}
			modifier = {
				factor = 0.75
				trait = content
			}
			modifier = {
				factor = 1.5
				trait = diligent
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
			modifier = {
				factor = 1.3
				opinion = { who = FROM value = 20 } 
			}
			modifier = {
				factor = 1.3
				opinion = { who = FROM value = 40 } 
			}
			modifier = {
				factor = 1.3
				opinion = { who = FROM value = 60 } 
			}
			modifier = {
				factor = 1.3
				opinion = { who = FROM value = 80 } 
			}
			modifier = {
				factor = 1.3
				opinion = { who = FROM value = 100 } 
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = 0 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -20 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -40 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -60 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -80 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -99 } }
			}
			modifier = {
				factor = 1.2
				FROM = { job_chancellor = { diplomacy = 14 } } 
			}
			modifier = {
				factor = 1.2
				FROM = { job_chancellor = { diplomacy = 16 } } 
			}
			modifier = {
				factor = 1.2
				FROM = { job_chancellor = { diplomacy = 18 } } 
			}
			modifier = {
				factor = 1.2
				FROM = { job_chancellor = { diplomacy = 20 } } 
			}
			modifier = {
				factor = 1.2
				FROM = { job_chancellor = { diplomacy = 24 } } 
			}
			modifier = {
				factor = 1.2
				FROM = { job_chancellor = { diplomacy = 26 } } 
			}
			modifier = {
				factor = 1.2
				FROM = { job_chancellor = { diplomacy = 28 } } 
			}
		}
		FROM = { letter_event = { id = free_cities.4 } }
	}	
	option = {
		name = "EVTOPTCfree_cities.2" #No
		ai_chance = {
			factor = 20
			modifier = {
				factor = 2
				FROM = { ai = yes }
			}
			modifier = {
				factor = 0.75
				trait = ambitious
			}
			modifier = {
				factor = 1.5
				trait = content
			}
			modifier = {
				factor = 0.75
				trait = diligent
			}
			modifier = {
				factor = 1.5
				trait = slothful
			}
			modifier = {
				factor = 1.2
				NOT = { opinion = { who = FROM value = 0 } }
			}
			modifier = {
				factor = 1.2
				NOT = { opinion = { who = FROM value = -20 } }
			}
			modifier = {
				factor = 1.2
				NOT = { opinion = { who = FROM value = -40 } }
			}
			modifier = {
				factor = 1.2
				NOT = { opinion = { who = FROM value = -60 } }
			}
			modifier = {
				factor = 1.2
				NOT = { opinion = { who = FROM value = -80 } }
			}
			modifier = {
				factor = 1.2
				NOT = { opinion = { who = FROM value = -99 } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 12 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 10 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 8 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 6 } } }
			}
			modifier = {
				factor = 1.1
				FROM = { job_chancellor = { NOT = { diplomacy = 4 } } }
			}
		}
		FROM = { letter_event = { id = free_cities.5 } }
	}	
	
}
#inform commander demands gold
letter_event = {
	id = free_cities.3
	desc = "EVTDESCfree_cities.3"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAfree_cities.3" #OK
		if = {
			limit = { FROM = { has_character_flag = demand_500_gold } }
			custom_tooltip = { text = TOOLTIPGOLDENCOMPANY500 }
			hidden_tooltip = { wealth = -500 FROM = { wealth = 500 } }
		}
		if = {
			limit = { FROM = { has_character_flag = demand_400_gold } }
			custom_tooltip = { text = TOOLTIPGOLDENCOMPANY400 }
			hidden_tooltip = { wealth = -400 FROM = { wealth = 400 } }
		}
		if = {
			limit = { FROM = { has_character_flag = demand_300_gold } }
			custom_tooltip = { text = TOOLTIPGOLDENCOMPANY300 }
			hidden_tooltip = { wealth = -300 FROM = { wealth = 300 } }
		}
		if = {
			limit = { FROM = { has_character_flag = demand_200_gold } }
			custom_tooltip = { text = TOOLTIPGOLDENCOMPANY200 }
			hidden_tooltip = { wealth = -200 FROM = { wealth = 200 } }
		}
		if = {
			limit = { FROM = { has_character_flag = demand_100_gold } }
			custom_tooltip = { text = TOOLTIPGOLDENCOMPANY100 }
			hidden_tooltip = { wealth = -100 FROM = { wealth = 100 } }
		}
		custom_tooltip = { text = TOOLTIPCANHIREGOLDENCOMPANY }
		set_character_flag = golden_company_hired
	}	
	option = {
		name = "EVTOPTBfree_cities.3" #No
		set_character_flag = golden_company_decision
	}	
}
#inform commander accepts offer
letter_event = {
	id = free_cities.4
	desc = "EVTDESCfree_cities.4"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAfree_cities.4" #OK
		custom_tooltip = { text = TOOLTIPCANHIREGOLDENCOMPANY }
		set_character_flag = golden_company_hired
	}	
	option = {
		name = "EVTOPTBfree_cities.4" #No
		trigger = { ai = no }
		set_character_flag = golden_company_decision
	}	
}
#inform commander declines
letter_event = {
	id = free_cities.5
	desc = "EVTDESCfree_cities.5"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTBfree_cities.5" #OK
		set_character_flag = golden_company_decision
	}	
}
#iflag cleanup
character_event = {
	id = free_cities.6
	desc = "EVTDESCfree_cities.6"
	
	only_rulers = yes
	
	is_triggered_only = yes
	
	trigger = {
		had_character_flag = { flag = golden_company_hired days = 200 }
		d_golden_company = {
			holder_scope = {
				OR = {
					in_command = no
					war = yes
					demesne_size = 1 
				}	
			}
		}
	}
	
	option = {
		name = "OK" #OK
		clr_character_flag = golden_company_hired
	}	
}

#### Braavos celebrates the anniversary of the Uncloaking
character_event = {
	id = free_cities.8
	desc = "EVTDESCfree_cities.8"
	picture = "GFX_braavos" 
	
	is_triggered_only = yes
	only_playable = yes
	prisoner = no
	war = no
	
	trigger = {		
		OR = {
			has_landed_title = k_braavos
			has_landed_title = e_braavos
			capital_scope = { province_id = 470 }
		}
		in_command = no
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_modifier = holding_large_feast }		
	}
	
	option = {
		name = "EVTOPTAfree_cities.8" # Hold the feast
		ai_chance = {
			factor = 45
			
			modifier = {
				factor = 3
				culture = braavosi
			}
			modifier = {
				factor = 2
				trait = gregarious
			}
			modifier = {
				factor = 2
				trait = drunkard
			}
			modifier = {
				factor = 2
				trait = charitable
			}
			modifier = {
				factor = 2
				trait = gluttonous
			}
			modifier = {
				factor = 2
				trait = hedonist
			}
			modifier = {
				factor = 1.5
				trait = kind
			}
		}
		treasury = -60			
		add_character_modifier = {
			name = holding_large_feast
			duration = 365
		}		
		hidden_tooltip = {
			set_character_flag = feastcooldown
			clr_character_flag = coming_to_feast		
			clr_character_flag = guest_feast_started		
			set_character_flag = do_not_disturb			
			character_event = {
				id = 72003
				days = 25
				random = 10
			}	
			character_event = { id = 72112 days = 25 } #cancel feast
			letter_event = { 
				id = 72109  
			}
			character_event = { id = 72999 days = 150 } # Safety catch flag clearing
		}
	}
	
	option = {
		name = "EVTOPTBfree_cities.8" # Do not hold the feast
		ai_chance = {
			factor = 5
			modifier = {
				factor = 2
				trait = greedy
			}
			modifier = {
				factor = 2
				trait = temperate
			}
			modifier = {
				factor = 2
				trait = shy
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 2
				trait = selfish
			}
			modifier = {
				factor = 3
				has_character_modifier = loan_timer
				OR = {
					stewardship = 9
					trait = temperate
					NOT = { 
						OR = {
							trait = gluttonous 
							trait = hedonist
							trait = slothful
						}	
					}	
				}
			}
		}
		any_vassal = {
			limit = {
				culture = braavosi
			}
			opinion = {
				who = ROOT
				modifier = opinion_disappointed
				years = 2
			}
		}
		if = {
			limit = { culture = braavosi }
			prestige = -150
		}	
	}		
}

######  Courtesans of Braavos events.

#courtesan gains trait at 16
character_event = { 
	id = free_cities.9
	desc = "EVTDESCfree_cities.9"
	picture = GFX_evt_wildlings

	hide_from = yes
	is_triggered_only = yes
	min_age = 16
	max_age = 17
	only_women = yes

	trigger = {
		OR = {
			dynasty = 300513
			dynasty = 700010
			dynasty = 700011
			dynasty = 700012
			dynasty = 700013
			dynasty = 700014
			dynasty = 700015
			dynasty = 700016
			dynasty = 700017
		}
		NOT = { trait = courtesan }
		NOT = { trait = former_courtesan }
	}

	immediate = { add_trait = courtesan }

	option = {
		name = "EVTOPTAfree_cities.9"
		add_trait = courtesan
		add_trait = fair
		c_braavos = {
			holder_scope = {
				ROOT = { move_character = PREV }
			}
		}
		if = {
			limit = { dynasty = 300513 }
			give_nickname = nick_black_pearl
		}
		if = {
			limit = { dynasty = 700010 }
			give_nickname = nick_mistress_swords
		}
		if = {
			limit = { dynasty = 700011 }
			give_nickname = nick_wild_flower
		}
		if = {
			limit = { dynasty = 700012 }
			give_nickname = nick_vieled_lady
		}
		if = {
			limit = { dynasty = 700013 }
			give_nickname = nick_merling_queen
		}
		if = {
			limit = { dynasty = 700014 }
			give_nickname = nick_moonshadow
		}
		if = {
			limit = { dynasty = 700015 }
			give_nickname = nick_daughter_dusk
		}
		if = {
			limit = { dynasty = 700016 }
			give_nickname = nick_nightingale
		}
		if = {
			limit = { dynasty = 700017 }
			give_nickname = nick_poetess
		}
	}
}

#courtesan loses trait at 43 when daughter recieves trait
character_event = { 
	id = free_cities.10
	desc = "EVTDESCfree_cities.10"
	picture = GFX_evt_throne_room
	
	is_triggered_only = yes
	min_age = 43
	max_age = 44
	only_women = yes

	trigger = {
		trait = courtesan
	}

	option = {
		name = "EVTOPTAfree_cities.10"
		remove_trait = courtesan
		add_trait = former_courtesan
		remove_nickname = yes
	}
}

#courtesan automatically has daughter to continue the line
character_event = {
	id = free_cities.11
	desc = "EVTDESCfree_cities.11"
	picture = GFX_evt_pregnancy
	
	is_triggered_only = yes
	min_age = 27
	max_age = 28
	only_women = yes
	capable_only = yes
	
	trigger = {
		trait = courtesan
	}
	
	option = {
		name = "EVTOPTAfree_cities.11"
		hidden_tooltip = {
			create_character = {
				age = 0
				female = yes
			}
			new_character = {
				set_mother = PREV
				dynasty = PREV
			}
		}
	}
}

#courtesan automatically move to Braavos
character_event = {
	id = free_cities.12
	desc = "EVTDESCfree_cities.12"
	picture = GFX_evt_pregnancy
	
	is_triggered_only = yes
	only_women = yes
	prisoner = no
	
	trigger = {
		trait = courtesan
		NOT = { liege = { has_landed_title = c_braavos } }
	}
	
	option = {
		name = "EVTOPTAfree_cities.12"
		if = {
			limit = {
				OR = {
					trait = slave
					is_consort = yes
					is_married = yes
					trait = silent_sister
					has_character_flag = exiled
				}
			}
			remove_trait = courtesan
			break = yes
		}
		c_braavos = {
			holder_scope = {
				ROOT = { move_character = PREV }
			}
		}
	}
}

###Three Daughters Events###
character_event = { #Inform new 'king' of the triarchy
	id = free_cities.13
	
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		any_realm_lord = {
			limit = {
				ai = no
				NOT = { character = ROOT }
			}
			character_event = { id = free_cities.14 }
		}
	}
	
	option = {
		name = OK
		set_character_flag = elected_triarchy_leader
	}
}
#Inform realm of new king
character_event = {
	id = free_cities.14
	desc = "EVTDESCfree_cities.14"
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	option = { 
		name = OK
	}
}
#Triarchy disbanded after lost war
character_event = {
	id = free_cities.15
	desc = "EVTDESCfree_cities.15"
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = {
			any_realm_lord = {
				limit = {
					ai = no
					NOT = { character = ROOT }
				}
				character_event = { id = free_cities.16 }
			}
			if = {
				limit = { has_character_flag = conquest }
				any_vassal = { 
					limit = { 
						NOT = { tier = BARON } 
						lower_tier_than = FROM
					}
					set_defacto_liege = FROM 
					any_demesne_title = { revoke_law = republic_alliance_member }
				}
				any_vassal = { 
					limit = { 
						NOT = { tier = BARON } 
						NOT = { lower_tier_than = FROM }
					}
					any_demesne_title = {
						limit = {
							controls_religion = no
							NOT = { lower_tier_than = FROM }
						}
						usurp_title = { target = FROM type = invasion }
						revoke_law = republic_alliance_member
					}
					set_defacto_liege = FROM
				}
				any_demesne_title = { 
					limit = { has_title_flag = alliance_government }
					clr_title_flag = alliance_government
					destroy_landed_title = ROOT 
					hidden_tooltip = {
						if = {
							limit = { title = e_three_daughters }
							any_direct_de_jure_vassal_title = {
								de_jure_liege = e_new_valyria
							}
						}	
					}
				}
			}
		}	
	}
	
	option = { 
		name = "EVTOPTAfree_cities.15" 
		hidden_tooltip = {
			if = {
				limit = { NOT = { has_character_flag = conquest } }
				any_vassal = { 
					limit = { NOT = { tier = BARON } }
					set_defacto_liege = THIS 
					any_demesne_title = { revoke_law = republic_alliance_member }
				}
			}						
		}
		any_demesne_title = { 
			limit = { has_title_flag = alliance_government }
			clr_title_flag = alliance_government
			destroy_landed_title = ROOT 
			hidden_tooltip = {
				if = {
					limit = { title = e_three_daughters }
					any_direct_de_jure_vassal_title = {
						de_jure_liege = e_new_valyria
					}
				}	
			}
		}
		clr_character_flag = conquest
	}
}
character_event = { #Inform realm 
	id = free_cities.16
	desc = "EVTDESCfree_cities.16"
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAfree_cities.15" 
	}
}
#leader of the triarchy gets opinion bonus with members
character_event = { 
	id = free_cities.17

	only_independent = yes
	hide_window = yes
	has_character_flag = elected_triarchy_leader
	
	trigger = {
		tier = EMPEROR
		government = alliance_government
		any_vassal = {
			is_merchant_republic = yes
			any_demesne_title = {
				has_law = republic_alliance_member
			}
			NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_triarchy_three_daughters } }
		}	
	}
	
	immediate = {
		any_vassal = {
			limit = {
				is_merchant_republic = yes
				any_demesne_title = {
					has_law = republic_alliance_member
				}
				NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_triarchy_three_daughters } }
			}
			opinion = { who = ROOT modifier = opinion_triarchy_three_daughters }
			diplomatic_immunity = yes
		}
	}
	
	option = { 
		name = OK
	}
}

# Triarchy established
character_event = {
	id = free_cities.18
	picture = GFX_evt_throne_room
	
	is_triggered_only = yes
	
	desc = {
		text = EVTDESCAfree_cities.18
		trigger = {
			OR = {
				has_landed_title = k_myr
				has_landed_title = k_lys
				has_landed_title = k_tyrosh
			}
		}
	}
	desc = {
		text = EVTDESCBfree_cities.18
		trigger = {
			NOT = { has_landed_title = k_myr }
			NOT = { has_landed_title = k_lys }
			NOT = { has_landed_title = k_tyrosh }
		}
	}
	
	option = {
		name = EVTOPTAfree_cities.18
	}
}

####  Princes of Lorath

#Inform character they are neww Prince
character_event = {
	id = free_cities.11025
	desc = "EVTDESCFREECITIES11025"
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAFREECITIES1025" 
		if = {
			limit = { is_feudal = yes }
			primary_title = { succession = primogeniture }
			recalc_succession = yes
		}
		k_lorath = {
			holder_scope = {
				character_event = { id = free_cities.11026 days = 1 }
				any_realm_lord = { 
					limit = { ai = no }
					character_event = { id = free_cities.11026 days = 1 } 
				}
			}
		}
	}
}
#Inform realm of new prince
character_event = {
	id = free_cities.11026
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	desc = { #Inherited after death
		text = "EVTDESCFREECITIES11026"
		trigger = { FROMFROM = { is_alive = no } 	}	
	}
	desc = { #Nominated by magister
		text = "EVTDESCFREECITIES11026B"
		trigger = { FROMFROM = { is_alive = yes } }	
	}
	
	option = { 
		name = "EVTOPTAFREECITIES11026" 
	}
}
#Elect secondary Princes
character_event = {
	id = free_cities.11027
	
	is_triggered_only = yes #check yearly
	hide_window = yes
	war = no
	
	trigger = {
		is_republic = yes
		has_landed_title = k_lorath
	}
	
	immediate = {
		##Fisher Prince
		#Check existing
		event_target:title_fisher_prince = {
			if = {
				limit = {
					OR = {
						is_alive = no
						NOR = {
							character = ROOT
							any_liege = {
								OR = {
									character = ROOT
									liege_before_war = { character = ROOT }
								}
							}
						}
					}
				}
				clr_character_flag = title_fisher_prince
				clear_global_event_target = title_fisher_prince
			}
		}
		#If one exists, make sure they have the title
		event_target:title_fisher_prince = { 
			if = {
				limit = {
					is_alive = yes
					OR = {
						character = ROOT
						any_liege = {
							OR = {
								character = ROOT
								liege_before_war = { character = ROOT }
							}
						}
					}
					has_character_flag = title_fisher_prince
					NOT = { has_minor_title = title_fisher_prince }
				}
				give_minor_title = title_fisher_prince
			}
		} 
		#Find a new one if needed
		if = {
			limit = { NOT = { event_target:title_fisher_prince = { always = yes } } }
			random_list = {
				33 = { #Existing noble from patrician family
					random_realm_character = {
						limit = {
							is_female = no
							age = 18
							is_ruler = no
							is_primary_heir = no
							culture = lorathi
							NOT = { trait = incapable }
							can_press_claims_trigger = yes
							liege = {
								dynasty = PREV
								is_patrician = yes						
							}
						}
						set_character_flag = title_fisher_prince
						save_global_event_target_as = title_fisher_prince
						give_minor_title = title_fisher_prince
					}
				}
				33 = { #random noble merchant
					471 = {#Lorath
						ROOT = {			
							create_random_steward = {
								random_traits = yes
								dynasty = culture
								religion = PREV
								culture = lorathi
								female = no
							}
							new_character = {
								set_character_flag = title_fisher_prince
								save_global_event_target_as = title_fisher_prince
								give_minor_title = title_fisher_prince
							}
						}	
					}
				}	
				33 = { #random common merchant
					471 = {#Lorath
						ROOT = {			
							create_random_steward = {
								random_traits = yes
								dynasty = none
								religion = PREV
								culture = lorathi
								female = no
							}
							new_character = {
								change_stewardship = 4
								set_character_flag = title_fisher_prince
								save_global_event_target_as = title_fisher_prince
								give_minor_title = title_fisher_prince
							}
						}	
					}
				}
			}
			character_event = { id = free_cities.11028 days = 1 }
			any_realm_lord = { 
				limit = { ai = no }
				character_event = { id = free_cities.11028 days = 1 } 
			}
		}
		
		##Prince of The Streets
		#Check existing
		event_target:title_princeof_the_streets = {
			if = {
				limit = {
					OR = {
						is_alive = no
						NOR = {
							character = ROOT
							any_liege = {
								OR = {
									character = ROOT
									liege_before_war = { character = ROOT }
								}
							}
						}
					}
				}
				clr_character_flag = title_prince_of_the_streets
				clear_global_event_target = title_prince_of_the_streets
			}
		}
		#If one exists, make sure they have the title
		event_target:title_prince_of_the_streets = { 
			if = {
				limit = {
					is_alive = yes
					OR = {
						character = ROOT
						any_liege = {
							OR = {
								character = ROOT
								liege_before_war = { character = ROOT }
							}
						}
					}
					has_character_flag = title_prince_of_the_streets
					NOT = { has_minor_title = title_prince_of_the_streets }
				}
				give_minor_title = title_prince_of_the_streets
			}
		} 
		#Find a new one if needed
		if = {
			limit = { NOT = { event_target:title_prince_of_the_streets = { always = yes } } }
			random_list = {
				33 = { #Existing noble family
					random_realm_character = {
						limit = {
							is_female = no
							age = 18
							is_ruler = no
							is_primary_heir = no
							culture = lorathi
							NOT = { trait = incapable }
							can_press_claims_trigger = yes
							liege = { dynasty = PREV	}
						}
						set_character_flag = title_prince_of_the_streets
						save_global_event_target_as = title_prince_of_the_streets
						give_minor_title = title_prince_of_the_streets
					}
				}
				33 = { #random noble
					471 = {#Lorath
						ROOT = {			
							create_character = {
								random_traits = yes
								dynasty = culture
								religion = PREV
								culture = lorathi
								female = no
							}
							new_character = {
								set_character_flag = title_prince_of_the_streets
								save_global_event_target_as = title_prince_of_the_streets
								give_minor_title = title_prince_of_the_streets
							}
						}	
					}
				}	
				33 = { #random commoner
					471 = {#Lorath
						ROOT = {			
							create_character = {
								random_traits = yes
								dynasty = none
								religion = PREV
								culture = lorathi
								female = no
							}
							new_character = {
								set_character_flag = title_prince_of_the_streets
								save_global_event_target_as = title_prince_of_the_streets
								give_minor_title = title_prince_of_the_streets
							}
						}	
					}
				}
			}
			character_event = { id = free_cities.11029 days = 1 }
			any_realm_lord = { 
				limit = { ai = no }
				character_event = { id = free_cities.11029 days = 1 } 
			}
		}
	}
	
	option = { 
		name = "OK"
	}
}
#Inform realm of new Fisher Prince
character_event = {
	id = free_cities.11028
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	desc = "EVTDESCFREECITIES11028"
	
	option = { 
		name = "EVTOPTAFREECITIES11026" 
		event_target:title_fisher_prince = { tooltip = { } }
	}
}
#Inform realm of new Prince of the Streets
character_event = {
	id = free_cities.11029
	picture = "GFX_evt_throne_room"
	
	is_triggered_only = yes
	
	desc = "EVTDESCFREECITIES11029"
	
	option = { 
		name = "EVTOPTAFREECITIES11026" 
		event_target:title_princeof_the_streets = { tooltip = { } }
	}
}

### Qohor Events ###

#Prisoner sacrificed to black goat
character_event = {
	id = free_cities.200
	desc = "EVTDESCfree_cities.200"
	
	picture = GFX_evt_bishop_aztec
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = "EVTOPTAfree_cities.200"
	}
}
character_event = {
	id = free_cities.201
	desc = "EVTDESCfree_cities.201"
	
	picture = GFX_evt_bishop_aztec
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAfree_cities.201"
		death = {
			death_reason = death_sacrificed
			killer = FROM
		}
	}
}

# Qohor crisis- sacrifice children?
character_event = {
	id = free_cities.202	
	picture = GFX_evt_bishop_aztec
	border = GFX_event_normal_frame_war
	
	only_playable = yes
	religion = black_goat
	
	desc = { #famine
		text = "EVTDESCFREECITIES202"
		trigger = {
			is_primary_war_defender = no
		}
	}
	desc = { #war
		text = "EVTDESCFREECITIES202B"
		trigger = {
			is_primary_war_defender = yes
		}
	}
	
	trigger = {	
		higher_tier_than = COUNT
		OR = {
			independent = yes
			is_primary_war_defender = yes
		}
		OR = {
			NOT = { has_character_flag = black_goat_crisis_sacrifice }
			had_character_flag = { flag = black_goat_crisis_sacrifice days = 1825 }
		}
	}
	
	mean_time_to_happen = {
		years = 100
		
		modifier = {
			factor = 0.005
			is_primary_war_defender = yes
			any_war = {
				defender = { character = ROOT }
				war_score = 30
			}
		}
		modifier = {
			factor = 0.8
			capital_scope = { has_province_modifier = asoiaf_mild_winter }
		}
		modifier = {
			factor = 0.6
			capital_scope = { has_province_modifier = asoiaf_normal_winter }
		}
		modifier = {
			factor = 0.3
			capital_scope = { has_province_modifier = asoiaf_harsh_winter }
		}
		modifier = {
			factor = 0.8
			NOT = { stewardship = 5 }
		}
		modifier = {
			factor = 0.8
			NOT = { stewardship = 8 }
		}
		modifier = {
			factor = 0.8
			NOT = { stewardship = 11 }
		}
		modifier = {
			factor = 1.2
			stewardship = 15
		}
		modifier = {
			factor = 1.2
			stewardship = 18
		}
		modifier = {
			factor = 1.2
			stewardship = 21
		}
		modifier = {
			factor = 1.2
			stewardship = 24
		}
		modifier = {
			factor = 1.2
			stewardship = 27
		}
	}
	
	option = {
		name = "EVTOPTAFREECITIES202" #It must be done
		trigger = {
			prisoner = no
			NOT = { trait = incapable }
		}
		ai_chance = {
			factor = 150	
			modifier = {
				factor = 10
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = just
			}
			modifier = {
				factor = 2
				trait = ruthless
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = cruel
			}
			modifier = {
				factor = 0.2
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = honorable
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.5
				trait = kind
			}
			modifier = {
				factor = 0.2
				trait = familyperson
			}
		}
		piety = 75
		custom_tooltip = {
			text = TOOLTIPFREECITIES202
			hidden_tooltip = {
				character_event = { id = free_cities.203 }
				any_vassal = {
					limit = {
						NOT = { tier = BARON }
						is_theocracy = no
						religion = black_goat
						NOT = { trait = kingsguard }
						NOT = { trait = archmaester }
					}
					character_event = { id = free_cities.203 }
				}
				character_event = { id = free_cities.204 days = 2 } #sacrifices made
			}
		}
		clr_character_flag = black_goat_crisis_sacrifice
		set_character_flag = black_goat_crisis_sacrifice
	}
	
	option = {
		name = "EVTOPTCFREECITIES202" #Not my choice
		trigger = {
			OR = {
				prisoner = yes
				trait = incapable
			}	
		}
		regent = {
			piety = 75
		}
		custom_tooltip = {
			text = TOOLTIPFREECITIES202
			hidden_tooltip = {
				character_event = { id = free_cities.203 }
				any_vassal = {
					limit = {
						NOT = { tier = BARON }
						is_theocracy = no
						religion = black_goat
						NOT = { trait = kingsguard }
						NOT = { trait = archmaester }
					}
					character_event = { id = free_cities.203 }
				}
				character_event = { id = free_cities.204 days = 2 } #sacrifices made
			}
		}
		clr_character_flag = black_goat_crisis_sacrifice
		set_character_flag = black_goat_crisis_sacrifice
	}
	
	option = {
		name = "EVTOPTBFREECITIES202" #No
		trigger = {
			prisoner = no
			NOT = { trait = incapable }
		}
		ai_chance = {
			factor = 5
		}
		piety = -125
		prestige = -125
		any_vassal = {
			limit = { religion = black_goat } 
			opinion = {
				who = ROOT
				modifier = opinion_no_execution
			}
		}
		clr_character_flag = black_goat_crisis_sacrifice
		set_character_flag = black_goat_crisis_sacrifice
	}
}
# Noble chooses sacrifice
character_event = {
	id = free_cities.203
	picture = GFX_evt_bishop_aztec
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
		
	desc = { #famine
		text = "EVTDESCFREECITIES203"
		trigger = {
			NOT = { character = FROM }
			FROM = { is_primary_war_defender = no }
		}
	}
	desc = { #war
		text = "EVTDESCFREECITIES203B"
		trigger = {
			NOT = { character = FROM }
			FROM = { is_primary_war_defender = yes }
		}
	}
	desc = { #Is Ruler
		text = "EVTDESCFREECITIES203C"
		trigger = {
			character = FROM
		}
	}
	
	immediate = {
		#find potential sacrifices
		random_courtier = {
			limit = {
				OR = {
					is_child_of = ROOT
					father_even_if_dead = { is_child_of = ROOT }
					mother_even_if_dead = { is_child_of = ROOT }
				}	
				dynasty = ROOT
				is_alive = yes
				is_ruler = no
				liege = { character = ROOT }
			}
			save_event_target_as = black_goat_sacrifice_1
			set_character_flag = black_goat_sacrifice_choice
		}
		random_courtier = {
			limit = {
				OR = {
					is_child_of = ROOT
					father_even_if_dead = { is_child_of = ROOT }
					mother_even_if_dead = { is_child_of = ROOT }
				}	
				dynasty = ROOT
				is_alive = yes
				is_ruler = no
				liege = { character = ROOT }
				NOT = { has_character_flag = black_goat_sacrifice_choice }
			}
			save_event_target_as = black_goat_sacrifice_2
			set_character_flag = black_goat_sacrifice_choice
		}
		random_courtier = {
			limit = {
				OR = {
					is_child_of = ROOT
					father_even_if_dead = { is_child_of = ROOT }
					mother_even_if_dead = { is_child_of = ROOT }
				}	
				dynasty = ROOT
				is_alive = yes
				is_ruler = no
				liege = { character = ROOT }
				NOT = { has_character_flag = black_goat_sacrifice_choice }
			}
			save_event_target_as = black_goat_sacrifice_3
			set_character_flag = black_goat_sacrifice_choice
		}
		random_courtier = {
			limit = {
				OR = {
					is_child_of = ROOT
					father_even_if_dead = { is_child_of = ROOT }
					mother_even_if_dead = { is_child_of = ROOT }
				}	
				dynasty = ROOT
				is_alive = yes
				is_ruler = no
				liege = { character = ROOT }
				NOT = { has_character_flag = black_goat_sacrifice_choice }
			}
			save_event_target_as = black_goat_sacrifice_4
		}
		#If no children select random relative
		if = {
			limit = { NOT = { event_target:black_goat_sacrifice_1 = { always = yes } } }
			random_courtier = {
				limit = {
					is_alive = yes
					is_ruler = no
					liege = { character = ROOT }
					dynasty = ROOT
					NOT = { character = ROOT }
				}
				save_event_target_as = black_goat_sacrifice_1
				set_character_flag = black_goat_sacrifice_choice
			}
			#If no kin, random courtier
			if = {
				limit = { NOT = { event_target:black_goat_sacrifice_1 = { always = yes } } }
				random_courtier = {
					limit = {
						is_alive = yes
						is_ruler = no
						liege = { character = ROOT }
						NOT = { character = ROOT }
						
						NOT = { trait = dragon }
						NOT = { trait = slave }
					}
					save_event_target_as = black_goat_sacrifice_1
					set_character_flag = black_goat_sacrifice_choice
				}
			}
		}
	}
		
	option = {
		name = "EVTOPTAFREECITIES203"			
		event_target:black_goat_sacrifice_1 = { 
			custom_tooltip = { text = TOOLTIPFREECITIES203 }
			set_character_flag = black_goat_sacrifice
			clr_character_flag = black_goat_sacrifice_choice
		}
		if = {
			limit = { NOT = { character = FROM } }
			piety = 75
		}
		hidden_tooltip = {
			event_target:black_goat_sacrifice_2 = { clr_character_flag = black_goat_sacrifice_choice }
			event_target:black_goat_sacrifice_3 = { clr_character_flag = black_goat_sacrifice_choice }
		}
	}
	option = {
		name = "EVTOPTBFREECITIES203"	
		trigger = { event_target:black_goat_sacrifice_2 = { always = yes } }
		event_target:black_goat_sacrifice_2 = { 
			custom_tooltip = { text = TOOLTIPFREECITIES203 }
			set_character_flag = black_goat_sacrifice
			clr_character_flag = black_goat_sacrifice_choice
		}
		if = {
			limit = { NOT = { character = FROM } }
			piety = 75
		}
		hidden_tooltip = {
			event_target:black_goat_sacrifice_1 = { clr_character_flag = black_goat_sacrifice_choice }
			event_target:black_goat_sacrifice_3 = { clr_character_flag = black_goat_sacrifice_choice }
		}
	}
	option = {
		name = "EVTOPTCFREECITIES203"	
		trigger = { event_target:black_goat_sacrifice_3 = { always = yes } }		
		event_target:black_goat_sacrifice_3 = { 
			custom_tooltip = { text = TOOLTIPFREECITIES203 }
			set_character_flag = black_goat_sacrifice
			clr_character_flag = black_goat_sacrifice_choice
		}
		if = {
			limit = { NOT = { character = FROM } }
			piety = 75
		}
		hidden_tooltip = {
			event_target:black_goat_sacrifice_2 = { clr_character_flag = black_goat_sacrifice_choice }
			event_target:black_goat_sacrifice_1 = { clr_character_flag = black_goat_sacrifice_choice }
		}
	}
	option = {
		name = "EVTOPTDFREECITIES203"		
		trigger = { event_target:black_goat_sacrifice_4 = { always = yes } }		
		event_target:black_goat_sacrifice_4 = { 
			custom_tooltip = { text = TOOLTIPFREECITIES203 }
			set_character_flag = black_goat_sacrifice
			clr_character_flag = black_goat_sacrifice_choice
		}
		if = {
			limit = { NOT = { character = FROM } }
			piety = 75
		}
		hidden_tooltip = {
			event_target:black_goat_sacrifice_1 = { clr_character_flag = black_goat_sacrifice_choice }
			event_target:black_goat_sacrifice_2 = { clr_character_flag = black_goat_sacrifice_choice }
			event_target:black_goat_sacrifice_3 = { clr_character_flag = black_goat_sacrifice_choice }
		}
	}
}
# Perform sacrifices
character_event = {
	id = free_cities.204
	picture = GFX_evt_bishop_aztec
	border = GFX_event_normal_frame_war
	
	is_triggered_only = yes
		
	desc = { #famine
		text = "EVTDESCFREECITIES204"
		trigger = {
			is_primary_war_defender = no
		}
	}
	desc = { #war
		text = "EVTDESCFREECITIES204B"
		trigger = {
			is_primary_war_defender = yes
		}
	}
		
	option = {
		name = "EVTOPTAFREECITIES204"
		random_courtier = {
			limit = { has_character_flag = black_goat_sacrifice }
			death = {
				death_reason = death_sacrificed
				killer = PREV
			}
		}
		any_vassal = {
			limit = {
				NOT = { tier = BARON }
				is_theocracy = no
				religion = black_goat
				NOT = { trait = kingsguard }
				NOT = { trait = archmaester }
			}
			random_courtier = {
				limit = { has_character_flag = black_goat_sacrifice }
				death = {
					death_reason = death_sacrificed
					killer = PREV
				}
			}
		}		
	}
}	