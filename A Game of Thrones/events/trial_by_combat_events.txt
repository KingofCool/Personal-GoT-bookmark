namespace = trial_by_combat

#Rodri's Trial-By-Combat event chain
#adapted for the duel engine by knuckey



#Character receives champion request from prisoner
letter_event = {
	id = trial_by_combat.1
	desc = "EVTDESCtrial_by_combat.1"
	picture = "GFX_trial_by_combat"
	is_triggered_only = yes
	
	show_from_from = yes
	
	trigger = {
		FROM = {
			FROM = {
				prisoner = yes
				is_alive = yes
				has_character_flag = choosing_champion
				ROOT = {
					OR = {
						AND = {
							dynasty = PREV
							is_close_relative = PREV
						}
						liege = { character = PREVPREV }
						is_friend = PREV
					}
				}	
			}
		}	
	}

	option = { # yes he will fight
		name = "EVTOPTAtrial_by_combat.1" 
		ai_chance = { 
			factor = 50
			modifier = {
				factor = 2
				trait = brave
			}
			modifier = {
				factor = 2
				trait = honorable
			}
			modifier = {
				factor = 2
				trait = wroth
			}
			modifier = {
				factor = 1.5
				opinion = { who = FROMFROM value = 15 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = FROMFROM value = 40 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = FROMFROM value = 65 }
			}
			modifier = {
				factor = 1.5
				opinion = { who = FROMFROM value = 90 }
			}
			modifier = {
				factor = 1.5
				dynasty = FROMFROM
			}
			modifier = {
				factor = 1.5
				is_close_relative = FROMFROM
			}
			modifier = {
				factor = 5
				trait = familyperson
				is_close_relative = FROMFROM
			}
		}
		FROM = {
			FROM = {
				opinion = { who = ROOT modifier = champion_of_relative }
				letter_event = { id = trial_by_combat.2 tooltip = EVTTOOLTIPtrial_by_combat.2 }
			}
		}
		piety = 35	
	}
	
	option = { # no
		name = "EVTOPTBtrial_by_combat.1" 
		ai_chance = { 
			factor = 50
			
			modifier = {
				factor = 0
				NOT = { trait = craven }
				opinion = { who = FROMFROM value = 15 }
				OR = {
					trait = honorable
					trait = brave
					AND = {
						is_close_relative = FROMFROM
						trait = familyperson
					}
					combat_rating = 6
				}
			}
			modifier = {
				factor = 2
				trait = craven
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 1.5
				is_ruler = yes
			}
			modifier = {
				factor = 1.5
				is_primary_heir = yes
			}
		}
		FROM = {
			FROM = {
				opinion = {
					who = ROOT
					modifier = refused_championing
					months = 60
				}
				letter_event = { id = trial_by_combat.3 tooltip = EVTTOOLTIPtrial_by_combat.3 }	
			}
		}	
	}
}
letter_event = { # inform accept
	id = trial_by_combat.2
	desc = "EVTDESCtrial_by_combat.2"
	
	is_triggered_only = yes

	trigger = {
		FROM = { NOT = { character = ROOT } }
		has_opinion_modifier = { who = FROM modifier = champion_of_relative } 
	}

	option = { # 
		name = "EVTOPTAtrial_by_combat.2" 
		clr_character_flag = choosing_champion
		hidden_tooltip = {
			FROM = { set_character_flag = champion_of_relative }
			host = {
				set_character_flag = prisoner_has_champion
				character_event = {
					id = trial_by_combat.4
					days = 2
				}
			}
		}	
	}
}
letter_event = { # inform reject
	id = trial_by_combat.3
	desc = "EVTDESCtrial_by_combat.3"
	
	is_triggered_only = yes
	
	trigger = {
		FROM = { NOT = { character = ROOT } }
		has_opinion_modifier = { who = FROM modifier = refused_championing } 
	}

	option = { # 
		name = "EVTOPTAtrial_by_combat.3" 
		set_character_flag = select_champion
	}
}
#Inform Host prisoner demands trial by combat
character_event = { #elijo champion
	id = trial_by_combat.4
	picture = "GFX_trial_by_combat"
	
	only_playable = yes
	is_triggered_only = yes
	
	desc = {
		text = EVTDESCtrial_by_combat.4 #prisoner fights personally
		trigger = { NOT = { has_character_flag = prisoner_has_champion } }
	}
	desc = {
		text = EVTDESCtrial_by_combat.13 #prisoner has champion
		trigger = { has_character_flag = prisoner_has_champion }
	}
	
	trigger = {
		OR = {
			has_character_flag = lunatic_trial
			FROM = {
				host = { 
					character = ROOT 
					NOT = { has_character_flag = trial_by_combat }
				}
				prisoner = yes	
			}
		}	
	}
	
	immediate = {
		FROM = {
			opinion = { who = ROOT modifier = host_of_prisoner months = 1200 }
			set_character_flag = demmanded_trial_by_combat
			clr_character_flag = choosing_champion
		}
		set_character_flag = trial_by_combat
	}
	
	option = { # Pick finest warriors    (cualquiera / lider e hijos incluidos)
		name = "EVTOPTAtrial_by_combat.4" 
		trigger = { 
			OR = {
				any_courtier = { 
					NOT = { reverse_has_opinion_modifier = { who = FROM modifier = champion_of_relative } }
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes
					ai = yes
				}
				AND = {
					has_landed_title = e_iron_throne
					kingsguard = { 
						is_alive = yes 
						prisoner = no
						NOT = { has_severe_disability_trigger = yes }
					}
				}
			}	
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2.5
				any_courtier = {
					trait = skilled_warrior
				}
			}
			modifier = {
				factor = 5
				any_courtier = {
					trait = master_warrior
				}
			}
		}		
		FROM = {
			FROM = { 
				tooltip = { }
			}
		}
		set_character_flag = sons_can_fight
		hidden_tooltip = { character_event = { id = trial_by_combat.6 } }	
	}
	option = { # NO SONS
		name = "EVTOPTBtrial_by_combat.4" 
		trigger = { 	
			NOT = {
				AND = {
					trait = cruel
					trait = lunatic
					OR = {
						trait = fire_obsessed
						religion = rhllor
					}
				}	
			}			
			any_courtier = { 
				NOT = { reverse_has_opinion_modifier = { who = FROM modifier = champion_of_relative } }
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes
				ai = yes
				is_child_of = ROOT
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2.5
				any_courtier = {
					NOT = { is_child_of = ROOT }
					trait = skilled_warrior
				}
			}
			modifier = {
				factor = 5
				any_courtier = {
					NOT = { is_child_of = ROOT }
					trait = master_warrior
				}
			}
			modifier = {
				factor = 2
				trait = familyperson
			}
			modifier = {
				factor = 2
				NOT = { num_of_children = 3 }
			}
			modifier = {
				factor = 2
				NOT = { num_of_children = 2 }
			}
		}
		FROM = {
			FROM = { 
				tooltip = { }
			}
		}
		hidden_tooltip = { character_event = { id = trial_by_combat.6 } }
	}
	option = {
		name = "EVTOPTDtrial_by_combat.4"  #I will fight!
		trigger = {
			NOT = { character = FROM }
			OR = {
				trait = poor_warrior
				trait = trained_warrior
				trait = skilled_warrior
				trait = master_warrior
			}	
			age = 16
			is_ill = no
			NOT = { has_severe_disability_trigger = yes }	
			OR = {
				is_female = no
				trait = brave
				is_strong_trigger = yes
				culture = kayakayanayan
				culture = samyrianan
				culture = bayasabhadi
			}
			OR = {
				NOT = { trait = dwarf }
				trait = skilled_warrior
			}	
		}
		ai_chance = {
			factor = 5
			
			modifier = {
				factor = 2
				trait = wroth
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 2
				trait = lunatic
			}
			modifier = {
				factor = 0.5
				trait = patient
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			
			modifier = {
				factor = 10
				trait = master_warrior
			}
			modifier = {
				factor = 6
				trait = skilled_warrior
			}
			modifier = {
				factor = 3
				trait = trained_warrior
			}
			# Physical Strength Effects
			modifier = {
				factor = 2
				is_strong_trigger = yes
			}
			modifier = {
				factor = 0.5
				is_weak_trigger = yes
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				trait = genius
			}
			modifier = {
				factor = 1.5
				is_smart_trigger = yes
			}
			modifier = {
				factor = 0.5
				trait = imbecile
			}
			modifier = {
				factor = 0.66
				is_dumb_trigger = yes
			}
			
			# Personality Effects
			modifier = {
				factor = 2
				trait = brave
			}
			modifier = {
				factor = 0.05
				trait = craven
			}
		
			# Wound Effects
			modifier = {
				factor = 0.5
				trait = wounded
			}
		
			# Health Effects
			modifier = {
				factor = 0.5
				is_ill = yes
			}	
			modifier = {
				factor = 0.1
				has_epidemic = yes
			}
			
			# Body Shape Effects
			modifier = {
				factor = 4
				trait = tall
			}
			modifier = {
				factor = 0.25
				trait = hunchback
			}
			modifier = {
				factor = 0.25
				trait = dwarf
			}
			modifier = {
				factor = 0.25
				trait = clubfooted
			}
			modifier = {
				factor = 0.8
				FROM = { trait = trained_warrior }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = skilled_warrior }
			}
			modifier = {
				factor = 0.3
				FROM = { trait = master_warrior }
			}
			modifier = {
				factor = 0.5
				tier = EMPEROR
			}
			modifier = {
				factor = 0.75
				tier = KING
			}
		}
		prestige = 50
		set_character_flag = elected_champion
		if = {
			limit = { NOT = { has_character_flag = prisoner_has_champion } }		 
			set_character_flag = self_elected_champion 
			FROM = {
				hidden_tooltip = { character_event = { id = trial_by_combat.9 days = 1 }	 }	
			}
		}	
		if = {
			limit = { has_character_flag = prisoner_has_champion }
			set_character_flag = self_elected_champion_b 
			FROMFROM = { 
				tooltip = { }
			}
			FROM = {
				hidden_tooltip = { character_event = { id = trial_by_combat.17 days = 1 }	 }	
			}
		}	
	}
	
	option = {
		name = "EVTOPTEtrial_by_combat.4" # Denied
		trigger = {
			NOT = { has_character_modifier = giving_justice }
			NOT = { character = FROM }
		}
		ai_chance = {
			factor = 20
			modifier = {
				factor = 0
				trait = just
			}
			modifier = {
				factor = 0
				trait = honorable
			}		
			modifier = {
				factor = 2
				trait = arbitrary
			}
			modifier = {
				factor = 0.5
				trait = kind
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 0.5
				trait = honest
			}
			modifier = {
				factor = 2
				trait = deceitful
			}
			modifier = {
				factor = 0.25
				trait = zealous
			}
			modifier = {
				factor = 2
				trait = cynical
			}
		}
		FROM = {
			FROM = { 
				tooltip = { }
			}
		}
		any_courtier = { 
			limit = { has_opinion_modifier = { who = ROOT modifier = host_of_prisoner } }
			hidden_tooltip = {
				clr_character_flag = demmanded_trial_by_combat
				add_character_modifier = { name = getting_justice duration = 365 }
				remove_opinion = {
					who = ROOT modifier = host_of_prisoner 
				}
			}	
			opinion = {
				who = ROOT modifier = denied_trial_by_combat  months = 60
			}
			character_event = { id = trial_by_combat.5 tooltip = "TOOLTIPtrial_by_combat.5" } 
		}
		clr_character_flag = trial_by_combat
		hidden_tooltip = { remove_character_modifier = giving_justice }
		prestige = -100
	}
		
	option = { # Fire will be my champion
		name = "EVTOPTFtrial_by_combat.4" 
		ai_chance = {
			factor = 100
		}
		trigger = { 
			#has_character_flag = targaryen
			NOT = { character = FROM }
			trait = cruel
			trait = lunatic
			OR = {
				trait = fire_obsessed
				religion = rhllor
			}
		}
		clr_character_flag = trial_by_combat
		hidden_tooltip = { remove_character_modifier = giving_justice }			
		if = {
			limit = { NOT = { religion = rhllor } }
			piety = -100
		}
		if = {
			limit = { NOT = { has_character_flag = prisoner_has_champion } }				
			FROM = { 
				character_event = { id = trial_by_combat.24 tooltip = EVTTOOLTIPtrial_by_combat.24 }
			}
		}	
		if = {
			limit = { has_character_flag = prisoner_has_champion }
			clr_character_flag = prisoner_has_champion
			FROM = {
				FROM = { 
					tooltip = { }
				}
			}
			FROM = { 
				character_event = { id = trial_by_combat.26 days = 1 tooltip = EVTTOOLTIPtrial_by_combat.26 } 
			} 
			FROMFROM = { 
				character_event = { id = trial_by_combat.24 tooltip = EVTTOOLTIPtrial_by_combat.24 } 
			} 		
		}	
		change_variable = { which = fear_actions value = 5 } 
		hidden_tooltip = { character_event = { id = faction_event_new.90 } }
		if = {
			limit = { religion = rhllor }		
			piety = 30
			increase_red_god_magic = yes
		}
	}
	
	option = { # Random Warrior
		name = "EVTOPTGtrial_by_combat.4" 
		trigger = { 
			NOT = {
				any_courtier = { 
					NOT = { reverse_has_opinion_modifier = { who = FROM modifier = champion_of_relative } }
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes
					ai = yes
					OR = {
						trait = trained_warrior
						trait = skilled_warrior
						trait = master_warrior
					}
				}
			}	
			NAND = {
				has_landed_title = e_iron_throne
				kingsguard = { 
					is_alive = yes 
					prisoner = no
					NOT = { has_severe_disability_trigger = yes }
				}
			}
		}
		ai_chance = {
			factor = 25
		}		
		capital_scope = {
			ROOT = {
				if = {
					limit = {
						NOT = { culture_group = hyrkoon_group }	
					}
					create_random_soldier = {
						random_traits = yes
						dynasty = none
						female = no
						religion = PREV
						culture = PREV
					}		
				}	
				if = {
					limit = {
						culture_group = hyrkoon_group	
					}
					create_random_soldier = {
						random_traits = yes
						dynasty = none
						female = yes
						religion = PREV
						culture = PREV
					}		
				}	
				new_character = {
					remove_trait = weak
					remove_trait = imbecile
					remove_trait = dwarf
					remove_trait = clubfooted
					remove_trait = hunchback
					remove_trait = inbred
					remove_trait = craven
					random_list = {
						15 = { add_trait = poor_warrior }
						70 = { add_trait = trained_warrior }
						15 = { add_trait = skilled_warrior }
					}
					if = {
						limit = { religion = the_seven }
						knight_character_effect = yes
					}	
					hidden_tooltip = { character_event = { id = trial_by_combat.7 } }					
				}
			}
		}
	}
}
character_event = { # inform reject
	id = trial_by_combat.5
	desc = "EVTDESCtrial_by_combat.5"
	is_triggered_only = yes

	option = { # 
		name = "EVTOPTAtrial_by_combat.5" 
		hidden_tooltip = {
			random_opinion_modifier_target = {
				limit = {
					has_character_flag = champion_of_relative
					reverse_has_opinion_modifier = { who = ROOT modifier = champion_of_relative }
				}
				clr_character_flag = champion_of_relative
				reverse_remove_opinion = { who = ROOT modifier = champion_of_relative }
			}
		}	
	}
}
character_event = { #select champion
	id = trial_by_combat.6
	desc = "EVTDESCtrial_by_combat.6"
	picture = "GFX_trial_by_combat"
	
	only_playable = yes
	is_triggered_only = yes
	
	immediate = {
		if = {
			limit = {
				has_landed_title = e_iron_throne
			}
			kingsguard = {
				limit = { 
					trait = master_warrior 
					is_alive = yes 
					prisoner = no
					NOT = { has_severe_disability_trigger = yes }
					NOT = {
						ROOT = {
							any_courtier = {
								has_opinion_modifier = { who = PREV modifier = host_of_prisoner  }
								dynasty = PREVPREV
							}
						}
					}
					NOT = {
						liege = {
							NOT = { character = ROOT }
							reverse_has_opinion_modifier = { who = PREV modifier = loan_kingsguard }
						}
					}
				}
				save_event_target_as = kingsguard_champ
				ROOT = { set_character_flag = kingsguard_champ_selected }
			}
			kingsguard = {
				limit = { 
					ROOT = { NOT = { has_character_flag = kingsguard_champ_selected } }
					trait = skilled_warrior 
					is_alive = yes 
					prisoner = no
					NOT = { has_severe_disability_trigger = yes }
					NOT = {
						ROOT = {
							any_courtier = {
								has_opinion_modifier = { who = PREV modifier = host_of_prisoner  }
								dynasty = PREVPREV
							}
						}
					}
					NOT = {
						liege = {
							NOT = { character = ROOT }
							reverse_has_opinion_modifier = { who = PREV modifier = loan_kingsguard }
						}
					}
				}
				save_event_target_as = kingsguard_champ
				ROOT = { set_character_flag = kingsguard_champ_selected }
			}
			kingsguard = {
				limit = { 
					ROOT = { NOT = { has_character_flag = kingsguard_champ_selected } }
					trait = trained_warrior 
					is_alive = yes 
					prisoner = no
					NOT = { has_severe_disability_trigger = yes }
					NOT = {
						ROOT = {
							any_courtier = {
								has_opinion_modifier = { who = PREV modifier = host_of_prisoner  }
								dynasty = PREVPREV
							}
						}
					}
					NOT = {
						liege = {
							NOT = { character = ROOT }
							reverse_has_opinion_modifier = { who = PREV modifier = loan_kingsguard }
						}
					}
				}
				save_event_target_as = kingsguard_champ
				ROOT = { set_character_flag = kingsguard_champ_selected }
			}
			kingsguard = {
				limit = { 
					ROOT = { NOT = { has_character_flag = kingsguard_champ_selected } }
					trait = poor_warrior 
					is_alive = yes 	
					prisoner = no
					NOT = { has_severe_disability_trigger = yes }
					NOT = {
						ROOT = {
							any_courtier = {
								has_opinion_modifier = { who = PREV modifier = host_of_prisoner  }
								dynasty = PREVPREV
							}
						}
					}
					NOT = {
						liege = {
							NOT = { character = ROOT }
							reverse_has_opinion_modifier = { who = PREV modifier = loan_kingsguard }
						}
					}
				}
				save_event_target_as = kingsguard_champ
				ROOT = { set_character_flag = kingsguard_champ_selected }
			}
			clr_character_flag = kingsguard_champ_selected
		}
		random_courtier = {
			limit = {
				trait = master_warrior
				liege = { character = ROOT }
				OR = {
					NOT = { is_child_of = ROOT }
					FROM = { has_character_flag = sons_can_fight }
				}	
				NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
				OR = {
					AND = {
						NOT = { is_close_relative = FROMFROM }
						NOT = { is_friend = FROMFROM }
					}	
					NOT = { opinion = { who = FROMFROM value = -15 } }
				}	
				ai = yes	
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
			}
			save_event_target_as = champion_1
			set_character_flag = champion
		}
		random_courtier = {
			limit = {
				trait = master_warrior
				OR = {
					NOT = { is_child_of = ROOT }
					FROM = { has_character_flag = sons_can_fight }
				}	
				NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }
				OR = {
					AND = {
						NOT = { is_close_relative = FROMFROM }
						NOT = { is_friend = FROMFROM }
					}	
					NOT = { opinion = { who = FROMFROM value = -15 } }
				}				
				ai = yes
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
				NOT = { has_character_flag = champion }				
			}
			save_event_target_as = champion_2
			set_character_flag = champion
		}
		random_courtier = {
			limit = {
				trait = master_warrior
				OR = {
					NOT = { is_child_of = ROOT }
					FROM = { has_character_flag = sons_can_fight }
				}	
				NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
				OR = {
					AND = {
						NOT = { is_close_relative = FROMFROM }
						NOT = { is_friend = FROMFROM }
					}	
					NOT = { opinion = { who = FROMFROM value = -15 } }
				}
				ai = yes
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
				NOT = { has_character_flag = champion }				
			}
			save_event_target_as = champion_3
			set_character_flag = champion
		}
		random_courtier = {
			limit = {
				trait = master_warrior
				OR = {
					NOT = { is_child_of = ROOT }
					FROM = { has_character_flag = sons_can_fight }
				}	
				NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
				OR = {
					AND = {
						NOT = { is_close_relative = FROMFROM }
						NOT = { is_friend = FROMFROM }
					}	
					NOT = { opinion = { who = FROMFROM value = -15 } }
				}	
				ai = yes
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
				NOT = { has_character_flag = champion }				
			}
			save_event_target_as = champion_4
			set_character_flag = champion
			break = yes
		}
		if = {
			limit = { NOT = { event_target:champion_1 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = skilled_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}	
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_1
				set_character_flag = champion
			}
		}	
		if = {
			limit = { NOT = { event_target:champion_2 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = skilled_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_2
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_3 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = skilled_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}	
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_3
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_4 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = skilled_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}	
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_4
				set_character_flag = champion
				break = yes
			}
		}
		if = {
			limit = { NOT = { event_target:champion_1 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = trained_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_1
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_2 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = trained_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_2
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_3 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = trained_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_3
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_4 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = trained_warrior
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_4
				set_character_flag = champion
				break = yes
			}
		}
		if = {
			limit = { NOT = { event_target:champion_1 = { always = yes } } }
			random_courtier = {
				limit = {
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_1
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_2 = { always = yes } } }
			random_courtier = {
				limit = {
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_2
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_3 = { always = yes } } }
			random_courtier = {
				limit = {
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_3
				set_character_flag = champion
			}
		}
		if = {
			limit = { NOT = { event_target:champion_4 = { always = yes } } }
			random_courtier = {
				limit = {
					OR = {
						NOT = { is_child_of = ROOT }
						FROM = { has_character_flag = sons_can_fight }
					}	
					NOT = { reverse_has_opinion_modifier = { who = FROMFROM modifier = champion_of_relative } }	
					OR = {
						AND = {
							NOT = { is_close_relative = FROMFROM }
							NOT = { is_friend = FROMFROM }
						}	
						NOT = { opinion = { who = FROMFROM value = -15 } }
					}
					ai = yes
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes	
					NOT = { has_character_flag = champion }				
				}
				save_event_target_as = champion_4
				set_character_flag = champion
				break = yes
			}
		}	
	}
	
	option = { # champion 1
		name = "EVTOPTAtrial_by_combat.6" 
		trigger = {
			event_target:champion_1 = { always = yes }
		}
		ai_chance = { 
			factor = 10
			modifier = {
				factor = 10
				event_target:champion_1 = { trait = master_warrior }
			}
			modifier = {
				factor = 6
				event_target:champion_1 = { trait = skilled_warrior }
			}
			modifier = {
				factor = 3
				event_target:champion_1 = { trait = trained_warrior }
			}
			# Physical Strength Effects
			modifier = {
				factor = 2
				event_target:champion_1 = { is_strong_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_1 = { is_weak_trigger = yes }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				event_target:champion_1 = { trait = genius }
			}
			modifier = {
				factor = 1.5
				event_target:champion_1 = { is_smart_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_1 = { trait = imbecile }
			}
			modifier = {
				factor = 0.66
				event_target:champion_1 = { is_dumb_trigger = yes }
			}
			
			# Personality Effects
			modifier = {
				factor = 2
				event_target:champion_1 = { trait = brave }
			}
			modifier = {
				factor = 0.5
				event_target:champion_1 = { trait = craven }
			}
		
			# Wound Effects
			modifier = {
				factor = 0.5
				event_target:champion_1 = { trait = wounded }
			}
		
			# Health Effects
			modifier = {
				factor = 0.5
				event_target:champion_1 = { is_ill = yes }
			}	
			modifier = {
				factor = 0.1
				event_target:champion_1 = { has_epidemic = yes }	
			}
			
			# Body Shape Effects
			modifier = {
				factor = 4
				event_target:champion_1 = { trait = tall }
			}
			modifier = {
				factor = 0.25
				event_target:champion_1 = { trait = hunchback }
			}
			modifier = {
				factor = 0.25
				event_target:champion_1 = { trait = dwarf }
			}
			modifier = {
				factor = 0.25
				event_target:champion_1 = { trait = clubfooted }
			}
		}
		event_target:champion_1 = {
			clr_character_flag = champion
			custom_tooltip = { text = TOOLTIPCHOOSETHISPERSON }
			hidden_tooltip = { character_event = { id = trial_by_combat.7 } }
		}	
		clr_character_flag = sons_can_fight
		hidden_tooltip = {
			event_target:champion_4 = { clr_character_flag = champion }
			event_target:champion_2 = { clr_character_flag = champion }
			event_target:champion_3 = { clr_character_flag = champion }
			clear_event_target = champion_1
			clear_event_target = champion_2
			clear_event_target = champion_3
			clear_event_target = champion_4
			clear_event_target = kingsguard_champ
			event_target:kingsguard_champ = { clr_character_flag = kingsguard_champ }
		}
	}
	option = { # champion 2
		name = "EVTOPTBtrial_by_combat.6" 
		trigger = {
			event_target:champion_2 = { always = yes }
		}
		ai_chance = { 
			factor = 10
			modifier = {
				factor = 10
				event_target:champion_2 = { trait = master_warrior }
			}
			modifier = {
				factor = 6
				event_target:champion_2 = { trait = skilled_warrior }
			}
			modifier = {
				factor = 3
				event_target:champion_2 = { trait = trained_warrior }
			}
			# Physical Strength Effects
			modifier = {
				factor = 2
				event_target:champion_2 = { is_strong_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_2 = { is_weak_trigger = yes }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				event_target:champion_2 = { trait = genius }
			}
			modifier = {
				factor = 1.5
				event_target:champion_2 = { is_smart_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_2 = { trait = imbecile }
			}
			modifier = {
				factor = 0.66
				event_target:champion_2 = { is_dumb_trigger = yes }
			}
			
			# Personality Effects
			modifier = {
				factor = 2
				event_target:champion_2 = { trait = brave }
			}
			modifier = {
				factor = 0.5
				event_target:champion_2 = { trait = craven }
			}
		
			# Wound Effects
			modifier = {
				factor = 0.5
				event_target:champion_2 = { trait = wounded }
			}
		
			# Health Effects
			modifier = {
				factor = 0.5
				event_target:champion_2 = { is_ill = yes }
			}	
			modifier = {
				factor = 0.1
				event_target:champion_2 = { has_epidemic = yes }	
			}
			
			# Body Shape Effects
			modifier = {
				factor = 4
				event_target:champion_2 = { trait = tall }
			}
			modifier = {
				factor = 0.25
				event_target:champion_2 = { trait = hunchback }
			}
			modifier = {
				factor = 0.25
				event_target:champion_2 = { trait = dwarf }
			}
			modifier = {
				factor = 0.25
				event_target:champion_2 = { trait = clubfooted }
			}
		}
		event_target:champion_2 = {
			custom_tooltip = { text = TOOLTIPCHOOSETHISPERSON }
			hidden_tooltip = { character_event = { id = trial_by_combat.7 } }
		}	
		clr_character_flag = sons_can_fight
		hidden_tooltip = {
			event_target:champion_1 = { clr_character_flag = champion }
			event_target:champion_4 = { clr_character_flag = champion }
			event_target:champion_3 = { clr_character_flag = champion }
			clear_event_target = champion_1
			clear_event_target = champion_2
			clear_event_target = champion_3
			clear_event_target = champion_4
			clear_event_target = kingsguard_champ
			event_target:kingsguard_champ = { clr_character_flag = kingsguard_champ }
		}
	}
	option = { # champion 3
		name = "EVTOPTCtrial_by_combat.6" 
		trigger = {
			event_target:champion_3 = { always = yes }
		}
		ai_chance = { 
			factor = 10
			modifier = {
				factor = 10
				event_target:champion_3 = { trait = master_warrior }
			}
			modifier = {
				factor = 6
				event_target:champion_3 = { trait = skilled_warrior }
			}
			modifier = {
				factor = 3
				event_target:champion_3 = { trait = trained_warrior }
			}
			# Physical Strength Effects
			modifier = {
				factor = 2
				event_target:champion_3 = { is_strong_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_3 = { is_weak_trigger = yes }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				event_target:champion_3 = { trait = genius }
			}
			modifier = {
				factor = 1.5
				event_target:champion_3 = { is_smart_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_3 = { trait = imbecile }
			}
			modifier = {
				factor = 0.66
				event_target:champion_3 = { is_dumb_trigger = yes }
			}
			
			# Personality Effects
			modifier = {
				factor = 2
				event_target:champion_3 = { trait = brave }
			}
			modifier = {
				factor = 0.5
				event_target:champion_3 = { trait = craven }
			}
		
			# Wound Effects
			modifier = {
				factor = 0.5
				event_target:champion_3 = { trait = wounded }
			}
		
			# Health Effects
			modifier = {
				factor = 0.5
				event_target:champion_3 = { is_ill = yes }
			}	
			modifier = {
				factor = 0.1
				event_target:champion_3 = { has_epidemic = yes }	
			}
			
			# Body Shape Effects
			modifier = {
				factor = 4
				event_target:champion_3 = { trait = tall }
			}
			modifier = {
				factor = 0.25
				event_target:champion_3 = { trait = hunchback }
			}
			modifier = {
				factor = 0.25
				event_target:champion_3 = { trait = dwarf }
			}
			modifier = {
				factor = 0.25
				event_target:champion_3 = { trait = clubfooted }
			}
		}
		event_target:champion_3 = {
			clr_character_flag = champion
			custom_tooltip = { text = TOOLTIPCHOOSETHISPERSON }
			hidden_tooltip = { character_event = { id = trial_by_combat.7 } }
		}	
		clr_character_flag = sons_can_fight
		hidden_tooltip = {
			event_target:champion_1 = { clr_character_flag = champion }
			event_target:champion_2 = { clr_character_flag = champion }
			event_target:champion_4 = { clr_character_flag = champion }
			clear_event_target = champion_1
			clear_event_target = champion_2
			clear_event_target = champion_3
			clear_event_target = champion_4
			clear_event_target = kingsguard_champ
			event_target:kingsguard_champ = { clr_character_flag = kingsguard_champ }
		}
	}
	option = { # kingsguard
		name = "EVTOPTEtrial_by_combat.6" 
		trigger = {
			has_landed_title = e_iron_throne
			event_target:kingsguard_champ = { always = yes }
		}
		ai_chance = { 
			factor = 10
			modifier = {
				factor = 10
				event_target:kingsguard_champ = { trait = master_warrior }
			}
			modifier = {
				factor = 6
				event_target:kingsguard_champ = { trait = skilled_warrior }
			}
			modifier = {
				factor = 3
				event_target:kingsguard_champ = { trait = trained_warrior }
			}
			# Physical Strength Effects
			modifier = {
				factor = 2
				event_target:kingsguard_champ = { is_strong_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:kingsguard_champ = { is_weak_trigger = yes }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				event_target:kingsguard_champ = { trait = genius }
			}
			modifier = {
				factor = 1.5
				event_target:kingsguard_champ = { is_smart_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:kingsguard_champ = { trait = imbecile }
			}
			modifier = {
				factor = 0.66
				event_target:kingsguard_champ = { is_dumb_trigger = yes }
			}
			
			# Personality Effects
			modifier = {
				factor = 2
				event_target:kingsguard_champ = { trait = brave }
			}
			modifier = {
				factor = 0.5
				event_target:kingsguard_champ = { trait = craven }
			}
		
			# Wound Effects
			modifier = {
				factor = 0.5
				event_target:kingsguard_champ = { trait = wounded }
			}
		
			# Health Effects
			modifier = {
				factor = 0.5
				event_target:kingsguard_champ = { is_ill = yes }
			}	
			modifier = {
				factor = 0.1
				event_target:kingsguard_champ = { has_epidemic = yes }	
			}
			
			# Body Shape Effects
			modifier = {
				factor = 4
				event_target:kingsguard_champ = { trait = tall }
			}
			modifier = {
				factor = 0.25
				event_target:kingsguard_champ = { trait = hunchback }
			}
			modifier = {
				factor = 0.25
				event_target:kingsguard_champ = { trait = dwarf }
			}
			modifier = {
				factor = 0.25
				event_target:kingsguard_champ = { trait = clubfooted }
			}
		}
		event_target:kingsguard_champ = {
			custom_tooltip = { text = TOOLTIPCHOOSETHISPERSON }
			hidden_tooltip = { character_event = { id = trial_by_combat.7 } }	
			clr_character_flag = kingsguard_champ
		}
		clr_character_flag = sons_can_fight
		hidden_tooltip = {
			event_target:champion_1 = { clr_character_flag = champion }
			event_target:champion_2 = { clr_character_flag = champion }
			event_target:champion_3 = { clr_character_flag = champion }
			event_target:champion_4 = { clr_character_flag = champion }
			clear_event_target = champion_1
			clear_event_target = champion_2
			clear_event_target = champion_3
			clear_event_target = champion_4
			clear_event_target = kingsguard_champ
		}
	}
	option = { # champion 4
		name = "EVTOPTDtrial_by_combat.6" 
		trigger = {
			event_target:champion_4 = { always = yes }
		}
		ai_chance = { 
			factor = 10
			modifier = {
				factor = 10
				event_target:champion_4 = { trait = master_warrior }
			}
			modifier = {
				factor = 6
				event_target:champion_4 = { trait = skilled_warrior }
			}
			modifier = {
				factor = 3
				event_target:champion_4 = { trait = trained_warrior }
			}
			# Physical Strength Effects
			modifier = {
				factor = 2
				event_target:champion_4 = { is_strong_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_4 = { is_weak_trigger = yes }
			}
			
			# Cunning/Intelligence Effects
			modifier = {
				factor = 2
				event_target:champion_4 = { trait = genius }
			}
			modifier = {
				factor = 1.5
				event_target:champion_4 = { is_smart_trigger = yes }
			}
			modifier = {
				factor = 0.5
				event_target:champion_4 = { trait = imbecile }
			}
			modifier = {
				factor = 0.66
				event_target:champion_4 = { is_dumb_trigger = yes }
			}
			
			# Personality Effects
			modifier = {
				factor = 2
				event_target:champion_4 = { trait = brave }
			}
			modifier = {
				factor = 0.5
				event_target:champion_4 = { trait = craven }
			}
		
			# Wound Effects
			modifier = {
				factor = 0.5
				event_target:champion_4 = { trait = wounded }
			}
		
			# Health Effects
			modifier = {
				factor = 0.5
				event_target:champion_4 = { is_ill = yes }
			}	
			modifier = {
				factor = 0.1
				event_target:champion_4 = { has_epidemic = yes }	
			}
			
			# Body Shape Effects
			modifier = {
				factor = 4
				event_target:champion_4 = { trait = tall }
			}
			modifier = {
				factor = 0.25
				event_target:champion_4 = { trait = hunchback }
			}
			modifier = {
				factor = 0.25
				event_target:champion_4 = { trait = dwarf }
			}
			modifier = {
				factor = 0.25
				event_target:champion_4 = { trait = clubfooted }
			}
		}
		event_target:champion_4 = {
			clr_character_flag = champion
			custom_tooltip = { text = TOOLTIPCHOOSETHISPERSON }
			hidden_tooltip = { character_event = { id = trial_by_combat.7 } }
		}	
		clr_character_flag = sons_can_fight
		hidden_tooltip = {
			event_target:champion_1 = { clr_character_flag = champion }
			event_target:champion_2 = { clr_character_flag = champion }
			event_target:champion_3 = { clr_character_flag = champion }
			clear_event_target = champion_1
			clear_event_target = champion_2
			clear_event_target = champion_3
			clear_event_target = champion_4
			clear_event_target = kingsguard_champ
			event_target:kingsguard_champ = { clr_character_flag = kingsguard_champ }
		}
	}
	
	option = { # Random
		name = "EVTOPTFtrial_by_combat.6" 
		trigger = {
			OR = {
				ai = no
				NOT = { event_target:champion_3 = { always = yes } }
			}	
		}
		ai_chance = { 
			factor = 30
		}
		wealth = -30
		custom_tooltip = {
			text = TOOLTIPtrial_by_combat.6
		}
		hidden_tooltip = {
			capital_scope = {
				ROOT = {
					if = {
						limit = {
							NOT = { culture_group = hyrkoon_group }	
						}
						create_random_soldier = {
							random_traits = yes
							dynasty = none
							female = no
							religion = PREV
							culture = PREV
						}		
					}	
					if = {
						limit = {
							culture_group = hyrkoon_group	
						}
						create_random_soldier = {
							random_traits = yes
							dynasty = none
							female = yes
							religion = PREV
							culture = PREV
						}		
					}
					new_character = {
						remove_trait = weak
						remove_trait = imbecile
						remove_trait = dwarf
						remove_trait = clubfooted
						remove_trait = hunchback
						remove_trait = inbred
						remove_trait = maimed
						random_list = {
							20 = { add_trait = poor_warrior }
							60 = { add_trait = trained_warrior }
							20 = { add_trait = skilled_warrior }
						}
						if = {
							limit = { religion = the_seven }
							knight_character_effect = yes
						}	
						character_event = { id = trial_by_combat.7 }
					}
				}	
			}	
		}
		clr_character_flag = sons_can_fight
		hidden_tooltip = {
			event_target:champion_1 = { clr_character_flag = champion }
			event_target:champion_2 = { clr_character_flag = champion }
			event_target:champion_3 = { clr_character_flag = champion }
			event_target:champion_4 = { clr_character_flag = champion }
			clear_event_target = champion_1
			clear_event_target = champion_2
			clear_event_target = champion_3
			clear_event_target = champion_4
			clear_event_target = kingsguard_champ
			event_target:kingsguard_champ = { clr_character_flag = kingsguard_champ }
		}
	}
}
#Inform character they will champion for liege
character_event = { 
	id = trial_by_combat.7
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	desc = {
		text = EVTDESCtrial_by_combat.7
		trigger = { FROM = { NOT = { has_character_flag = prisoner_has_champion } } }
	}
	desc = {
		text = EVTDESCtrial_by_combat.14
		trigger = { FROM = { has_character_flag = prisoner_has_champion } }
	}
	
	option = {
		name = "EVTOPTAtrial_by_combat.7" 
		set_character_flag = elected_champion
		FROM = { 
			opinion = { who = ROOT modifier = champion_of_liege months = 60 } 
			hidden_tooltip = { character_event = { id = trial_by_combat.8 days = 1 } } ##tooltip
		}
	}
}
#Ping back to host
character_event = {
	id = trial_by_combat.8
	desc = "EVTDESCtrial_by_combat.8"
	picture = "GFX_trial_by_combat"

	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = elected_champion
		clr_character_flag = has_champion
	}
	
	option = {  # 
		name = "EVTOPTAtrial_by_combat.8" 
		FROMFROMFROMFROM = {
			if = {
				limit = { 
					NOT = { character = ROOT }
					ROOT = {  NOT = { has_character_flag = prisoner_has_champion } } 
				}
				custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON_HOST_CHAMP }
				hidden_tooltip = {
					character_event = { 
						id = trial_by_combat.9 
					} 
				}
			}
			if = {
				limit = { 
					NOT = { character = ROOT }
					ROOT = { has_character_flag = prisoner_has_champion } 
				}
				character_event = { 
					id = trial_by_combat.16
				}
			}
		}
		if = { 
			limit = { has_character_flag = lunatic_trial }
			custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON_HOST_CHAMP }
			hidden_tooltip = {
				character_event = { 
					id = trial_by_combat.9 
				} 
				any_realm_lord = {
					character_event = { 
						id = 6461
					} 
				}
			}	
		}
	}
}

##Prisoner is Fighting##
# Prisoner Event
character_event = { 
	id = trial_by_combat.9
	desc = "EVTDESCtrial_by_combat.9"
	picture = "GFX_trial_by_combat"
	is_triggered_only = yes

	option = {
		name = "EVTOPTAtrial_by_combat.9" 
		#set_character_flag = flag_duel_to_the_death
		if = {
			limit = { FROM = { has_character_flag = self_elected_champion } }
			FROM = { custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON_HOST } }
			hidden_tooltip = { e_rebels = { holder_scope = { character_event = { id = duel.0 } } } }
		}
		if = {
			limit = { 
				NOT = { FROM = { has_character_flag = self_elected_champion } }
				NOT = { has_character_flag = lunatic_trial }
			}
			FROMFROM = {
				custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON }
				hidden_tooltip = { character_event = { id = trial_by_combat.10 } }
			}
		}
		if = {
			limit = { has_character_flag = lunatic_trial }
			FROMFROM = {
				custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON }
				hidden_tooltip = { character_event = { id = trial_by_combat.10 } }
			}
		}
	}
}
#Champion Event
character_event = { # fight takes place / champion fights
	id = trial_by_combat.10
	desc = "EVTDESCtrial_by_combat.10"
	picture = "GFX_trial_by_combat"
	is_triggered_only = yes

	option = {
		name = "EVTOPTAtrial_by_combat.10" 
		#set_character_flag = flag_duel_to_the_death
		hidden_tooltip = { e_rebels = { holder_scope = { character_event = { id = duel.0 } } } }
	}
}
##Prisoner has Champion##
# Prisoner Event
character_event = { # prisoner is readied to spectate trial
	id = trial_by_combat.16
	desc = "EVTDESCtrial_by_combat.16"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	show_from_from = yes

	option = {
		name = "EVTOPTAtrial_by_combat.16" 	
		hidden_tooltip = { add_trait = assign_mission_target } #so they can be found after fight
		random_opinion_modifier_target = {
			limit = { 
				reverse_has_opinion_modifier = { who = ROOT modifier = champion_of_relative } 
				has_character_flag = champion_of_relative
			}
			custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON_CHAMP }
			hidden_tooltip = { character_event = { id = trial_by_combat.18 } }
		}	
	}	
}
character_event = { #Host is personally fighting
	id = trial_by_combat.17
	desc = "EVTDESCtrial_by_combat.17"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAtrial_by_combat.17" 
		random_opinion_modifier_target = {
			limit = { 
				reverse_has_opinion_modifier = { who = ROOT modifier = champion_of_relative } 
				has_character_flag = champion_of_relative
			}
			custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON_HOST_CHAMP }
			hidden_tooltip = { character_event = { id = trial_by_combat.18 } }
		}	
	}	
}
#Prisoner's Champion
character_event = {
	id = trial_by_combat.18
	desc = "EVTDESCtrial_by_combat.18"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAtrial_by_combat.18" 
		#set_character_flag = flag_duel_to_the_death
		clr_character_flag = trial_by_combat.18fired
		if = {
			limit = { FROMFROM = { has_character_flag = self_elected_champion_b  } }
			FROMFROM = {
				custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON }
				hidden_tooltip = { character_event = { id = trial_by_combat.19 } }
			}
		}
		if = {
			limit = { FROMFROM = { NOT = { has_character_flag = self_elected_champion_b  } } }
			FROMFROMFROM = {
				custom_tooltip = { text = TOOLTIPFIGHTTHISPERSON }
				hidden_tooltip = { character_event = { id = trial_by_combat.19 } }
			}	
		}
	}	
}
#Host's Champion
character_event = {
	id = trial_by_combat.19
	desc = "EVTDESCtrial_by_combat.19"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAtrial_by_combat.19" 
		#set_character_flag = flag_duel_to_the_death
		hidden_tooltip = { e_rebels = { holder_scope = { character_event = { id = duel.0 } } } }
	}
}

###Outcome Events###
#Prisoner is fighting directly
#Prisoner Loses
character_event = {
	id = trial_by_combat.11
	desc = "EVTDESCtrial_by_combat.11"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	immediate = { 
		clr_character_flag = trial_by_combat 
		hidden_tooltip = { remove_character_modifier = giving_justice }
		clr_character_flag = prisoner_has_champion
		clr_character_flag = self_elected_champion 
		clr_character_flag = self_elected_champion_b
		clr_character_flag = lunatic_trial
		FROM = { 
			FROM = { 
				clr_character_flag = elected_champion 
				remove_opinion = {
					who = ROOT modifier = host_of_prisoner 
				}
				if = {
					limit = { is_alive = yes }
					character_event = { id = trial_by_combat.119 days = 1 } #Host picks punishment
				}
			} 
		}	
	}
	
	option = {
		name = "EVTOPTAtrial_by_combat.11" 
	}
}
#Prisoner Wins
character_event = {
	id = trial_by_combat.12
	desc = "EVTDESCtrial_by_combat.12"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	immediate = { 
		clr_character_flag = trial_by_combat 
		hidden_tooltip = { remove_character_modifier = giving_justice }
		clr_character_flag = prisoner_has_champion
		clr_character_flag = self_elected_champion 
		clr_character_flag = self_elected_champion_b
		FROM = { 
			clr_character_flag = elected_champion 
			if = {
				limit = { any_claim = { tier = EMPEROR holder_scope = { character = ROOT } } }
				clr_character_flag = exiled_royal_family
				reverse_remove_opinion = {
					who = ROOT
					modifier = opinion_exiled_pretender
				}
			}
		}
		reverse_remove_opinion = {
			who = FROM modifier = host_of_prisoner 
		}
		clr_character_flag = lunatic_trial
	}
	
	option = {
		name = "EVTOPTAtrial_by_combat.12" 
		FROM = { 
			prisoner = no
			clr_character_flag = demmanded_first_trial_by_combat
			hidden_tooltip = {
				if = {
					limit = {
						is_ruler = no
						liege = { character = ROOT }
						NOT = { character = ROOT }
					}
					leave_court_effect = yes		
				}
			}				
		}
	}
}

#Prisoner has champion
#Champion Loses
character_event = { #Prisoner Event
	id = trial_by_combat.20
	desc = "EVTDESCtrial_by_combat.20"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAtrial_by_combat.20" 
		host = {
			hidden_tooltip = {
				character_event = { id = trial_by_combat.21 }
				character_event = { id = trial_by_combat.120 days = 1 } #Host picks punishment
			}
		}
		clr_character_flag = demmanded_trial_by_combat
	}
}	
#Inform host
character_event = { 
	id = trial_by_combat.21
	desc = "EVTDESCtrial_by_combat.21"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	immediate = { 
		clr_character_flag = trial_by_combat 
		hidden_tooltip = { remove_character_modifier = giving_justice }
		clr_character_flag = prisoner_has_champion
		clr_character_flag = self_elected_champion 
		clr_character_flag = self_elected_champion_b
		FROM = { 
			clr_character_flag = elected_champion 
			remove_opinion = {
				who = ROOT modifier = host_of_prisoner 
			}
		} 
	}
	
	option = {
		name = "EVTOPTAtrial_by_combat.21" #Death
	}
}
#Champion Wins
character_event = { # inform prisoner his champ is winner
	id = trial_by_combat.22
	desc = "EVTDESCtrial_by_combat.22"
	picture = "GFX_trial_by_combat"
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAtrial_by_combat.22" 
		hidden_tooltip = {
			host = {
				character_event = {
					id = trial_by_combat.23
				}
			}
		}	
		prisoner = no
		clr_character_flag = demmanded_trial_by_combat
		clr_character_flag = demmanded_first_trial_by_combat
	}
}
character_event = { # inform host death of his own champ
	id = trial_by_combat.23
	desc = "EVTDESCtrial_by_combat.23"
	picture = "GFX_trial_by_combat"
	is_triggered_only = yes
	
	immediate = { 
		clr_character_flag = trial_by_combat 
		hidden_tooltip = { remove_character_modifier = giving_justice }
		clr_character_flag = prisoner_has_champion
		clr_character_flag = self_elected_champion 
		clr_character_flag = self_elected_champion_b
		FROM = { 
			clr_character_flag = elected_champion 
			remove_opinion = {
				who = ROOT modifier = host_of_prisoner 
			}
			if = {
				limit = { any_claim = { tier = EMPEROR holder_scope = { character = ROOT } } }
				clr_character_flag = exiled_royal_family
				reverse_remove_opinion = {
					who = ROOT
					modifier = opinion_exiled_pretender
				}
			}
		} 	
	}
	
	option = {
		name = "EVTOPTAtrial_by_combat.23" 
		FROM = { 
			prisoner = no 
			clr_character_flag = demmanded_first_trial_by_combat
			hidden_tooltip = {
				diplomatic_immunity = no
				if = {
					limit = {
						is_ruler = no
						liege = { character = ROOT }
					}
					random_dynasty_member = {
						limit = { 
							is_alive = yes 
							NOT = { character = ROOT }
							OR = {
								is_ruler = yes
								NOT = { liege = { character = ROOT } }
							}
							NOT = { trait = nightswatch }
							NOT = { trait = kingsguard }
							NOT = { trait = septon }
							NOT = { trait = red_priest }
							NOT = { trait = maester }
						}
						PREV = { set_character_flag = banished }
						if = {
							limit = { is_ruler = yes }
							reverse_banish = PREV
						}
						if = {
							limit = { is_ruler = no }
							liege = { reverse_banish = PREVPREV }
						}
					}
					if = {
						limit = { NOT = { has_character_flag = banished } }
						random_playable_ruler = {
							limit = { 
								culture = PREV
								NOT = { character = ROOT }
								NOT = { trait = wildling }
								NOT = { trait = nightswatch }
								NOT = { trait = kingsguard }
								NOT = { trait = septon }
								NOT = { trait = red_priest }
								NOT = { trait = maester }
							}
							reverse_banish = PREV
						}
					}
					clr_character_flag = banished			
				}
			}	
		}
	}
}

###Judgement Event##
character_event = { #prisoner ping event
	id = trial_by_combat.119

	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		FROM = { character_event = { id = trial_by_combat.120 } }
	}
	
	option = {
		name = OK
	}
}	
#Inform host, choose punishment
character_event = { 
	id = trial_by_combat.120
	desc = "EVTDESCtrial_by_combat.120"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTAtrial_by_combat.120" #Death
		trigger = { 
			OR = {
				NOT = { has_dlc = "Zeus" }
				AND = {
					has_regent = no
					NOT = { primary_title = { has_law = justice_voting_power_1 } }
				}	
			}
		}
		ai_chance = { 
			factor = 25 	
			modifier = {
				factor = 4
				trait = zealous
			}			
			modifier = {
				factor = 4
				trait = cruel
			}
			modifier = {
				factor = 4
				trait = wroth
			}
			modifier = {
				factor = 4
				trait = proud
			}
			modifier = {
				factor = 4
				trait = ruthless
			}
			modifier = {
				factor = 4
				FROM = { any_claim = { holder_scope = { character = ROOT } } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -10 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -35 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -60 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -85 } }
			}
		}
		FROM = { character_event = { id = trial_by_combat.121 tooltip = TOOLTIPtrial_by_combat.121 } }	
	}
	
	option = {
		name = "EVTOPTBtrial_by_combat.120" #To the Wall
		trigger = {
			OR = {
				NOT = { has_dlc = "Zeus" }
				AND = {
					has_regent = no
					NOT = { primary_title = { has_law = justice_voting_power_1 } }
				}	
			}
			NOT = { trait = nightswatch }
			NOT = { trait = deserter }
			FROM = {
				is_female = no
				age = 14
				NOT = { trait = nightswatch } 
			}
			nightswatch_culture_trigger = yes
		}
		ai_chance = { 
			factor = 25 
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = diligent
			}
			modifier = {
				factor = 4
				trait = honorable
			}
			modifier = {
				factor = 4
				FROM = { dynasty = ROOT }
			}
		}
		FROM = { 
			custom_tooltip = { 
				text = TOOLTIPBANISHTONW 
				hidden_tooltip = { character_event = { id = nightswatch.2098 } } #set banisher as FROMFROM
			}
			hidden_tooltip = { character_event = { id = trial_by_combat.122 } }
		}
		piety = 40	
	}
	option = { 
		name = "EVTOPTDtrial_by_seven_13" ##Send to priesthood
		trigger = { 
			OR = {
				NOT = { has_dlc = "Zeus" }
				AND = {
					has_regent = no
					NOT = { primary_title = { has_law = justice_voting_power_1 } }
				}	
			}
			FROM = { 
				is_female = yes 
				OR = {
					AND = {
						religion = the_seven
						ROOT = { religion = the_seven }
						NOT = { trait = silent_sister }
						NOT = { trait = septa }
					}
					AND = {
						religion = harpy
						ROOT = { religion = harpy }
						NOT = { trait = grace }
					}				
				}
			}		
		}
		ai_chance = { 
			factor = 25 
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = diligent
			}
			modifier = {
				factor = 4
				trait = honorable
			}
			modifier = {
				factor = 4
				FROM = { dynasty = ROOT }
			}
		}
		FROM = { 
			if = {
				limit = { religion = the_seven }
				add_trait = silent_sister
			}
			if = {
				limit = { religion = harpy }
				add_trait = grace
			}
			recalc_succession = yes
			hidden_tooltip = { character_event = { id = trial_by_combat.125 } }
		} 
	}#option
	option = {
		name = {
			text = "EVTOPTCtrial_by_combat.120" #Back to the Dungeon
			trigger = {
				OR = {
					NOT = { has_dlc = "Zeus" }
					AND = {
						has_regent = no
						NOT = { primary_title = { has_law = justice_voting_power_1 } }
					}	
				}
			}
		}	
		name = {
			text = "EVTOPTFtrial_by_combat.120" #Council decide
			trigger = {
				has_dlc = "Zeus"
				OR = {
					has_regent = yes
					primary_title = { has_law = justice_voting_power_1 } 
				}
			}
		}	
		ai_chance = { 
			factor = 25 
			modifier = {
				factor = 4
				trait = just
			}
			modifier = {
				factor = 4
				trait = paranoid
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -10 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -35 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -60 } }
			}
			modifier = {
				factor = 2
				NOT = { opinion = { who = FROM value = -85 } }
			}
			modifier = {
				factor = 4
				FROM = { dynasty = ROOT }
			}
		}
		if = {
			limit = {
				has_dlc = "Zeus"
				primary_title = { has_law = justice_voting_power_1 } 
			}
			opinion = {
				who = FROM
				modifier = opinion_found_guilty
			}
		}
		FROM = { character_event = { id = trial_by_combat.123 tooltip = TOOLTIPtrial_by_combat.123 } }	
	}
	
	option = {
		name = "EVTOPTDtrial_by_combat.120" #House Arrest
		ai_chance = { 
			factor = 25 
			modifier = {
				factor = 4
				trait = kind
			}
			modifier = {
				factor = 4
				trait = patient
			}
			modifier = {
				factor = 4
				trait = honorable
				FROM = { 
					OR = {
						is_ruler = yes 
						trait = knight
						trait = septon
					}	
				}
			}
			modifier = {
				factor = 4
				FROM = { dynasty = ROOT }
			}
			modifier = {
				factor = 2
				FROM = { is_close_relative = ROOT }
			}
			modifier = {
				factor = 2
				opinion = { who = FROM value = 10 } 
			}
			modifier = {
				factor = 2
				opinion = { who = FROM value = 35 } 
			}
			modifier = {
				factor = 2
				opinion = { who = FROM value = 60 } 
			}
			modifier = {
				factor = 2
				opinion = { who = FROM value = 85 } 
			}
		}
		if = {
			limit = {
				has_dlc = "Zeus"
				primary_title = { has_law = justice_voting_power_1 } 
			}
			opinion = {
				who = FROM
				modifier = opinion_found_guilty
			}
		}
		FROM = { 
			character_event = { id = trial_by_combat.124 tooltip = TOOLTIPtrial_by_combat.124 }
			opinion = {
				who = ROOT
				modifier = opinion_merciful
				months = 60
			}			
		}	
	}
}
#Inform DEATH
character_event = {
   id = trial_by_combat.121
   desc = "EVTDESCtrial_by_combat.121" 
   picture = GFX_evt_beheading
   
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAtrial.22" ##I got killed. Wah!	
		tooltip = {
			death = {
				death_reason = death_execution
				killer = FROM
			}
		}	
		hidden_tooltip = { FROM = { character_event = { id = imprisoned.10 } } } #Select execution method	
	}
}
#Inform Sent to wall
character_event = {
	id = trial_by_combat.122
	desc = "EVTDESCtrial_by_combat.122" 
	picture = GFX_evt_the_wall
   
	is_triggered_only = yes
	
	immediate = {
		clr_character_flag = demmanded_trial_by_combat 
		clr_character_flag = demmanded_first_trial_by_combat
		diplomatic_immunity = no
	}

	option = { 
		name = "EVTOPTAtrial.23" ##I got sent to the wall. Wah!
	}
}
#Inform dungeon
character_event = {
   id = trial_by_combat.123
   desc = "EVTDESCtrial_by_combat.123" 
    picture = "GFX_evt_into_the_dungeon"
   
	is_triggered_only = yes
	
	immediate = { 
		set_character_flag = lost_trial_by_combat 
		clr_character_flag = demmanded_trial_by_combat 
		clr_character_flag = demmanded_first_trial_by_combat
		diplomatic_immunity = no
	}
	
	option = { 
		name = "EVTOPTAtrial_by_combat.123" 
		hidden_tooltip = {
			remove_character_modifier = house_arrest
			remove_character_modifier = the_oubliette
			remove_character_modifier = the_dungeon
		}
		if = {
			limit = { NOT = { character = FROM } }
			add_character_modifier = { 
				name = the_dungeon
				duration = -1
			}
		}
		if = {
			limit = { character = FROM } 
			add_character_modifier = { 
				name = the_dungeon
				duration = 365
			}
		}			
	}
}
#Inform house arrest
character_event = {
   id = trial_by_combat.124
   desc = "EVTDESCtrial_by_combat.124" 
   picture = "GFX_evt_into_the_dungeon"
   
	is_triggered_only = yes
	
	immediate = { 
		set_character_flag = lost_trial_by_combat 
		clr_character_flag = demmanded_trial_by_combat 
		clr_character_flag = demmanded_first_trial_by_combat
		diplomatic_immunity = no
	}
	
	option = { 
		name = "EVTOPTAtrial_by_combat.124" 
		hidden_tooltip = {
			remove_character_modifier = house_arrest
			remove_character_modifier = the_oubliette
			remove_character_modifier = the_dungeon
		}
		if = {
			limit = { NOT = { character = FROM } }
			add_character_modifier = { 
				name = house_arrest
				duration = -1
			}
		}
		if = {
			limit = { character = FROM } 
			add_character_modifier = { 
				name = house_arrest
				duration = 365
			}
		}
		any_dynasty_member = {
			limit = {
				prisoner = yes
				is_close_relative = ROOT
				NOT = { age = 16 }
				host = { character = FROM }	
				NOT = { has_character_modifier = house_arrest }
			}
			hidden_tooltip = {
				remove_character_modifier = the_oubliette
				remove_character_modifier = the_dungeon
			}
			add_character_modifier = { 
				name = house_arrest
				duration = -1
			}
		}
	}
}
#Inform priesthood
character_event = {
   id = trial_by_combat.125
   desc = "EVTDESCtrial_by_combat.125" 
   picture = GFX_evt_King_Lunatic
   
	is_triggered_only = yes
	
	option = { 
		name = "EVTOPTAtrial_by_combat.124"
		hidden_tooltip = {
			remove_spouse = spouse
			if = {
				limit = {
					has_landed_title = d_kingsguard
				}
				set_global_flag = need_commander_kingsguard
				remove_trait = kingsguard
			}
			if = {
				limit = {
					NOT = { has_landed_title = d_kingsguard }
					trait = kingsguard
				}
				remove_trait = kingsguard
			}
			remove_character_modifier = getting_justice
			diplomatic_immunity = no
		}
		prisoner = no
		clr_character_flag = demmanded_first_trial_by_combat
		if = {
			limit = { religion = the_seven }
			add_trait = silent_sister
		}
		if = {
			limit = { religion = harpy }
			add_trait = grace
		}
		if = {
			limit = { is_ruler = yes }
			hidden_tooltip = { #Universal on death/abdication event
				if = {
					limit = { has_character_modifier = owns_valyrian_steel_sword }
					set_character_flag = do_not_inherit_sword
				}
				set_character_flag = abdication
				character_event = { id = 45341 } 
				clr_character_flag = abdication
				clr_character_flag = do_not_inherit_sword
				if = {
					limit = { is_merchant_republic = no }
					transfer_wealth_to_heir_effect = yes
				}
			}
			abdicate = yes
		}
		FROM = {
			random_realm_lord = {
				limit = {
					religion = ROOT
					is_theocracy = yes
				}
				ROOT = { move_character = PREV }
			}
		}
	}
}

###Fire is my Champion!###
#Prisoner/Champion informed Burned alive!
character_event = {
	id = trial_by_combat.24
	desc = "EVTDESCtrial_by_combat.24"
	picture = "GFX_burn_alive" 
	
	is_triggered_only = yes
	
	immediate = {
		hidden_tooltip = { 
			FROM = { 
				set_character_flag = unjust_execution 
				#set_character_flag = special_execution_found
				save_event_target_as = executioner 
			}
			character_event = { id = 45342 } #Universal execution event	
		}	
		mother = {
			character_event = { id = trial_by_combat.25 }			
		}		
		father = {
			character_event = { id = trial_by_combat.25 }	
		}
		any_child = {
			limit = { 
				NOT = { character = FROM }
			}	
			character_event = { id = trial_by_combat.25 }				
		}	
		any_spouse = {
			limit = { 
				NOT = { character = FROM }
				opinion = { who = ROOT value = -25 }
			}	
			character_event = { id = trial_by_combat.25 }				
		}
		any_lover = {
			limit = { 
				NOT = { character = FROM }
			}	
			character_event = { id = trial_by_combat.25 }					
		}
		any_friend = {
			limit = { 
				NOT = { character = FROM }
			}	
			character_event = { id = trial_by_combat.25 }					
		}
		any_dynasty_member = {
			limit = { 
				is_close_relative = ROOT
				NOT = { character = FROM }
			}	
			character_event = { id = trial_by_combat.25 }					
		}
	}
	
	option = {
		name = "EVTOPTAtrial_by_combat.24" 
		death = {
			death_reason = death_execution
			killer = FROM
		}		
	}
}
character_event = { #Inform family
	id = trial_by_combat.25
	desc = "EVTDESCtrial_by_combat.25"
	picture = "GFX_burn_alive" 
	
	is_triggered_only = yes	
	
	option = {
		name = "EVTOPTAtrial_by_combat.24"  #
	}
}
#Inform Prisoner Champion Burned alive!
character_event = {
	id = trial_by_combat.26
	desc = "EVTDESCtrial_by_combat.26"
	picture = "GFX_burn_alive" 
	
	is_triggered_only = yes	
	
	immediate = { 
		FROM = { 
			set_character_flag = unjust_execution
		}
	} 
	
	option = {
		name = "EVTOPTAtrial_by_combat.26"  #
		FROMFROMFROM = {
			custom_tooltip = { text = TOOLTIPEVTtrial_by_combat.26 }
		}
		tooltip = {
			death = {
				death_reason = death_execution
				killer = FROM
			}
		}	
		hidden_tooltip = { FROM = { character_event = { id = imprisoned.10 } } } #Select execution method	
	}
}

#unlanded prisoner selects champion
character_event = { 
	id = trial_by_combat.27
	desc = "EVTDESCtrial_by_combat.27"
	picture = "GFX_trial_by_combat"
	
	is_triggered_only = yes
	
	trigger = {
		prisoner = yes
		NOT = { trait = incapable }
	}
	
	immediate = {
		#Find dynast 1
		random_dynasty_member = {
			limit = {
				OR = {
					trait = skilled_warrior
					trait = master_warrior
				}				
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes
			}
			save_event_target_as = AI_champion_1
			set_character_flag = tbc_champion
		}
		if = {
			limit = { NOT = { event_target:AI_champion_1 = { always = yes } } }
			random_dynasty_member = {
				limit = {
					trait = trained_warrior				
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes
				}
				save_event_target_as = AI_champion_1
				set_character_flag = tbc_champion
			}
		}	
		#Find dynast 2
		random_dynasty_member = {
			limit = {
				OR = {
					trait = skilled_warrior
					trait = master_warrior
				}				
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes
				NOT = { has_character_flag = tbc_champion }
			}
			save_event_target_as = AI_champion_2
			set_character_flag = tbc_champion
		}
		if = {
			limit = { NOT = { event_target:AI_champion_2 = { always = yes } } }
			random_dynasty_member = {
				limit = {
					trait = trained_warrior				
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes
					NOT = { has_character_flag = tbc_champion }
				}
				save_event_target_as = AI_champion_2
				set_character_flag = tbc_champion
			}
			if = { #If no 2nd dynasty found try a courtier
				limit = { NOT = { event_target:AI_champion_2 = { always = yes } } }
				random_courtier = {
					limit = {
						OR = {
							trait = skilled_warrior
							trait = master_warrior
						}					
						eligible_trial_by_combat_champion_for_ROOT_trigger = yes
						NOT = { has_character_flag = tbc_champion }
					}
					save_event_target_as = AI_champion_2
					set_character_flag = tbc_champion
				}
				if = {
					limit = { NOT = { event_target:AI_champion_2 = { always = yes } } }
					random_courtier = {
						limit = {
							trait = trained_warrior						
							eligible_trial_by_combat_champion_for_ROOT_trigger = yes
							NOT = { has_character_flag = tbc_champion }
						}
						save_event_target_as = AI_champion_2
						set_character_flag = tbc_champion
					}
				}
			}	
		}			
		#Champion 3
		random_courtier = {
			limit = {
				OR = {
					trait = skilled_warrior
					trait = master_warrior
				}					
				eligible_trial_by_combat_champion_for_ROOT_trigger = yes
				NOT = { has_character_flag = tbc_champion }
			}
			save_event_target_as = AI_champion_3
			break = yes
		}
		if = { 
			limit = { NOT = { event_target:AI_champion_3 = { always = yes } } }
			random_courtier = {
				limit = {
					trait = trained_warrior				
					eligible_trial_by_combat_champion_for_ROOT_trigger = yes
					NOT = { has_character_flag = tbc_champion }
				}
				save_event_target_as = AI_champion_3
			}
		}	
	}
	
	option = { # champion 1
		name = "EVTOPTAtrial_by_combat.6" 
		trigger = {
			event_target:AI_champion_1 = { always = yes }
		}
		ai_chance = { 
			factor = 50 
			modifier = {
				factor = 2
				event_target:AI_champion_1 = {
					trait = trained_warrior
				}
			}
			modifier = {
				factor = 5
				event_target:AI_champion_1 = {
					trait = skilled_warrior
				}
			}
			modifier = {
				factor = 10
				event_target:AI_champion_1 = {
					trait = master_warrior
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_1 = {
					is_strong_trigger = yes
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_1 = {
					trait = brave
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_1 = {
					trait = tall
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_1 = {
					trait = wroth
				}
			}	
		}
		event_target:AI_champion_1 = {
			letter_event = { id = trial_by_combat.1 } 
			clr_character_flag = tbc_champion
		}	
		hidden_tooltip = { 
			event_target:AI_champion_2 = { clr_character_flag = tbc_champion } 
			clear_event_target = AI_champion_1
			clear_event_target = AI_champion_2
			clear_event_target = AI_champion_3
		}
	}
	option = { # champion 2 dynast
		name = "EVTOPTBtrial_by_combat.6" 
		trigger = {
			event_target:AI_champion_2 = { always = yes }
		}
		ai_chance = { 
			factor = 50 
			modifier = {
				factor = 2
				event_target:AI_champion_2 = {
					trait = trained_warrior
				}
			}
			modifier = {
				factor = 5
				event_target:AI_champion_2 = {
					trait = skilled_warrior
				}
			}
			modifier = {
				factor = 10
				event_target:AI_champion_2 = {
					trait = master_warrior
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_2 = {
					is_strong_trigger = yes
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_2 = {
					trait = brave
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_2 = {
					trait = tall
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_2 = {
					trait = wroth
				}
			}
		}
		event_target:AI_champion_2 = {
			letter_event = { id = trial_by_combat.1 } 
			clr_character_flag = tbc_champion
		}		
		hidden_tooltip = { 
			event_target:AI_champion_1 = { clr_character_flag = tbc_champion } 
			clear_event_target = AI_champion_1
			clear_event_target = AI_champion_2
			clear_event_target = AI_champion_3
		}		
	}
	option = { # champion 3
		name = "EVTOPTCtrial_by_combat.6" 
		trigger = {
			event_target:AI_champion_3 = { always = yes }
		}
		ai_chance = { 
			factor = 50 
			modifier = {
				factor = 2
				event_target:AI_champion_3 = {
					trait = trained_warrior
				}
			}
			modifier = {
				factor = 5
				event_target:AI_champion_3 = {
					trait = skilled_warrior
				}
			}
			modifier = {
				factor = 10
				event_target:AI_champion_3 = {
					trait = master_warrior
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_3 = {
					is_strong_trigger = yes
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_3 = {
					trait = brave
				}
			}
			modifier = {
				factor = 2
				event_target:AI_champion_3 = {
					trait = tall
				}
			}
			modifier = {
				factor = 1.5
				event_target:AI_champion_3 = {
					trait = wroth
				}
			}	
		}
		event_target:AI_champion_3 = {
			letter_event = { id = trial_by_combat.1 } 
		}		
		hidden_tooltip = { 
			event_target:AI_champion_1 = { clr_character_flag = tbc_champion } 
			event_target:AI_champion_2 = { clr_character_flag = tbc_champion } 
			clear_event_target = AI_champion_1
			clear_event_target = AI_champion_2
			clear_event_target = AI_champion_3
		}		
	}
	option = { # I will fight
		name = "EVTOPTDtrial_by_combat.6" 
		trigger = {
			age = 16
			is_ill = no
			NOT = { has_severe_disability_trigger = yes }
			OR = {
				trait = poor_warrior
				trait = trained_warrior
				trait = skilled_warrior
				trait = master_warrior
			}	
			OR = {
				is_female = no
				culture = kayakayanayan
				culture = samyrianan
				culture = bayasabhadi
				AND = {
					OR = {
						trait = skilled_warrior
						trait = master_warrior
					}	
					OR = {
						trait = brave
						is_strong_trigger = yes
					}	
				}
			}
		}
		ai_chance = { 
			factor = 50 
			modifier = {
				factor = 2
				trait = trained_warrior
			}
			modifier = {
				factor = 5
				trait = skilled_warrior
			}
			modifier = {
				factor = 10
				trait = master_warrior
			}
			modifier = {
				factor = 2
				is_strong_trigger = yes
			}
			modifier = {
				factor = 2
				trait = brave
			}
			modifier = {
				factor = 2
				trait = tall
			}
			modifier = {
				factor = 2
				trait = wroth
			}	
			modifier = {
				factor = 0.5
				trait = patient
			}
			modifier = {
				factor = 0.1
				is_weak_trigger = yes
			}
			modifier = {
				factor = 0.05
				trait = craven
			}
			modifier = {
				factor = 0.1
				trait = dwarf
			}
			modifier = {
				factor = 0.25
				health_traits = 1
			}
			modifier = {
				factor = 0.5
				OR = {
					is_dumb_trigger = yes
					trait = imbecile
				}
			}
		}
		clr_character_flag = choosing_champion
		hidden_tooltip = { 
			event_target:AI_champion_1 = { clr_character_flag = tbc_champion } 
			event_target:AI_champion_2 = { clr_character_flag = tbc_champion } 
			clear_event_target = AI_champion_1
			clear_event_target = AI_champion_2
			clear_event_target = AI_champion_3
		}
		host = {
			character_event = {
				id = trial_by_combat.4
			}
		}
	}
	
	option = { # No eligible champions
		name = "EVTOPTDtrial_by_combat.6" 
		ai_chance = {
			factor = 1
			modifier = {
				factor = 0.01
			}
		}
		clear_event_target = AI_champion_1
		clear_event_target = AI_champion_2
		clear_event_target = AI_champion_3
	}
}
