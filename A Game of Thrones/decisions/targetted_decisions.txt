# Targetted decisions are possible vs _all_ other characters and shown are in the Diplomacy View, not the Intrigue View. The taker is in the FROM scope.
#
# ai_target_filter = [self/court/home_court/vassals/sub_realm/realm/dynasty/all] (which characters for which the AI evaluates the decision.)
#	court: all characters in the AI's host court, including prisoners, and characters currently away (wards, prisoners, etc)
#	home_court: all characters in the AI's home court, including prisoners, and characters currently away (wards, prisoners, etc)
#	vassals: direct vassal rulers of the AI's employer
#	sub_realm: all characters below the AI's employer
#	realm: all characters in the same top realm as the AI
#	dynasty: all members of the same dynasty
#	rivals: your rivals plus any character you have an opinion modifier with 'crime = yes' set (the same set of characters the 'is_foe' trigger evaluates)
#	all: all living characters (Avoid if possible. VERY CPU-HEAVY!)
#	

targetted_decisions = {
	commit_suicide = {
		ai_target_filter = self
		filter = self
		only_playable = yes
		
		potential = {
			ai = no
			age = 32
			OR = {
				trait = depressed
				AND = {
					trait = incapable
					has_dlc = "Reapers"
				}
			}
			immortal = no
		}
		allow = {
			custom_tooltip = {
				text = commit_suicide_allow_tooltip
				hidden_tooltip = {
					OR = {
						trait = depressed
						trait = incapable
					}
				}
			}
			custom_tooltip = {
				NOT = { has_character_flag = attempting_suicide }
				text = attempting_suicide_tooltip
			}
			prisoner = no
		}
		effect = {
			if = {
				limit = { has_dlc = "Reapers" }
				set_character_flag = attempting_suicide
				if = {
					limit = { NOT = { trait = incapable } }
					character_event = { id = RIP.30200 }
				}
				if = {
					limit = { trait = incapable } 
					character_event = { id = RIP.30210 }
				}
			}
			if = {
				limit = { NOT = { has_dlc = "Reapers" } }
				prestige = -200
				add_character_modifier = {
					modifier = suicide
					duration = -1
				}
				death = { death_reason = death_suicide }
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	cadet_bastard = {	
		ai_target_filter = dynasty
		filter = dynasty
		only_playable = yes
		
		from_potential = {
			ai = no
			is_ruler = yes
		}
		potential = {
			trait = bastard
			NOT = { trait = child_of_consort } #salt child
			NOT = { trait = maester }
			NOT = { trait = archmaester }
			NOT = { trait = septon }
			NOT = { trait = septa }
			NOT = { trait = red_priest }
			NOT = { trait = nightswatch }
			NOT = { trait = silent_sister }
			NOT = { trait = kingsguard }
			dynasty = FROM
			OR = {
				is_child_of = FROM
				sibling = FROM
			}
			is_liege_or_above = FROM
			prisoner = no
		}
		allow = {
			age = 16
			is_female = no
			trait = bastard
			from = { demesne_size = 2 }
			or = {
				FROM = { prestige = 2000 }
				trait = ambitious
				trait = genius
				is_smart_trigger = yes
				is_strong_trigger = yes
				or = { 
					learning = 10
					martial = 15
					intrigue = 15
					diplomacy = 15
					stewardship = 12
				}
			}
			from = {
				demesne_size = 2
				any_demesne_title = {
					can_be_given_away = yes
					NOT = { tier = duke }
					NOT = { tier = emperor }
					NOT = { title = c_bloody_gate }
					OR = {
						NOT = { title = c_summerhall }
						NOT = {
							holder_scope = {
								NOT = { dynasty = ROOT }
								dynasty = 496
							}
						}	
					}
					OR = {
						NOT = { title = c_dragonstone }
						NOT = {
							holder_scope = {
								has_landed_title = e_iron_throne
							}
						}	
					}
					NOT = {
						AND = {
							tier = count
							location = {
								is_capital = yes
							}						
						}
					}
				}
			}
		}
		effect = {
			# remove_trait = bastard
			# add_trait = legit_bastard
			# mother = {
				# opinion = {
					# who = FROM
					# modifier = legitimized_child
					# years = 10
				# }
			# }
			FROM = {
				set_character_flag = asked_for_landed_title
				character_event = { id = 37001 } #asked for landed title
				prestige = -250	
				hidden_tooltip = { 
					character_event = { id = cadet.12 days = 2 } #remove nickname/chronicle
				} 
				#Dynasty is one of the scripted houses
				trigger_switch = {
					on_trigger = dynasty
					59 	= { character_event = { id = cadet.1 } break = yes } #Stark
					496 = { character_event = { id = cadet.2 } break = yes } #Targ
					190 = { character_event = { id = cadet.3 } break = yes } #Lannister
					1	= { character_event = { id = cadet.4 } break = yes } #Martell
					159 = { character_event = { id = cadet.5 } break = yes } #Tully
					178 = { character_event = { id = cadet.6 } break = yes } #Arryn
					317 = { character_event = { id = cadet.7 } break = yes } #Baratheon
					253 = { character_event = { id = cadet.8 } break = yes } #Tyrell
					107 = { character_event = { id = cadet.9 } break = yes } #Greyjoy
					127 = { character_event = { id = cadet.13 } break = yes } #Frey
					38 	= { character_event = { id = cadet.20 } break = yes } #Rosby
					36	= { character_event = { id = cadet.22 } break = yes } #Rykker
					30	= { character_event = { id = cadet.22 } break = yes } #Thorne
					45	= { character_event = { id = cadet.23 } break = yes } #Bywater
					52	= { character_event = { id = cadet.24 } break = yes } #Velaryon
					50	= { character_event = { id = cadet.25 } break = yes } #Celtigar
					46	= { character_event = { id = cadet.26 } break = yes } #Massey
					150	= { character_event = { id = cadet.27 } break = yes } #Blackwood
					149	= { character_event = { id = cadet.28 } break = yes } #Bracken
					128	= { character_event = { id = cadet.29 } break = yes } #Mallister
					157	= { character_event = { id = cadet.30 } break = yes } #Piper
					301	= { character_event = { id = cadet.31 } break = yes } #Caron
					306	= { character_event = { id = cadet.32 } break = yes } #Swann
					319	= { character_event = { id = cadet.33 } break = yes } #Buckler
					330	= { character_event = { id = cadet.34 } break = yes } #Estermont
					329	= { character_event = { id = cadet.35 } break = yes } #Wylde
					54	= { character_event = { id = cadet.36 } break = yes } #Tarth
					307	= { character_event = { id = cadet.37 } break = yes } #Toyne
					9	= { character_event = { id = cadet.38 } break = yes } #Allyrion
					16	= { character_event = { id = cadet.39 } break = yes } #Dayne
					14	= { character_event = { id = cadet.40 } break = yes } #Fowler
					10	= { character_event = { id = cadet.41 } break = yes } #Jordayne
					13	= { character_event = { id = cadet.42 } break = yes } #Uller
					12	= { character_event = { id = cadet.43 } break = yes } #Yronwood
					112	= { character_event = { id = cadet.44 } break = yes } #Goodbrother
					122	= { character_event = { id = cadet.45 } break = yes } #Harlaw
					121	= { character_event = { id = cadet.46 } break = yes } #Drumm
					114	= { character_event = { id = cadet.47 } break = yes } #Farwynd
					161	= { character_event = { id = cadet.48 } break = yes } #Belmore
					176	= { character_event = { id = cadet.49 } break = yes } #Corbray
					186	= { character_event = { id = cadet.50 } break = yes } #Grafton
					177	= { character_event = { id = cadet.51 } break = yes } #Hunter
					187	= { character_event = { id = cadet.52 } break = yes } #Royce
					182	= { character_event = { id = cadet.53 } break = yes } #Waynwood
					189	= { character_event = { id = cadet.54 } break = yes } #Waxley
					363	= { character_event = { id = cadet.55 } break = yes } #Sunderland
					171	= { character_event = { id = cadet.56 } break = yes } #Baelish
					601	= { character_event = { id = cadet.56 } break = yes } #Baelish Mockingbird
					87	= { character_event = { id = cadet.57 } break = yes } #Bolton
					79	= { character_event = { id = cadet.58 } break = yes } #Dustin
					84	= { character_event = { id = cadet.59 } break = yes } #Flint
					89	= { character_event = { id = cadet.60 } break = yes } #Karstark
					80	= { character_event = { id = cadet.61 } break = yes } #Manderly
					102	= { character_event = { id = cadet.62 } break = yes } #Mormont
					126	= { character_event = { id = cadet.63 } break = yes } #Reed
					68	= { character_event = { id = cadet.64 } break = yes } #Ryswell
					93	= { character_event = { id = cadet.65 } break = yes } #Umber
					62	= { character_event = { id = cadet.66 } break = yes } #Glover
					83	= { character_event = { id = cadet.67 } break = yes } #Hornwood
					265	= { character_event = { id = cadet.68 } break = yes } #Ashford
					285	= { character_event = { id = cadet.69 } break = yes } #Hightower
					270	= { character_event = { id = cadet.70 } break = yes } #Meadows
					237	= { character_event = { id = cadet.71 } break = yes } #Oakheart
					298	= { character_event = { id = cadet.72 } break = yes } #Peake
					288	= { character_event = { id = cadet.73 } break = yes } #Redwyne
					250	= { character_event = { id = cadet.74 } break = yes } #Rowan
					296	= { character_event = { id = cadet.75 } break = yes } #Tarly
					248	= { character_event = { id = cadet.76 } break = yes } #Footly
					234	= { character_event = { id = cadet.77 } break = yes } #Crane
					281	= { character_event = { id = cadet.78 } break = yes } #Florent
					1428 = { character_event = { id = cadet.79 } break = yes } #Strickland
					235	= { character_event = { id = cadet.80 } break = yes } #Osgrey
					216	= { character_event = { id = cadet.81 } break = yes } #Brax
					227	= { character_event = { id = cadet.82 } break = yes } #Crakehall
					195	= { character_event = { id = cadet.83 } break = yes } #Kenning
					213	= { character_event = { id = cadet.84 } break = yes } #Lefford
					208	= { character_event = { id = cadet.85 } break = yes } #Payne
					233	= { character_event = { id = cadet.86 } break = yes } #Sarsfield
					221	= { character_event = { id = cadet.87 } break = yes } #Serret
					199	= { character_event = { id = cadet.88 } break = yes } #Westerling
					212	= { character_event = { id = cadet.89 } break = yes } #Marbrand
					228	= { character_event = { id = cadet.90 } break = yes } #Swyft
					197	= { character_event = { id = cadet.91 } break = yes } #Reyne
					196	= { character_event = { id = cadet.92 } break = yes } #Prester
					207	= { character_event = { id = cadet.93 } break = yes } #Lorch
					204	= { character_event = { id = cadet.94 } break = yes } #Foote
					226	= { character_event = { id = cadet.95 } break = yes } #Plumm
				}
				#If your dynasty is not one of the scripted houses
				character_event = { id = cadet.11 } #New Dynasty
			}	
		}
		ai_will_do = {
			factor = 0
		}
	}
	legitimise_cadet = {
		is_high_prio = yes
		only_playable = yes
		filter = realm
		ai_target_filter = court
		from_potential = {
			ai = no #Ai can do this by bi-yearly event cadet.16
			has_dynasty_flag = has_cadet_house
			dynasty_head = { character = PREV }
		}
		potential = {
			has_dynasty_flag = is_cadet_house
			dynasty_head = { character = PREV }
			assign_mission_target = { #'Father' of cadet house
				dynasty = FROM
				ROOT = { has_dynasty_flag = cadet_house_@PREV }
			}
			ai = yes
			NOT = { dynasty = FROM }
			NOT = { is_child_of = FROM }
		}
		allow = {
			custom_tooltip = {
				text = TOOLTIPlegitimise_cadetA
				hidden_tooltip = {
					FROM = {
						NOT = { 
							any_dynasty_member = { 
								is_alive = yes
								can_inherit_titles_trigger = yes
								NOT = { character = PREV }
							} 
						}
					}
				}	
			}	
			lower_tier_than = FROM
			OR = {
				is_ruler = no
				opinion = { who = FROM value = 0 }
			}	
			NOT = { trait = nightswatch }
			NOT = { trait = kingsguard }
			NOT = { trait = archmaester }
			is_theocracy = no
		}
		effect = {
			custom_tooltip = { text = TOOLTIPlegitimise_cadet }
			prestige = -200
			hidden_tooltip = {
				clr_dynasty_flag = is_cadet_house
				assign_mission_target = { #'Father' of cadet house
					limit = {
						dynasty = FROM
						ROOT = { has_dynasty_flag = cadet_house_@PREV }
					}	
					random_child_even_if_dead = {
						limit = { 
							dynasty = ROOT 
							trait = bastard
						}
						remove_trait = bastard
						add_trait = legit_bastard
						if = {
							limit = {
								OR = {
									has_nickname = nick_snow
									has_nickname = nick_rivers
									has_nickname = nick_stone
									has_nickname = nick_hill
									has_nickname = nick_flowers
									has_nickname = nick_storm
									has_nickname = nick_waters
									has_nickname = nick_sand
									has_nickname = nick_pyke
								}
							}
							remove_nickname = yes
						}
					}	
					ROOT = { clr_dynasty_flag = cadet_house_@PREV }
				}			
				save_event_target_as = legitmised_cadet
				FROM = { 
					save_event_target_as = cadet_legitimiser
					##inform realm
					letter_event = { id = cadet.17 }
					any_realm_lord = { 
						limit = { 
							ai = no
							NOT = { dynasty = ROOT } 
						}
						letter_event = { id = cadet.17 }
					}
					liege = {
						if = {
							limit = { 
								ai = no
								NOT = { character = ROOT_FROM }
								NOT = { dynasty = ROOT } 
							}
							letter_event = { id = cadet.17 }
							any_vassal = {
								limit = { 
									ai = no
									NOT = { character = ROOT_FROM }
									NOT = { dynasty = ROOT } 
								}
								letter_event = { id = cadet.17 }
							}
						}	
					}
					##
				}
				letter_event = { id = cadet.15 days = 1 }
				any_dynasty_member = {
					limit = { 
						ai = no 
						NOT = { character = PREV }
					}
					letter_event = { id = cadet.15 days = 1 }
				}						
				if = { #check if any cadet houses remain
					limit = {
						NOT = {
							assign_mission_target = { #'Father' of cadet house
								dynasty = FROM
								any_character = { has_dynasty_flag = cadet_house_@PREV }
							}
						}	
					}
					FROM = { clr_dynasty_flag = has_cadet_house }
				}
			}	
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0	
		}
	}
	legitimize_bastard = {
		ai_target_filter = dynasty
		filter = dynasty
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			NOT = { trait = bastard }
			NOT = { dynasty = 0 }
		}
		
		potential = {
			trait = bastard
			NOT = { trait = child_of_consort } #salt child
			NOT = { trait = maester }
			NOT = { trait = archmaester }
			NOT = { trait = septon }
			NOT = { trait = septa }
			NOT = { trait = red_priest }
			NOT = { trait = nightswatch }
			NOT = { trait = silent_sister }
			NOT = { trait = kingsguard }
			is_child_of = FROM
			is_liege_or_above = FROM
		}
		allow = {
			FROM = {
				OR = {
					has_regent = no
					regent = { opinion = { who = ROOT value = 0 } }
				}
				OR = {
					piety = 20
					job_priest = { opinion = { who = PREV value = 0 } }
				}
			}
		}
		effect = {
			tooltip = {
				remove_trait = bastard
				add_trait = legit_bastard
			}
			tooltip = {
				if = {
					limit = {
						is_patrician = no
					}
					dynasty = FROM		
				}
			}	
			mother = {
				opinion = {
					who = FROM
					modifier = legitimized_child
					years = 10
				}
			}				
			FROM = { 
				if = {
					limit = {
						has_dlc = "Conclave"
						NOT = { piety = 20 }
					}
					job_priest = { add_favor = PREV }
				}
				piety = -20 
				any_child = {
					limit = {
						NOT = { character = ROOT }
						dynasty = PREV
						NOT = { trait = bastard }
					}
					opinion = {
						who = PREV
						modifier = legitimized_bastard
						months = 36
					}
				}
				any_spouse = {
					limit = {
						NOT = {
							any_child = {
								character = ROOT
							}	
						}
					}
					opinion = {
						who = PREV
						modifier = legitimized_bastard
						years = 20
					}
				}
			}
			if = {
				limit = {
					prisoner = yes
					host = { character = FROM }
				}
				imprison = no
			}	
				
			hidden_tooltip = {
				character_event = { id = bastard.999 } #generic legitimise event
			}
			event_target:chronicle_player = {
				if = {
					limit = { 
						OR = {	
							character = FROM
							is_close_relative = ROOT
							is_liege_or_above = FROM
						}
					}
					chronicle = {
						entry = CHRONICLE_BASTARD_LEGITIMISED
						portrait = [Root.GetID]
					}	
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1	
			modifier = {
				factor = 0.05
			}	
			modifier = {
				factor = 0
				FROM = {
					OR = {
						NOT = { age = 40 }
						trait = honorable
						trait = just
						NOT = { opinion = { who = ROOT value = -39 } }
						current_heir = { is_child_of = PREV }
						current_heir = { dynasty = PREV }
						primary_title = { has_law = succ_feudal_elective }
						AND = {
							ROOT = { is_female = yes }
							primary_title = {
								OR = {
									has_law = cognatic_succession
									has_law = agnatic_succession
								}
							}
						}
						AND = {
							ROOT = { is_female = no }
							primary_title = {
								OR = {
									has_law = enatic_succession
									has_law = enatic_cognatic_succession
								}
							}
						}
					}	
				}	
				NOT = { #Make exception if married to the mother
					mother = { 
						is_married = FROM 
						reverse_opinion = { who = FROM value = 20 }
					} 
				}
			}
		}
	}
	
	legitimize_salt_child = {
		ai_target_filter = dynasty
		filter = dynasty
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes
			religion = drowned_god
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			NOT = { dynasty = 0 }
		}
		
		potential = {
			trait = child_of_consort
			trait = bastard
			#trait = disinherited
			is_child_of = FROM
		}
		allow = {
			FROM = {
				OR = {
					has_regent = no
					regent = { opinion = { who = ROOT value = 0 } }
				}
			}
		}
		effect = {
			#remove_trait = disinherited			
			remove_trait = bastard
			if = {
				limit = { NOT = { dynasty = FROM } }
				hidden_tooltip = {
					any_child_even_if_dead = {
						limit = { dynasty = ROOT }
						dynasty = FROM
						any_child_even_if_dead = {
							limit = { dynasty = ROOT }
							dynasty = FROM
							any_child_even_if_dead = {
								limit = { dynasty = ROOT }
								dynasty = FROM
							}
						}
					}
				}
				dynasty = FROM
			}
			FROM = { 
				if = {
					limit = { 
						primary_title = { 
							has_law = succ_primogeniture 
							OR = {
								has_law = true_cognatic_succession
								AND = {
									ROOT = { is_female = no }
									OR = {
										has_law = agnatic_succession
										has_law = cognatic_succession
									}
								}
								AND = {
									ROOT = { is_female = yes }
									OR = {
										has_law = enatic_succession
										has_law = enatic_cognatic_succession
									}
								}
							}
						} 
						current_heir = {
							NOT = { is_older_than = ROOT }
							NOT = { trait = child_of_consort }
							is_child_of = PREV
						}
					}
					piety = -150
					prestige = -150
					current_heir = {
						opinion = {
							who = PREV
							modifier = opinion_disinherited_me
							months = 240
						}
						prestige = -150
					}
				}	
			}	
			recalc_succession = yes
			event_target:chronicle_player = {
				if = {
					limit = { 
						OR = {	
							character = FROM
							is_close_relative = ROOT
							is_liege_or_above = FROM
						}
					}
					chronicle = {
						entry = CHRONICLE_SALT_CHILD_LEGITIMISED
						portrait = [Root.GetID]
					}	
				}
			}
		}
		
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1	
			modifier = {
				factor = 0.05
			}	
			modifier = {
				factor = 0
				FROM = {
					OR = {
						NOT = { opinion = { who = ROOT value = -39 } }
						current_heir = { is_child_of = PREV }
						NOT = { age = 30 }
					}	
				}	
			}
			modifier = {
				factor = 0
				is_female = yes
				FROM = {
					primary_title = {
						OR = {
							has_law = cognatic_succession
							has_law = agnatic_succession
						}
					}					
				}	
			}
			modifier = {
				factor = 0
				is_female = no
				FROM = {
					primary_title = {
						OR = {
							has_law = enatic_succession
							has_law = enatic_cognatic_succession
						}
					}					
				}	
			}
			modifier = {
				factor = 0.2
				FROM = { NOT = { graphical_culture = ROOT } }
			}
		}
	}
	
	employ_concubine = {
		ai_target_filter = sub_realm
		filter = sub_realm
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes
			is_female = no	
			OR = {
				has_dlc = "The Old Gods"
				ai = yes
			}
			age = 16
			has_concubinage = yes		
		}
		potential = {
			is_lover = FROM
			is_female = yes
			is_married = no
			is_betrothed = no
			is_consort = no
			is_ruler = no		
			NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_set_aside } }
		}
		allow = {
			NOT = { liege = { is_close_relative = PREV } }
			NOT = { any_heir_title = { always = yes } }
			FROM = {
				below_consort_limit_trigger = yes
				OR = {
					culture_group = dornish
					NOT = { religion = the_seven }
				}	
				NOT = { culture_group = andal }
				NOT = { culture_group = first_men }
			}			
		}
		effect = {
			add_consort = FROM
			FROM = {
				if = {
					limit = { culture_group = dornish }
					any_consort = {
						limit = {
							NOT = { is_lover = ROOT }
							NOT = { trait = slave }
						}
						remove_consort = ROOT
					}
				}
			}	
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.5
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						trait = chaste
						trait = celibate
						trait = homosexual
						trait = eunuch
					}
				}	
			}
		}
	}
	
	vassal_castrate_decision_AGOT = {
		filter = court
		ai_target_filter = court
		only_rulers = yes
		
		from_potential = {
			has_dlc = "Legacy of Rome"
			is_ruler = yes
			OR = {
				trait = cruel
				trait = lunatic
				trait = impaler
				culture = moon_clansman
			}
		}
	
		potential = {		
			prisoner = yes
			is_female = no
			NOT = { trait = eunuch }
			NOT = { trait = dragon }
			NOT = { trait = white_walker }
			host = { character = FROM }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_kidnapped
				}
			}	
			OR = {
				NOT = { has_character_flag = demmanded_trial_by_combat }
				had_character_flag = { flag = demmanded_trial_by_combat days = 365 } 
			}			
		}
		allow = {
			FROM = {
				OR = {
					has_dlc = "Zeus"
					has_regent = no
					regent = { 
						NOT = { opinion = { who = ROOT value = -25 } }
						NOT = { trait = kind }
						NOT = { trait = just }
						NOT = { trait = honorable }
					}
				}
			}
			prisoner = yes
			NOT = { has_character_modifier = getting_justice }
		}
		effect = {
			hidden_tooltip = {
				if = {
					limit = { age = 16}
					FROM = {
						character_event = { id = LoR.832 }
					}
				}
				if = {
					limit = { NOT = { age = 16 } }
					FROM = {
						character_event = { id = LoR.834 }
					}
				}
			}
			character_event = { id = LoR.833 tooltip = "EVTTOOLTIPLoR.833" }
			tooltip = {
				add_trait = eunuch
				prisoner = no
			}	
			opinion = {
				modifier = opinion_castrated_me
				who = FROM
			}
			FROM = {
				if = {
					limit = {
						NOR = {
							trait = cruel
							trait = kind
						}
					}
					random = {
						chance = 25
						add_trait = cruel
						hidden_tooltip = { character_event = { id = 38259 } }
					}
				}

				if = {
					limit = { trait = kind }
					random = { 
						chance = 50
						remove_trait = kind
						hidden_tooltip = {
							character_event = { id = 38307 }
						}
					}
					hidden_tooltip = {
						random_list = {
							30 = {
								add_trait = stressed
								hidden_tooltip = { character_event = { id = 38282 } }
							}
							10 = {
								add_trait = depressed
								hidden_tooltip = { character_event = { id = 38288 } }
							}
							60 = {
								#nothing
							}
						}
					}
				}
				if = {
					limit = { NOT = { religion = nath_pagan } }
					piety = -60
				}
				if = {
					limit = { religion = nath_pagan }
					piety = -60
					custom_tooltip = { text = nath_pagan_ahimsa_tooltip }
				}
				hidden_tooltip = { character_event = { id = 45361 days = 1 } }#check for tyranny for going against council
			}
			add_fear_torture_effect = yes
			hidden_tooltip = {
				# if = {
					# limit = { FROM = { NOT = { dynasty = ROOT } } }
					# any_dynasty_member = {
						# opinion = {
							# modifier = opinion_castrated_family
							# who = FROM
						# }
					# }
				# }
				father = { 
					opinion = { who = FROM modifier = opinion_castrated_son } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8340 }
					}
				}
				mother = { 
					opinion = { who = FROM modifier = opinion_castrated_son } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8340 }
					}
				}
				any_dynasty_member = {
					limit = {
						is_close_relative = ROOT
						NOT = { any_child = { character = ROOT } } 
					}
					opinion = { who = FROM modifier = opinion_castrated_kin }
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8340 }
					}
				}
				any_spouse = {
					limit = { opinion = { who = ROOT value = -25 } }
					opinion = { who = FROM modifier = opinion_castrated_spouse }
				}
				any_spouse = {
					limit = { ai = no }
					character_event = { id = LoR.8340 }
				}
				any_lover = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
					}
					opinion = { who = FROM modifier = opinion_tortured_lover } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8340 }
					}
				}
				any_friend = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
						NOT = { is_lover = ROOT }
					}
					opinion = { who = FROM modifier = opinion_tortured_friend } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8340 }
					}
				}
				liege = {
					if = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = LoR.8340 }
					}	
				}
				if = {
					limit = { is_ruler = yes }
					any_realm_lord = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = LoR.8340 }
					}
				}	
				FROM = {
					save_event_target_as = remove_prison_reason_effect_accuser
					ROOT = { save_event_target_as = remove_prison_reason_effect_accused }
					hidden_tooltip = { remove_prison_reason_effect = yes }
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.01 # Less likely to do it
			}
			modifier = {
				factor = 0
				religion = nath_pagan
				NOT = { trait = cynical }
			}
			modifier = {
				factor = 0
				reverse_opinion = { who = FROM value = 20 }
				FROM = { NOT = { trait = lunatic } }
			}
			modifier = {
				factor = 0
				FROM = { 
					OR = {
						trait = kind 
						trait = just
						trait = honorable 
					}	
				}
			}	
			modifier = { #trying to inspire fear
				factor = 2
				FROM = {
					OR = {
						trait = ruthless
						trait = cruel
					}
					OR = {
						is_close_relative = ROOT
						is_vassal_or_below = ROOT
						ROOT = { liege = { liege_before_war = { character = ROOT_FROM } } }
					}
				}
			}
			modifier = {
				factor = 0.1
				OR = {
					is_lover = FROM
					is_consort = FROM
					is_married = FROM
				}	
			}			
			modifier = {
				factor = 0.1 #Enemy has your relative
				FROM = {
					any_current_enemy = {
						dynasty = ROOT
						is_close_relative = ROOT
						any_courtier = {
							is_close_relative = FROM
							dynasty = FROM
						}
					}
				}
			}
			modifier = {
				factor = 0 #Is your enemy and can enforce a victory
				FROM = {
					any_current_enemy = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 4
				any_claim = { holder_scope = { character = FROM } }
				NOT = { is_child_of = FROM }
			}
			modifier = {
				factor = 2
				is_pretender = yes
				FROM = {
					OR = {
						is_pretender = yes
						is_primary_heir = yes
					}
				}
				any_pretender_title = {
					OR = {
						current_heir = { character = FROM }
						FROM = { any_pretender_title = { title = PREVPREV } }
					}
				}			
			}
			modifier = { #would prefer an execution
				factor = 0.2
				FROM = {
					ROOT = { just_execution_reason_PREV_trigger = yes }
				}	
			}		
			modifier = {
				factor = 2
				FROM = { trait = ruthless }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}		
			modifier = {
				factor = 1.5
				FROM = { trait = zealous }
			}
			modifier = {
				factor = 2
				FROM = { trait = cruel }
			}
			modifier = {
				factor = 2
				FROM = { trait = impaler }
			}
			modifier = {
				factor = 0.33
				FROM = { trait = patient }
			}
			modifier = {
				factor = 0.5
				reverse_opinion = { who = FROM value = 20 }
			}
			modifier = {
				factor = 0.5
				reverse_opinion = { who = FROM value = 0 }
			}
			modifier = {
				factor = 2
				NOT = { reverse_opinion = { who = FROM value = -25 } }
			}
			modifier = {
				factor = 2
				NOT = { reverse_opinion = { who = FROM value = -50 } }
			}
		}
	}
	
	vassal_blinding_decision_AGOT = { #So we can alter description
		ai_target_filter = home_court
		filter = home_court
		only_rulers = yes
		
		from_potential = {
			has_dlc = "Legacy of Rome"
			is_ruler = yes
			OR = {
				trait = cruel
				trait = lunatic
				trait = impaler
				culture = moon_clansman
			}
		}
	
		potential = {
			prisoner = yes
			NOT = { trait = blinded }
			NOT = { trait = dragon }
			NOT = { trait = white_walker }
			host = { character = FROM }
			NOT = {
				has_opinion_modifier = {
					who = FROM
					modifier = opinion_kidnapped
				}
			}
			OR = {
				NOT = { has_character_flag = demmanded_trial_by_combat }
				had_character_flag = { flag = demmanded_trial_by_combat days = 365 } 
			}				
		}
		allow = {
			FROM = {
				OR = {
					has_regent = no
					has_dlc = "Zeus"
					regent = { 
						NOT = { opinion = { who = ROOT value = -25 } }
						NOT = { trait = kind }
						NOT = { trait = just }
						NOT = { trait = honorable }
					}
				}
			}
			prisoner = yes
			NOT = { has_character_modifier = getting_justice }
		}
		effect = {
			hidden_tooltip = {
				FROM = {
					character_event = { id = LoR.830 }
				}
			}
			character_event = { id = LoR.831 tooltip = "EVTTOOLTIPLoR.831" }
			tooltip = { 
				add_trait = blinded 
				prisoner = no
			}		
			opinion = {
				modifier = opinion_blinded_me
				who = FROM
			}
			FROM = {
				if = {
					limit = {
						NOR = {
							trait = cruel
							trait = kind
						}
					}
					random = {
						chance = 25
						add_trait = cruel
						hidden_tooltip = { character_event = { id = 38259 } }
					}
				}

				if = {
					limit = { trait = kind }
					random = { 
						chance = 50
						remove_trait = kind
						hidden_tooltip = {
							character_event = { id = 38307 }
						}
					}
					hidden_tooltip = {
						random_list = {
							30 = {
								add_trait = stressed
								hidden_tooltip = { character_event = { id = 38282 } }
							}
							10 = {
								add_trait = depressed
								hidden_tooltip = { character_event = { id = 38288 } }
							}
							60 = {
								#nothing
							}
						}
					}
				}
				if = {
					limit = { NOT = { religion = nath_pagan } }
					piety = -50
				}
				if = {
					limit = { religion = nath_pagan }
					piety = -60
					custom_tooltip = { text = nath_pagan_ahimsa_tooltip }
				}
				hidden_tooltip = { character_event = { id = 45361 days = 1 } }#check for tyranny for going against council
			}
			add_fear_torture_effect = yes
			hidden_tooltip = {
				# if = {
					# limit = { FROM = { NOT = { dynasty = ROOT } } }
					# any_dynasty_member = {
						# opinion = {
							# modifier = opinion_blinded_family
							# who = FROM
						# }
					# }
				# }
				father = { 
					opinion = { who = FROM modifier = opinion_blinded_child } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8310 }
					}
				}
				mother = { 
					opinion = { who = FROM modifier = opinion_blinded_child } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8310 }
					}
				}
				any_dynasty_member = {
					limit = {
						is_close_relative = ROOT
						NOT = { any_child = { character = ROOT } } 
					}
					opinion = { who = FROM modifier = opinion_blinded_kin }
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8310 }
					}
				}
				any_spouse = {
					limit = { opinion = { who = ROOT value = -25 } }
					opinion = { who = FROM modifier = opinion_blinded_spouse }
				}
				any_spouse = {
					limit = { ai = no }
					character_event = { id = LoR.8310 }
				}
				any_lover = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
					}
					opinion = { who = FROM modifier = opinion_tortured_lover } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8310 }
					}
				}
				any_friend = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
						NOT = { is_lover = ROOT }
					}
					opinion = { who = FROM modifier = opinion_tortured_friend } 
					if = {
						limit = { ai = no }
						character_event = { id = LoR.8310 }
					}
				}
				liege = {
					if = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = LoR.8310 }
					}	
				}
				if = {
					limit = { is_ruler = yes }
					any_realm_lord = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = LoR.8310 }
					}
				}	
				FROM = {
					save_event_target_as = remove_prison_reason_effect_accuser
					ROOT = { save_event_target_as = remove_prison_reason_effect_accused }
					hidden_tooltip = { remove_prison_reason_effect = yes }
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.01 # Less likely to do it
			}
			modifier = {
				factor = 0
				religion = nath_pagan
				NOT = { trait = cynical }
			}
			modifier = {
				factor = 0
				reverse_opinion = { who = FROM value = 20 }
				FROM = { NOT = { trait = lunatic } }
			}
			modifier = {
				factor = 0
				FROM = { 
					OR = {
						trait = kind 
						trait = just
						trait = honorable 
					}	
				}
			}	
			modifier = { #trying to inspire fear
				factor = 2
				FROM = {
					OR = {
						trait = ruthless
						trait = cruel
					}
					OR = {
						is_close_relative = ROOT
						is_vassal_or_below = ROOT
						ROOT = { liege = { liege_before_war = { character = ROOT_FROM } } }
					}
				}
			}
			modifier = {
				factor = 0.1
				OR = {
					is_lover = FROM
					is_consort = FROM
					is_married = FROM
				}	
			}			
			modifier = {
				factor = 0.1 #Enemy has your relative
				FROM = {
					any_current_enemy = {
						dynasty = ROOT
						is_close_relative = ROOT
						any_courtier = {
							is_close_relative = FROM
							dynasty = FROM
						}
					}
				}
			}
			modifier = {
				factor = 0 #Is your enemy and can enforce a victory
				FROM = {
					any_current_enemy = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 4
				any_claim = { holder_scope = { character = FROM } }
				NOT = { is_child_of = FROM }
			}
			modifier = {
				factor = 2
				is_pretender = yes
				FROM = {
					OR = {
						is_pretender = yes
						is_primary_heir = yes
					}
				}
				any_pretender_title = {
					OR = {
						current_heir = { character = FROM }
						FROM = { any_pretender_title = { title = PREVPREV } }
					}
				}			
			}
			modifier = { #would prefer an execution
				factor = 0.2
				FROM = {
					ROOT = { just_execution_reason_PREV_trigger = yes }
				}	
			}		
			modifier = {
				factor = 2
				FROM = { trait = ruthless }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}		
			modifier = {
				factor = 1.5
				FROM = { trait = zealous }
			}
			modifier = {
				factor = 2
				FROM = { trait = cruel }
			}
			modifier = {
				factor = 2
				FROM = { trait = impaler }
			}
			modifier = {
				factor = 0.33
				FROM = { trait = patient }
			}
			modifier = {
				factor = 0.5
				reverse_opinion = { who = FROM value = 20 }
			}
			modifier = {
				factor = 0.5
				reverse_opinion = { who = FROM value = 0 }
			}
			modifier = {
				factor = 2
				NOT = { reverse_opinion = { who = FROM value = -25 } }
			}
			modifier = {
				factor = 2
				NOT = { reverse_opinion = { who = FROM value = -50 } }
			}
		}
	}
	
	banish_prisoner = {
		ai_target_filter = home_court	
		filter = home_court
		is_high_prio = yes
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes
			nightswatch_culture_trigger = yes
		}
	
		potential = {
			prisoner = yes
			host = { character = FROM }
			OR = {
				is_liege_or_above = FROM
				AND = {
					FROM = { has_landed_title = k_the_most_devout }
					crownlaw_title = { 
						OR = {
							has_law = investiture_law_2
							has_law = investiture_law_3
						}
					}	
				}
			}	
			is_female = no
			age = 15
			NOT = { trait = nightswatch }
			NOT = { trait = incapable }
			NOT = { trait = dragon }
			NOT = { trait = white_walker }
			OR = {
				AND = {
					FROM = { has_landed_title = k_the_most_devout }
					OR = {
						trait = kinslayer
						trait = excommunicated
					}
				}
				FROM = { ROOT = { just_execution_reason_PREV_trigger = yes } }
			}	
			OR = {
				NOT = { has_character_flag = demmanded_trial_by_combat }
				had_character_flag = { flag = demmanded_trial_by_combat days = 365 } 
			}	
		}
		allow = {
			FROM = {
				OR = {
					has_regent = no
					has_dlc = "Zeus"
					regent = { 
						OR = {
							trait = just
							NOT = { opinion = { who = ROOT value = 25 } }
						}	
					}
				}
			}
			prisoner = yes
			NOT = { trait = deserter }
			FROM = { wealth = 20 }
			d_nightswatch = { holder_scope = { demesne_size = 1 } }
		}
		effect = {
			FROM = {
				wealth = -15
				piety = 20
				hidden_tooltip = { character_event = { id = 45361 days = 1 } }#check for tyranny for going against council
			}
			custom_tooltip = { 
				text = TOOLTIPBANISHTONW 
				hidden_tooltip = { character_event = { id = nightswatch.20 } }
			}		
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.05 # Less likely to do it
			}
			modifier = { #Dont banish if like prisoner...
				factor = 0
				reverse_opinion = { who = FROM value = 20 }
				FROM = { #...except if are just, ruthless, wroth or lunatic
					NOR = {
						trait = just
						trait = ruthless
						trait = wroth
						trait = lunatic
					}
				}
			}
			modifier = {
				factor = 4
				any_claim = { holder_scope = { character = FROM } }
				NOT = { is_child_of = FROM }
			}
			modifier = {
				factor = 2
				is_pretender = yes
				FROM = {
					OR = {
						is_pretender = yes
						is_primary_heir = yes
					}
				}
				any_pretender_title = {
					OR = {
						current_heir = { character = FROM }
						FROM = { any_pretender_title = { title = PREVPREV } }
					}
				}			
			}
			modifier = {
				factor = 0.1
				OR = {
					is_lover = FROM
					is_consort = FROM
					is_married = FROM
				}	
			}
			modifier = {
				factor = 0.05 #Enemy has your relative
				FROM = {
					any_current_enemy = {
						dynasty = ROOT
						is_close_relative = ROOT
						any_courtier = {
							is_close_relative = FROM
							dynasty = FROM
						}
					}
				}
			}
			modifier = {
				factor = 0 #Is your enemy and can enforce a victory
				any_current_enemy = {
					character = FROM
				}
			}						
			modifier = {
				factor = 0.5
				FROM = { trait = cruel }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = impaler }
			}
			modifier = {
				factor = 2
				FROM = { trait = honorable }
			}
			modifier = {
				factor = 3
				FROM = { trait = patient }
			}
			modifier = {
				factor = 2
				FROM = { trait = kind }
			}
		}
	}
	
	make_salt_wife = { #Now generic make concubine
		ai_target_filter = home_court
		filter = home_court
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes				
			is_female = no
			#NOT = { same_realm = ROOT }
			OR = {
				has_dlc = "The Old Gods"
				ai = yes
			}
		}
	
		potential = {
			prisoner = yes
			host = { character = FROM }
			NOT = { is_liege_or_above = FROM }
			NOT = { religion = FROM }
			is_female = yes
			age = 15
			NOT = { trait = incapable }
			NOT = { trait = dragon }
			NOT = { culture_group = winter_group }	
			NOT = { culture_group = unoccupied_group }
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_set_aside } }
		}
		allow = {
			FROM = {
				below_consort_limit_trigger = yes
				prisoner = no
				NOT = { trait = incapable }
				OR = {
					religion = drowned_god
					religion = corsair
					government = pirate_government
					religion_group = pirate_group
					religion = mountain_old_gods
					is_nomadic = yes
				}
			}
			prisoner = yes
		}
		effect = {
			hidden_tooltip = {
				character_event = { id = 660 }
				spouse = {
					character_event = { id = 662 }
					opinion = {
						who = ROOT
						modifier = opinion_my_abducted_spouse
						years = 100
					}
				}
				any_child = {
					character_event = { id = 661 }
				}
				any_sibling = {
					character_event = { id = 661 }
				}
				father = {
					character_event = { id = 661 }
				}
				mother = {
					character_event = { id = 661 }
				}
				any_consort = {
					remove_consort = ROOT
				}
			}
			if = {
				limit = { trait = slave }
				liege = {
					opinion = {
						who = FROM
						modifier = opinion_stole_slave
					}
				}
				if = {
					limit = {
						FROM = {
							crownlaw_title = { NOT = { has_law = slavery_0 } }
						}
					}
					hidden_tooltip = {
						liege = {
							remove_opinion = { who = ROOT modifier = opinion_my_slave }
							reverse_remove_opinion = { who = ROOT modifier = opinion_my_owner }
						}
						opinion = { who = FROM modifier = opinion_my_owner }
						reverse_opinion = { who = FROM modifier = opinion_my_slave }
					}
				}
				if = {
					limit = {
						FROM = {
							crownlaw_title = { has_law = slavery_0 }
						}
					}
					tooltip = { remove_trait = slave }
					hidden_tooltip = { character_event = { id = slavery.0 } }
				}			
			}
			if = {
				limit = { is_ruler = yes }
				hidden_tooltip = { #Universal on death/abdication event
					if = {
						limit = { has_character_modifier = owns_valyrian_steel_sword }
						set_character_flag = do_not_inherit_sword
					}
					set_character_flag = abdication
					character_event = { id = 45341 } 
					clr_character_flag = abdication
					clr_character_flag = do_not_inherit_sword
					if = {
						limit = { is_merchant_republic = no }
						transfer_wealth_to_heir_effect = yes
					}
				}
				abdicate = yes
			}
			add_consort = FROM
			if = {
				limit = { FROM = { religion = drowned_god } }
				add_trait = salt_wife
			}	
			clr_character_flag = captured_in_battle
			opinion = {
				who = FROM
				modifier = opinion_forced_consort
			}
			
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.01 # Less likely to do it
			}
			modifier = {
				factor = 0
				reverse_opinion = { who = FROM value = 20 }
				FROM = { #...except if are cruel, ruthless, lunatic
					NOR = {
						trait = cruel
						trait = ruthless
						trait = lunatic
					}
				}
			}
			modifier = {
				factor = 0 #Is your enemy and can enforce a victory
				any_current_enemy = {
					character = FROM
				}
			}
			modifier = {
				factor = 0.1
				FROM = { 
					OR = {
						trait = kind 
						trait = just
						trait = honorable 
					}	
				}
			}	
			modifier = {
				factor = 2
				FROM = { trait = ruthless }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}		
			modifier = {
				factor = 2
				FROM = { trait = cruel }
			}
			
			modifier = {
				factor = 0
				age = 40
			}
			modifier = {
				factor = 0
				trait = ugly
			}
			modifier = {
				factor = 3
				trait = fair
			}
			modifier = {
				factor = 1.5
				prestige = 200
			}
			modifier = {
				factor = 1.5
				prestige = 400
			}
			modifier = {
				factor = 1.5
				prestige = 500
			}	
			modifier = {
				factor = 0.2
				FROM = { num_of_consorts = 1 }
			}
		}
	}
	take_prisoner_as_wife = {
		ai_target_filter = home_court
		filter = home_court
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes
			is_married = no
			age = 14					
			can_marry_trigger = yes
		}
		potential = {
			prisoner = yes
			host = { character = FROM }
			#can_marry = FROM
			NAND = {
				is_betrothed = yes
				betrothed = { character = FROM }
			}
			NOT = { is_married = FROM }
			NOT = { same_sex = FROM }		
			NOT = { trait = dragon }
			NOT = { culture_group = winter_group }	
			NOT = { culture_group = unoccupied_group }		
			NOT = { trait = giant }						
		}
		allow = {
			FROM = {
				is_married = no
				age = 14
				NOT = { trait = celibate }
				NOT = { trait = kind }
				NOT = { trait = honorable }
				NOT = { trait = incapable }
				prisoner = no
			}
			prisoner = yes
			age = 8
			OR = {
				can_marry_trigger = yes
				trait = slave
				is_betrothed = yes
				is_married = yes
				is_consort = yes				
			}						
			OR = {
				is_female = yes
				trait = craven
				is_weak_trigger = yes
				trait = content
				trait = incapable
				trait = inbred
				trait = imbecile
				AND = {
					FROM = {
						OR = {
							is_strong_trigger = yes
							trait = tall
							trait = skilled_warrior
							trait = master_warrior
						}
					}	
					NOR = {
						is_strong_trigger = yes
						trait = tall
						trait = skilled_warrior
						trait = master_warrior
					}
				}
			}
			NOT = { demanded_trial_by_combat_trigger = yes }
			NOT = { has_character_modifier = getting_justice }
		}
		effect = {
			if = {
				limit = { trait = slave }
				tooltip = { remove_trait = slave }
				liege = {
					opinion = {
						who = FROM
						modifier = opinion_stole_slave
					}
					if = {
						limit = { ai = no }
						hidden_tooltip = { character_event = { id = 50063 } }
					}
				}
				hidden_tooltip = { character_event = { id = slavery.0 } }
			}
			if = {
				limit = { is_consort = yes }
				consort = {
					opinion = {
						who = FROM
						modifier = opinion_vengeance
					}
					remove_consort = ROOT
					if = {
						limit = { ai = no }
						hidden_tooltip = { character_event = { id = 50063 } }
					}
				}
			}
			if = {
				limit = { is_betrothed = yes }
				betrothed = {
					opinion = {
						who = FROM
						modifier = opinion_vengeance
					}	
					if = {
						limit = { ai = no }
						hidden_tooltip = { character_event = { id = 50063 } }
					}
					liege = {
						if = {
							limit = {
								dynasty = PREV
								NOT = { character = PREV }
								NOT = { character = ROOT }
								NOT = { character = FROM }
							}
							opinion = {
								who = FROM
								modifier = opinion_vengeance
							}	
							if = {
								limit = { ai = no }
								hidden_tooltip = { character_event = { id = 50063 } }
							}
						}
					}				
				}
			}	
			if = {
				limit = { is_married = yes }
				any_spouse = {
					opinion = {
						who = FROM
						modifier = opinion_vengeance
					}
					remove_spouse = ROOT
					if = {
						limit = { ai = no }
						hidden_tooltip = { character_event = { id = 50063 } }
					}
				}
				FROM = {
					change_variable = { which = "dishonorable" value = 10 } 
					hidden_tooltip = { character_event = { id = maintenance.3 } }#dishonour trait
				}
			}
			set_character_flag = no_wedding_event
			FROM = { set_character_flag = no_wedding_event }
			if = {
				limit = { FROM = { is_female = no } }
				add_spouse = FROM
			}
			if = {
				limit = { FROM = { is_female = yes } }
				add_spouse_matrilineal = FROM
			}
			clr_character_flag = no_wedding_event
			FROM = { clr_character_flag = no_wedding_event }
			opinion = {
				who = FROM
				modifier = opinion_forced_marriage
			}
			if = {
				limit = { is_ruler = no }
				prisoner = no
				move_character = FROM
			}
			if = {
				limit = { is_ruler = yes }
				hidden_tooltip = {
					remove_character_modifier = house_arrest
					remove_character_modifier = the_oubliette
					remove_character_modifier = the_dungeon
				}
				add_character_modifier = { 
					name = house_arrest
					duration = -1
				}
			}
			FROM = {
				if = {
					limit = {
						NOR = {
							trait = cruel
							trait = kind
						}
						NOT = { personality_traits = 6 }
					}
					random = {
						chance = 10
						add_trait = cruel
						hidden_tooltip = { character_event = { id = 38259 } }
					}
				}

				if = {
					limit = { trait = kind }
					random = { 
						chance = 25
						remove_trait = kind
						hidden_tooltip = {
							character_event = { id = 38307 }
						}
					}
					hidden_tooltip = {
						random_list = {
							20 = {
								add_trait = stressed
								hidden_tooltip = { character_event = { id = 38282 } }
							}
							5 = {
								add_trait = depressed
								hidden_tooltip = { character_event = { id = 38288 } }
							}
							75 = {
								#nothing
							}
						}
					}
				}
				piety = -50
				hidden_tooltip = { add_character_modifier = { name = "wedding" duration = 60 } }
				hidden_tooltip = { character_event = { id = 45361 days = 1 } }#check for tyranny for going against council
			}
			hidden_tooltip = {
				child_fertility_debuff = yes
				add_character_modifier = { name = "wedding" duration = 60 }
				character_event = { id = 50062 }
				father = { 
					opinion = { who = FROM modifier = opinion_forced_marriage_child } 
					if = {
						limit = { ai = no }
						character_event = { id = 50063 }
					}
				}
				mother = { 
					opinion = { who = FROM modifier = opinion_forced_marriage_child } 
					if = {
						limit = { ai = no }
						character_event = { id = 50063 }
					}
				}
				any_dynasty_member = {
					limit = {
						is_close_relative = ROOT
						NOT = { any_child = { character = ROOT } } 
					}
					opinion = { who = FROM modifier = opinion_forced_marriage_kin }
					if = {
						limit = { ai = no }
						character_event = { id = 50063 }
					}
				}
				any_lover = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
					}
					opinion = { who = FROM modifier = opinion_forced_marriage_lover } 
					if = {
						limit = { ai = no }
						character_event = { id = 50063 }
					}
				}
				any_friend = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
						NOT = { is_lover = ROOT }
					}
					opinion = { who = FROM modifier = opinion_forced_marriage_friend } 
					if = {
						limit = { ai = no }
						character_event = { id = 50063 }
					}
				}			
				liege = {
					if = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = 50063 }
					}	
				}
				if = {
					limit = { is_ruler = yes }
					any_realm_lord = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = 50063 }
					}
				}	
				FROM = {
					save_event_target_as = remove_prison_reason_effect_accuser
					ROOT = { save_event_target_as = remove_prison_reason_effect_accused }
					hidden_tooltip = { remove_prison_reason_effect = yes }
				}
			}
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.01 # Less likely to do it
			}
			modifier = {
				factor = 0
				reverse_opinion = { who = FROM value = 20 }
				FROM = { #...except if are cruel, ruthless, lunatic
					NOR = {
						trait = cruel
						trait = ruthless
						trait = lunatic
					}
				}
			}
			modifier = { #AI motives
				factor = 0
				NOT = { 
					OR = {
						#Target has a title or claim that is equal or higher to FROM's rank
						NOT = { lower_tier_than = FROM }
						any_heir_title = { NOT = { lower_tier_than = FROM } }
						any_claim = { NOT = { lower_tier_than = FROM } }
						AND = { #Horny bastard
							trait = fair
							FROM = { trait = lustful }
						}
					}
				}
			}
			modifier = {
				factor = 0
				age = 35
			}
			modifier = {
				factor = 0 #Is your enemy and can enforce a victory
				any_current_enemy = {
					character = FROM
				}
			}
			modifier = {
				factor = 0.1
				FROM = { 
					OR = {
						trait = kind 
						trait = honorable 
					}	
				}
			}	
			modifier = {
				factor = 0
				FROM = { trait = just }
			}
			modifier = {
				factor = 2
				FROM = { trait = ruthless }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}		
			modifier = {
				factor = 2
				FROM = { trait = cruel }
			}
			modifier = {
				factor = 0.5
				trait = ugly
			}
			modifier = {
				factor = 3
				trait = fair
			}
			modifier = {
				factor = 0.25
				is_married = yes
			}
			modifier = {
				factor = 0
				is_married = yes
				FROM = { trait = zealous }
			}
		}
	}
	torture_prisoner = {
		ai_target_filter = home_court
		filter = home_court
		only_playable = yes
		
		from_potential = {
			NOT = { has_dlc = "Reapers" }
			is_ruler = yes
			OR = {
				trait = cruel
				trait = lunatic
				trait = impaler
			}
			is_adult = yes
			prisoner = no
			NOT = { trait = incapable }
		}
	
		potential = {
			prisoner = yes
			host = { character = FROM }
			NOT = { trait = dragon }
			NOT = { culture_group = winter_group }	
			NOT = { culture_group = unoccupied_group }
			OR = {
				NOT = { has_character_flag = tortured }
				had_character_flag = { flag = tortured days = 365 }
			}	
			age = 14
		}
		allow = {
			FROM = {
				OR = {
					has_regent = no
					has_dlc = "Zeus"
					regent = { 
						NOT = { opinion = { who = ROOT value = -25 } }
						NOT = { trait = kind }
						NOT = { trait = just }
						NOT = { trait = honorable }
					}
				}
			}
			prisoner = yes
		}
		effect = {
			hidden_tooltip = {
				clr_character_flag = torture_confession
				if = {
					limit = {
						NOT = { reverse_has_opinion_modifier = { who = FROM modifier = opinion_confessed } }
						OR = {
							trait = kinslayer
							AND = {
								OR = {
									trait = excommunicated
									NOT = { piety = -150 }
								}
								FROM = {
									OR = {
										is_theocracy = yes
										trait = zealous
									}
									NOR = {
										religion = moonsingers
										religion = valyrian
										religion = nath_pagan
										religion = pirate
										religion = corsair
									}							
								}						
							}
							reverse_has_opinion_modifier = { who = FROM modifier = scheming_bastard }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_corrupt }
							reverse_has_opinion_modifier = { who = FROM modifier = suspect_of_murder }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_blackmailed }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_unfaithful_wife }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_unfaithful_husband }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_charge_infidel }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_charge_deviant }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_charge_slanderer }
							reverse_has_opinion_modifier = { who = FROM modifier = abuse_of_office }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_attempted_kidnapped }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_disinherited_me }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_conspired_against_me }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_conspired_against_child }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_ignored_my_judgement }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_cuckolded_AGOT }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_murderer }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_prison_break }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_attempted_prison_break }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_slaver }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_upon_me }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_upon_kin }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_upon_lover }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_upon_friend }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_upon_spouse }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_aborted_my_child }
							reverse_has_opinion_modifier = { who = FROM modifier = declared_me_insane }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_marriage }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_marriage_child }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_marriage_kin }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_forced_marriage_lover }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_assaulted_me }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_peasant_hunting }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_executed_realm_character }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_refused_prisoner_transfer }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_unfaithful_consort }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_slept_with_my_consort }
							reverse_has_opinion_modifier = { who = FROM modifier = devious_plotter }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_warden_no_defend }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_illegal_slave_trader }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_enslaved_close_relative }
							reverse_has_opinion_modifier = { who = FROM modifier = opinion_enslaved_me }
						}
					}
					set_character_flag = torture_confession
					FROM = { set_character_flag = torture_confession }
				}
				FROM = {
					character_event = { id = 50051 tooltip = "TOOLTIPTORTURE" }
				}
			}
			character_event = { id = 50052 tooltip = "TOOLTIPTORTURE" }		
			tooltip = {
				random_list = {
					25 = { 
						add_character_modifier = { 
							name = tortured
							duration = 30
						}
					}
					25 = { 
						if = {
							limit = { 
								NOT = { is_maimed_trigger = yes }
								NOT = { trait = wounded } 
							}
							add_trait = wounded 
						}	
					}
					25 = { 
						if = {
							limit = { NOT = { is_maimed_trigger = yes } }
							add_maimed_trait_effect = yes 
						}	
					}								
					10 = { 
						if = {
							limit = { NOT = { is_crippled_trigger = yes } }
							add_crippled_trait_effect = yes 
						}	
					}
					5 = { 
						if = {
							limit = { NOT = { trait = incapable } }
							add_trait = incapable 
						}	
					}
					10 = { 
						death = yes
					}				
				}
				random_list = {
					15 = {
						if = {
							limit = { 
								NOT = { trait = brave }
								NOT = { trait = craven }
								NOT = { trait = berserker }
							}
							add_trait = craven
						}
						if = {
							limit = { trait = brave }
							remove_trait = brave
						}				
					}
					15 = { 
						if = {
							limit = { NOT = { trait = stressed } }
							add_trait = stressed 
						}	
					}
					15 = { 
						if = {
							limit = { NOT = { trait = depressed } }
							add_trait = depressed 
						}	
					}
					5 = { 
						if = {
							limit = { NOT = { trait = lunatic } }
							add_trait = lunatic 
						}	
					}
					50 = { }
				}
			}	
			set_character_flag = tortured
			add_fear_torture_effect = yes
			hidden_tooltip = {
				opinion = {
					who = FROM
					modifier = opinion_tortured_me
				}
				father = { 
					opinion = { who = FROM modifier = opinion_tortured_kin } 
					if = {
						limit = { ai = no }
						character_event = { id = 50053 }
					}
				}
				mother = { 
					opinion = { who = FROM modifier = opinion_tortured_kin } 
					if = {
						limit = { ai = no }
						character_event = { id = 50053 }
					}
				}
				any_dynasty_member = {
					limit = {
						is_close_relative = ROOT
						NOT = { any_child = { character = ROOT } } 
					}
					opinion = { who = FROM modifier = opinion_tortured_kin }
					if = {
						limit = { ai = no }
						character_event = { id = 50053 }
					}
				}
				any_spouse = {
					limit = { opinion = { who = ROOT value = -25 } }
					opinion = { who = FROM modifier = opinion_tortured_kin }
				}
				any_spouse = {
					limit = { ai = no }
					character_event = { id = 50053 }
				}
				any_lover = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
					}
					opinion = { who = FROM modifier = opinion_tortured_lover } 
					if = {
						limit = { ai = no }
						character_event = { id = 50053 }
					}
				}
				any_friend = { 
					limit = { 
						NOT = { any_child = { character = ROOT } } 
						NAND = {
							dynasty = ROOT
							is_close_relative = ROOT
						}
						NOT = { is_married = ROOT }
						NOT = { is_lover = ROOT }
					}
					opinion = { who = FROM modifier = opinion_tortured_friend } 
					if = {
						limit = { ai = no }
						character_event = { id = 50053 }
					}
				}
				
				liege = {
					if = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = 50053 }
					}	
				}
				if = {
					limit = { is_ruler = yes }
					any_realm_lord = {
						limit = { 
							ai = no 
							NOT = { any_child = { character = ROOT } } 
							NAND = {
								dynasty = ROOT
								is_close_relative = ROOT
							}
							NOT = { is_married = ROOT }
							NOT = { is_lover = ROOT }
							NOT = { is_friend = ROOT }
						}
						character_event = { id = 50053 }
					}
				}	
			}
			FROM = {
				if = {
					limit = {
						NOR = {
							trait = cruel
							trait = kind
						}
					}
					random = {
						chance = 25
						add_trait = cruel
						hidden_tooltip = { character_event = { id = 38259 } }
					}
				}

				if = {
					limit = { trait = kind }
					random = { 
						chance = 50
						remove_trait = kind
						hidden_tooltip = {
							character_event = { id = 38307 }
						}
					}
					hidden_tooltip = {
						random_list = {
							30 = {
								add_trait = stressed
								hidden_tooltip = { character_event = { id = 38282 } }
							}
							10 = {
								add_trait = depressed
								hidden_tooltip = { character_event = { id = 38288 } }
							}
							60 = {
								#nothing
							}
						}
					}
				}
				if = {
					limit = { NOT = { religion = nath_pagan } }
					piety = -30
				}
				if = {
					limit = { religion = nath_pagan }
					piety = -60
					custom_tooltip = { text = nath_pagan_ahimsa_tooltip }
				}
				hidden_tooltip = { character_event = { id = 45361 days = 1 } }#check for tyranny for going against council
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.01 # Less likely to do it
			}
			modifier = {
				factor = 0
				religion = nath_pagan
				NOT = { trait = cynical }
			}
			modifier = {
				factor = 0
				reverse_opinion = { who = FROM value = 20 }
				FROM = { NOT = { trait = lunatic } }
			}
			modifier = {
				factor = 0
				FROM = { 
					OR = {
						trait = kind 
						trait = just
						trait = honorable 
					}	
				}
			}
			modifier = { #trying to inspire fear
				factor = 2
				FROM = {
					OR = {
						trait = ruthless
						trait = cruel
					}
					OR = {
						is_close_relative = ROOT
						is_vassal_or_below = ROOT
						ROOT = { liege = { liege_before_war = { character = ROOT_FROM } } }
					}
				}
			}
			modifier = {
				factor = 0.1
				OR = {
					is_lover = FROM
					is_consort = FROM
					is_married = FROM
				}	
			}
			modifier = {
				factor = 0.1 #Enemy has your relative
				FROM = {
					any_current_enemy = {
						dynasty = ROOT
						is_close_relative = ROOT
						any_courtier = {
							is_close_relative = FROM
							dynasty = FROM
						}
					}
				}
			}
			modifier = {
				factor = 0 #Is your enemy and can enforce a victory
				FROM = {
					any_current_enemy = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 2
				FROM = { trait = ruthless }
			}
			modifier = {
				factor = 1.5
				FROM = { trait = wroth }
			}		
			modifier = {
				factor = 1.5
				FROM = { trait = zealous }
			}
			modifier = {
				factor = 2
				FROM = { trait = cruel }
			}
			modifier = {
				factor = 2
				FROM = { trait = impaler }
			}
			modifier = {
				factor = 0.33
				FROM = { trait = patient }
			}
			modifier = {
				factor = 0.5
				reverse_opinion = { who = FROM value = 20 }
			}
			modifier = {
				factor = 0.5
				reverse_opinion = { who = FROM value = 0 }
			}
			modifier = {
				factor = 2
				NOT = { reverse_opinion = { who = FROM value = -25 } }
			}
			modifier = {
				factor = 2
				NOT = { reverse_opinion = { who = FROM value = -50 } }
			}
		}
	}
	
	adopt_character = {
		ai_target_filter = home_court
		filter = sub_realm
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes
			is_female = no		
			OR = {
				culture = kayakayanayan
				culture = samyrianan
				culture = bayasabhadi
			}
			is_theocracy = no
			NOT = { trait = eunuch }
			OR = {
				ai = no
				is_strong_trigger = yes
				trait = tall
				trait = fair
			}
		}
		potential = {		
			is_female = no
			NOT = { trait = dragon }
			is_liege_or_above = FROM
			NOT = { is_married = FROM }
			NOT = { is_consort = FROM }
			NOT = { is_close_relative = FROM }
		}
		allow = {
			FROM = { age = 30 }
			FROM = {
				OR = {
					has_regent = no
					regent = { opinion = { who = ROOT value = 0 } }
				}
			}
			age = 16
			OR = {
				culture = kayakayanayan
				culture = samyrianan
				culture = bayasabhadi
			}		
			OR = {
				is_strong_trigger = yes
				trait = tall
				trait = fair
			}
			custom_tooltip = {
				text = TOOLTIPADOPTIONLOWBORN
				hidden_tooltip = { dynasty = 0 }
			}	
			NOT = { any_spouse = { is_close_relative = FROM } }
			FROM = { is_older_than = ROOT }
			opinion = { who = FROM value = 0 }
			prisoner = no
			NOT = { trait = slave }
			NOT = { has_severe_disability_trigger = yes }
			NOT = { trait = dwarf }
			NOT = { is_weak_trigger = yes }
			NOT = { trait = imbecile }
			NOT = { is_dumb_trigger = yes }		
			NOT = { trait = ugly }					
			NOT = { trait = clubfooted }
			NOT = { trait = hunchback }
		}
		effect = {
			hidden_tooltip = {
				father = { ROOT = { set_real_father = PREV } }
				set_mother = 0
			}
			set_father = FROM
			dynasty = FROM
			add_trait = adopted
			hidden_tooltip = {
				any_child = {
					limit = { dynasty = 0 }
					dynasty = ROOT
					any_child = {
						limit = { dynasty = 0 }
						dynasty = ROOT
						any_child = {
							limit = { dynasty = 0 }
							dynasty = ROOT
						}
					}
				}
			}
			if = {
				limit = { FROM = { tier = EMPEROR } }
				prestige = 200
			}
			if = {
				limit = { FROM = { tier = KING } }
				prestige = 100
			}
			if = {
				limit = { FROM = { tier = DUKE } }
				prestige = 50
			}
			if = {
				limit = { FROM = { tier = COUNT } }
				prestige = 25
			}
			if = {
				limit = { FROM = { tier = BARON } }
				prestige = 10
			}
			opinion = { who = FROM modifier = opinion_adopted_me }
			FROM = {
				any_child = {
					limit = {
						is_female = no
						is_alive = yes
						NOT = { character = ROOT }
						NOT = { trait = eunuch }
						NOT = { trait = bastard }
						age = 15
					}
					opinion = { who = PREV modifier = opinion_adopted_a_son }
				}
				any_spouse = {
					limit = { 
						is_alive = yes 
						NOT = { any_child = { character = ROOT } }
					}
					opinion = { who = PREV modifier = opinion_adopted_a_son }
				}
				recalc_succession = yes
			}
			event_target:chronicle_player = {
				if = {
					limit = { 
						OR = {	
							character = FROM
							AND = {
								is_liege_or_above = FROM
								ROOT = { is_primary_heir = yes }
							}	
						}
					}
					chronicle = {
						entry = CHRONICLE_ADOPTED_CHARACTER
						portrait = [Root.GetID]
					}	
				}
			}
		}
		ai_will_do = {
			factor = 0.25
			
			modifier = {
				factor = 0
				OR = {
					NOT = { reverse_opinion = { who = FROM value = 0 } }
					trait = celibate
					is_ill = yes
					has_severe_disability_trigger = yes
					spouse = { is_married_matrilineally = yes }
				}	
			}
			modifier = {
				factor = 0
				FROM = {
					any_child = {
						is_alive = yes
						age = 15
						is_female = no
						OR = {
							trait = strong
							trait = tall
							trait = fair
						}
						NOT = { trait = eunuch }
						NOT = { has_severe_disability_trigger = yes }
						NOT = { trait = maester }
						NOT = { trait = archmaester }
						NOT = { trait = nightswatch }
						NOT = { trait = kingsguard }
						NOT = { trait = bastard }
						NOT = { trait = septon }
						NOT = { trait = drowned }
						NOT = { trait = red_priest }
						NOT = { trait = disinherited }
					}
				}	
			}
		}
	}
	
	make_noble = {
		ai_target_filter = home_court
		filter = home_court
		only_playable = yes
		
		from_potential = {
			ai = no 
			NOT = { culture = dothraki}
			NOT = { trait = wildling }
			NOT = { culture = jogos_nhai }
			NOT = { culture = moon_clansman }
		}
		potential = {				
			NOT = { trait = dragon }
			NOT = { trait = white_walker }
			dynasty = 0
			is_ruler = no
			liege = { character = FROM }
		}
		allow = {
			FROM = { 
				custom_tooltip = {
					text = TOOLTIPMINORDECISIONALLOWWEALTH
					hidden_tooltip = {
						OR = {
							AND = {
								tier = COUNT
								treasury = 20
							}
							AND = {
								tier = DUKE
								treasury = 40
							}
							AND = {
								higher_tier_than = DUKE
								treasury = 80
							}
						}
					}
				}
			}
			FROM = {
				OR = {
					has_regent = no
					regent = { opinion = { who = ROOT value = 0 } }
				}
			}
			prisoner = no
			is_female = no
			is_theocracy = no	
			NOT = { trait = slave }
			NOT = { trait = maester }
			NOT = { trait = archmaester }
			NOT = { trait = kingsguard }
			NOT = { trait = nightswatch }
			NOT = { trait = drowned }
			NOT = { trait = septon }
			NOT = { trait = red_priest }
		}
		effect = {
			FROM = {
				if = {
					limit = { higher_tier_than = DUKE }
					wealth = -80
					ROOT = {
						wealth = 80
						prestige = 80
					}
				}
				if = {
					limit = { tier = DUKE }
					wealth = -40
					ROOT = {
						wealth = 40
						prestige = 40
					}
				}
				if = {
					limit = { tier = COUNT }
					wealth = -20
					ROOT = {
						wealth = 20
						prestige = 20
					}
				}
				hidden_tooltip = { character_event = { id = 45361 days = 1 } }#check for tyranny for going against council
			}
			custom_tooltip = {
				text = TOOLTIPmake_noble
				hidden_tooltip = {
					if = {
						limit = { has_job_title = job_castellan }
						set_character_flag = job_castellan
					}
					if = {
						limit = { has_job_title = job_chancellor }
						set_character_flag = job_chancellor
					}
					if = {
						limit = { has_job_title = job_marshal }
						set_character_flag = job_marshal
					}
					if = {
						limit = { has_job_title = job_treasurer }
						set_character_flag = job_treasurer
					}
					if = {
						limit = { has_job_title = job_spymaster }
						set_character_flag = job_spymaster
					}
					if = {
						limit = { has_job_title = job_spiritual }
						set_character_flag = job_spiritual
					}
					if = {
						limit = { has_job_title = job_priest }
						set_character_flag = job_priest
					}
					if = {
						limit = { has_minor_title = title_high_admiral }
						set_character_flag = title_high_admiral
					}
					if = {
						limit = { has_minor_title = title_high_admiral_B }
						set_character_flag = title_high_admiral_B
					}
					if = {
						limit = { has_minor_title = title_small_council_advisor }
						set_character_flag = title_small_council_advisor
					}
					if = {
						limit = { has_minor_title = title_councilmember_king }
						set_character_flag = title_councilmember_king
					}
					if = {
						limit = { has_minor_title = title_councilmember_emperor }
						set_character_flag = title_councilmember_emperor
					}
					if = {
						limit = { has_minor_title = title_regent }
						set_character_flag = title_regent
					}
					random_character = { #this so they get an interesting name, rather than 'of <place name>'
						limit = { 
							government = feudal_government
							tier = BARON 
							is_patrician = no
							is_theocracy = no
							is_republic = no
							NOT = { demesne_size = 2 }
							NOT = { dynasty = 0 }
							NOT = { is_close_relative = ROOT }
						}
						abdicate_to = ROOT
						ROOT = {
							any_courtier = {
								limit = { is_close_relative = PREV is_ruler = no }
								move_character = FROM	
							}
							abdicate_to = PREV 
							move_character = FROM
						}
						primary_title = { remove_claim = ROOT }
					}
					if = { #If you have no baronies to use, failsafe
						limit = { dynasty = 0	 }
						dynasty = father_bastard
					}
					any_child = {
						limit = { dynasty = 0 }
						dynasty = ROOT
						any_child = {
							limit = { dynasty = 0 }
							dynasty = ROOT
							any_child = {
								limit = { dynasty = 0 }
								dynasty = ROOT
							}
						}
					}
					any_sibling = {
						limit = {
							dynasty = 0
							father_even_if_dead = {
								dynasty = 0
								any_child = { character = ROOT }
							}
						}
						dynasty = ROOT
						father_even_if_dead = { dynasty = ROOT }
						any_child = {
							limit = { dynasty = 0 }
							dynasty = ROOT
							any_child = {
								limit = { dynasty = 0 }
								dynasty = ROOT
								any_child = {
									limit = { dynasty = 0 }
									dynasty = ROOT
								}
							}
						}
					}
					if = {
						limit = { has_character_flag = job_castellan }
						give_job_title = job_castellan
						clr_character_flag = job_castellan
					}
					if = {
						limit = { has_character_flag = job_chancellor }
						give_job_title = job_chancellor
						clr_character_flag = job_chancellor
					}
					if = {
						limit = { has_character_flag = job_marshal }
						give_job_title = job_marshal
						clr_character_flag = job_marshal
					}
					if = {
						limit = { has_character_flag = job_treasurer }
						give_job_title = job_treasurer
						clr_character_flag = job_treasurer
					}
					if = {
						limit = { has_character_flag = job_spymaster }
						give_job_title = job_spymaster
						clr_character_flag = job_spymaster
					}
					if = {
						limit = { has_character_flag = job_spiritual }
						give_job_title = job_spiritual
						clr_character_flag = job_spiritual
					}
					if = {
						limit = { has_character_flag = job_priest }
						give_job_title = job_priest
						clr_character_flag = job_priest
					}
					if = {
						limit = { has_character_flag = title_high_admiral }
						give_minor_title = title_high_admiral
						clr_character_flag = title_high_admiral
					}
					if = {
						limit = { has_character_flag = title_high_admiral_B }
						give_minor_title = title_high_admiral_B
						clr_character_flag = title_high_admiral_B
					}
					if = {
						limit = { has_character_flag = title_small_council_advisor }
						give_minor_title = title_small_council_advisor
						clr_character_flag = title_small_council_advisor
					}
					if = {
						limit = { has_character_flag = title_councilmember_king }
						give_minor_title = title_councilmember_king
						clr_character_flag = title_councilmember_king
					}
					if = {
						limit = { has_character_flag = title_councilmember_emperor }
						give_minor_title = title_councilmember_emperor
						clr_character_flag = title_councilmember_emperor
					}
					if = {
						limit = { has_character_flag = title_regent }
						give_minor_title = title_regent
						clr_character_flag = title_regent
					}
				}	
			}	
			opinion = {
				who = FROM
				modifier = opinion_raised_to_nobility
				years = 10
			}			
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	house_customiser_target = {	
		ai_target_filter = court
		filter = all
		only_playable = yes
		
		from_potential = {
			ai = no
			is_ruler = yes
			trait = house_customizer
		}
		potential = {
			NOT = { dynasty = FROM }
			NOT = { dynasty = 0 }
			NOT = { trait = dragon }
		}
		allow = {
			FROM = { NOT = { is_nomadic = yes } }
			OR = {
				FROM = { is_patrician = no }
				NOR = {
					is_patrician = yes
					any_dynasty_member = { is_patrician = yes is_alive = yes }
				}
			}
			# OR = {
				# FROM = { is_nomadic = no }
				# NOR = {
					# is_nomadic = yes
					# any_dynasty_member = { is_nomadic = yes is_alive = yes }
				# }
			# }
			# OR = {
				# AND = {
					# is_older_than = FROM
					# age_diff = { who = FROM years = 13 }
					# OR = {
						# is_female = no
						# is_married_matrilineally = yes
					# }
					# OR = {
						# is_female = yes
						# is_married_matrilineally = no
						# is_married = no
					# }
				# }
				# father_even_if_dead = {
					# OR = {
						# AND = {
							# FROM = { NOT = { age_diff = { who = ROOT years = 20 } } }
							# dynasty = PREV
							# is_older_than = FROM
						# }	
						# father_even_if_dead = {
							# OR = {
								# AND = {
									# FROM = { age_diff = { who = ROOT years = 15 } }
									# dynasty = PREV
									# is_older_than = FROM
								# }	
								# father_even_if_dead = {
									# FROM = { age_diff = { who = ROOT years = 30 } }
									# dynasty = PREV
									# is_older_than = FROM
								# }
							# }	
						# }
						# mother_even_if_dead = {
							# FROM = { age_diff = { who = ROOT years = 15 } }
							# dynasty = PREV
							# is_older_than = FROM
						# }
					# }	
				# }
				# mother_even_if_dead = {
					# OR = {
						# AND = {
							# FROM = { NOT = { age_diff = { who = ROOT years = 20 } } }
							# dynasty = PREV
							# is_older_than = FROM
						# }	
						# father_even_if_dead = {
							# FROM = { age_diff = { who = ROOT years = 15 } }
							# dynasty = PREV
							# is_older_than = FROM
						# }
						# mother_even_if_dead = {
							# FROM = { age_diff = { who = ROOT years = 15 } }
							# dynasty = PREV
							# is_older_than = FROM
						# }
					# }	
				# }
			# }
		}
		effect = {
			FROM = {
				dynasty = ROOT
				any_child = { dynasty = ROOT }
				character_event = { id = customizer_houses.3 tooltip = TOOLTIPcustomizer_houses.3 }
				hidden_tooltip = { remove_trait = house_customizer }
				recalc_succession = yes
				chronicle = {
					entry = CHRONICLE_HOUSE_CUSTOMISER
					portrait = [This.GetID]
				}	
			}	
			recalc_succession = yes			
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	hykrooni_take_concubine = {
		ai_target_filter = home_court
		filter = home_court
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes
			OR = {
				has_dlc = "The Old Gods"
				ai = yes
			}
			is_female = no			
			OR = {
				culture = kayakayanayan
				culture = samyrianan
				culture = bayasabhadi
			}	
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			is_theocracy = no
		}
	
		potential = {
			host = { character = FROM }
			liege = { character = FROM }			
			is_female = yes			
			NOT = { trait = dragon }
			NOT = { culture_group = winter_group }	
			NOT = { culture_group = unoccupied_group }				
		}
		allow = {
			FROM = { 
				is_adult = yes
				NOT = { num_of_consorts = 20 } # Max religion allows
				prisoner = no
				NOT = { trait = incapable }
			}
			NOT = { is_close_relative = FROM }
			is_married = no
			is_betrothed = no
			is_consort = no
			is_ruler = no
			age = 15
			NOT = { trait = incapable }
			NOT	= { trait = slave }
			NOT = { has_opinion_modifier = { who = FROM modifier = opinion_set_aside } }
		}
		effect = {
			add_consort = FROM
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.05
			}
			modifier = {
				factor = 0
				FROM = { num_of_consorts = 6 }
			}
			modifier = {
				factor = 0
				FROM = {
					num_of_consorts = 4
					any_child = {
						is_alive = yes
						is_female = no
						OR = {
							trait = fair
							trait = strong
							trait = tall
						}
						NOT = { trait = eunuch }
					}
				}	
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						trait = chaste
						trait = celibate
						trait = homosexual
						trait = eunuch
					}
				}	
			}
			modifier = {
				factor = 0
				NOT = { reverse_opinion = { who = FROM value = -19 } }
			}
			modifier = {
				factor = 0
				trait = celibate
			}
			modifier = {
				factor = 0
				age = 35
			}
			modifier = {
				factor = 0
				trait = ugly
			}
			modifier = {
				factor = 3
				trait = fair
			}
			modifier = {
				factor = 0
				trait = dwarf
			}
			modifier = {
				factor = 3
				trait = tall
			}
			modifier = {
				factor = 0
				is_weak_trigger = yes
			}
			modifier = {
				factor = 3
				trait = strong
			}
		}
	}
		
	prisoner_to_oubilette = {
		filter = court
		ai_target_filter = court
		only_playable = yes
		
		from_potential = {
			ai = no
		}
	
		potential = {
			host = { character = FROM }
			prisoner = yes
			NOT = { has_character_modifier = the_oubliette }
		}
		allow = {
			prisoner = yes
		}
		effect = {
			add_character_modifier = { 
				name = the_oubliette
				duration = -1
			}
			hidden_tooltip = {
				remove_character_modifier = the_dungeon
				remove_character_modifier = house_arrest
			}
			FROM = {
				if = {
					limit = {
						NOR = {
							trait = cruel
							trait = kind
						}
					}
					random = {
						chance = 25
						add_trait = cruel
						hidden_tooltip = { character_event = { id = 38259 } }
					}
				}

				if = {
					limit = { trait = kind }
					random = { 
						chance = 50
						remove_trait = kind
						hidden_tooltip = {
							character_event = { id = 38307 }
						}
					}
					hidden_tooltip = {
						random_list = {
							30 = {
								add_trait = stressed
								hidden_tooltip = { character_event = { id = 38282 } }
							}
							10 = {
								add_trait = depressed
								hidden_tooltip = { character_event = { id = 38288 } }
							}
							60 = {
								#nothing
							}
						}
					}
				}	
				hidden_tooltip = { change_variable = { which = "lifestyle_impaler" value = 1 } }
				hidden_tooltip = { character_event = { id = 45361 days = 1 } }#check for tyranny for going against council
			}	
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	prisoner_to_dungeon = {
		filter = court
		ai_target_filter = court
		only_playable = yes
		
		from_potential = {
			ai = no
		}
	
		potential = {
			host = { character = FROM }
			prisoner = yes
			OR = {
				has_character_modifier = the_oubliette
				has_character_modifier = house_arrest
			}
		}
		allow = {
			prisoner = yes
		}
		effect = {
			add_character_modifier = { 
				name = the_dungeon
				duration = -1
			}
			hidden_tooltip = {
				remove_character_modifier = the_oubliette
				remove_character_modifier = house_arrest
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	prisoner_to_suite = {
		filter = court
		ai_target_filter = court
		only_playable = yes
		
		from_potential = {
			ai = no
		}
	
		potential = {
			host = { character = FROM }
			prisoner = yes
			NOT = { has_character_modifier = house_arrest }
		}
		allow = {
			prisoner = yes
		}
		effect = {
			add_character_modifier = { 
				name = house_arrest
				duration = -1
			}
			hidden_tooltip = {
				remove_character_modifier = the_oubliette
				remove_character_modifier = the_dungeon
				character_event = { id = ZE.12219 } # Loses pet rat
			}
		}
		
		revoke_allowed = {
			always = no
		}
		
		ai_will_do = {
			factor = 0
		}
	}
	
	offer_quest = {
		ai_target_filter = home_court
		filter = home_court
		only_playable = yes
		
		from_potential = {
			ai = no
			is_ruler = yes						
			is_theocracy = no
			NOT = { dynasty = 0 }
			NOT = { culture = moon_clansman }
			NOT = { culture_group = free_folk }
		}
	
		potential = {
			host = { character = FROM }
			liege = { character = FROM }			
			is_close_relative = FROM
			dynasty = FROM		
			is_ruler = no
			OR = {
				is_female = no
				culture = kayakayanayan
				culture = samyrianan
				culture = bayasabhadi
			}
			NOT = { trait = dragon }
			NOT = { culture_group = winter_group }	
			NOT = { culture_group = unoccupied_group }	
			age = 14
			NOT = { age = 30 }			
		}
		allow = {
			FROM = { 
				wealth = 50 
				prisoner = no
				NOT = { trait = incapable }
				age = 16
				war = no 
				OR = {
					is_patrician = yes
					higher_tier_than = COUNT
				}
			}
			NOT = { is_inaccessible_trigger = yes }
			in_command = no
			prisoner = no
			age = 18
			NOT = { age = 30 }			
			NOT = { trait = content }
			NOT = { trait = slothful }
			has_epidemic = no
			is_ill = no
			NOT = { has_severe_disability_trigger = yes }		
			NOT = { trait = slave }
			NOT = { trait = kingsguard }
			NOT = { trait = nightswatch }
			NOT = { trait = maester }
			NOT = { trait = archmaester }
			is_priest = no			
			NOT = { is_inaccessible_trigger = yes }
			NOT = { has_minor_title = title_triarch }
			NOT = { has_character_modifier = went_on_foreign_tour }
			custom_tooltip = {
				text = TOOLTIPrejected_adventure
				hidden_tooltip = { NOT = { has_character_flag = rejected_adventure } }
			}	
		}
		effect = {
			character_event = { id = wikid.292 tooltip = TOOLTIPwikid.292 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	nominate_military_command = { #So we can alter description
		ai_target_filter = home_court
		filter = home_court
		only_rulers = yes
		
		from_potential = {
			is_ruler = yes			
			government = military_command_government
			liege = { NOT = { character = PREV } }
			NOT = { tier = BARON }
		}
	
		potential = {
			dynasty = FROM
			NOT = { character = FROM }
			liege = { character = FROM }
		}
		allow = {
			FROM = {
				OR = {
					has_regent = no
					regent = { opinion = { who = ROOT value = 0 } }
				}
				custom_tooltip = {
					text = TOOLTIPnominate_military_commandA
					hidden_tooltip = {
						ROOT = { NOT = { has_minor_title = title_military_command_successor } }
						NOT = {
							any_dynasty_member = {
								has_minor_title = title_military_command_successor
								liege = { character = PREVPREV }
							}
						}
					}	
				}	
				liege = { NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_rejected_military_command } } }
				custom_tooltip = {
					text = TOOLTIPnominate_military_commandB
					hidden_tooltip = { NOT = { has_character_flag = nominate_military_command } }
				}	
			}
			is_female = no
			prisoner = no
			NOT = { trait = incapable }
			age = 16
			is_priest = no
			NOT = { trait = maester }
			NOT = { trait = archmaester }
			NOT = { trait = nightswatch }
			NOT = { trait = kingsguard }
		}
		effect = {		
			FROM = {
				set_character_flag = nominate_military_command
				liege = { letter_event = { id = dynasty.60 days = 2 tooltip = TOOLTIPdynasty.60 } }
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.02 # Less likely to do it
			}
			modifier = {
				factor = 5
				FROM = { trait = familyperson }
			}
			modifier = {
				factor = 3
				is_child_of = FROM
			}
			modifier = {
				factor = 2
				sibling = FROM
			}
			modifier = {
				factor = 0.25
				NOT = { is_close_relative = FROM }
			}
			modifier = {
				factor = 0
				NOT = { is_close_relative = FROM }
				NOT = { reverse_opinion = { who = FROM value = -15 } }
			}
			modifier = {
				factor = 0
				FROM = {
					NOT = { trait = familyperson }
					OR = {
						trait = just
						trait = honorable
					}
				}
				NOT = { martial = 8 }
			}
			modifier = {
				factor = 0.5
				NOT = { reverse_opinion = { who = FROM value = -66 } }
			}
			modifier = {
				factor = 0.5
				NOT = { reverse_opinion = { who = FROM value = -33 } }
			}
			modifier = {
				factor = 2
				reverse_opinion = { who = FROM value = 33 }
			}
			modifier = {
				factor = 2
				reverse_opinion = { who = FROM value = 66 }
			}
			modifier = {
				factor = 0.5
				NOT = { martial = 5 }
			}
			modifier = {
				factor = 0.5
				NOT = { martial = 8 }
			}
			modifier = {
				factor = 2
				martial = 11
			}
			modifier = {
				factor = 2
				martial = 14
			}
		}
	}
	
	nominate_prince = { #Pentos/Lorath fill vacant Prince position
		ai_target_filter = home_court
		filter = sub_realm
		only_playable = yes
		
		from_potential = {
			is_ruler = yes	
			is_republic = yes
			OR = {
				AND = {
					has_landed_title = k_pentos
					d_prince_pentos = {
						OR = {
							has_holder = no
							holder = PREV
						}
					}
				}	
				AND = {
					has_landed_title = k_lorath
					d_prince_lorath = {
						OR = {
							has_holder = no
							holder = PREV
						}
					}
				}
			}	
		}
	
		potential = {
			NOT = { character = FROM }
			NOT = { trait = dragon }
			NOT = { trait = slave }
			is_liege_or_above = FROM
		}
		allow = {
			FROM = {
				OR = {
					has_regent = no
					regent = { opinion = { who = ROOT value = 0 } }
				}	
			}
			is_female = no
			age = 14
			NOT = { age = 40 }
			is_ruler = no
			is_primary_heir = no
			prisoner = no
			NOT = { trait = incapable }
			NOT = { trait = eunuch }
			NOT = { trait = blinded }
			NOT = { trait = maester }
			NOT = { is_inaccessible_trigger = yes }
		}
		effect = {
			piety = 50
			if = {
				limit = {
					FROM = {
						has_landed_title = k_pentos
						d_prince_pentos = {
							OR = {
								has_holder = no
								holder = PREV
							}
						}
					}
				}
				d_prince_pentos = { gain_title = ROOT }
				b_princespalace = {
					if = {
						limit = { 
							holder_scope = { 
								OR = {
									character = FROM
									is_liege_or_above = FROM
								}
							}
						}
						gain_title = ROOT
					}
				}
				add_weak_claim = k_pentos
				hidden_tooltip = { character_event = { id = free_cities.1025 } }
			}	
			if = {
				limit = {
					is_ruler = no
					FROM = {
						has_landed_title = k_lorath
						d_prince_lorath = {
							OR = {
								has_holder = no
								holder = PREV
							}
						}
					}
				}
				d_prince_lorath = { gain_title = ROOT }
				b_great_tower = {
					if = {
						limit = { 
							holder_scope = { 
								OR = {
									character = FROM
									is_liege_or_above = FROM
								}
							}
						}
						gain_title = ROOT
					}
				}
				add_weak_claim = k_lorath
				hidden_tooltip = { character_event = { id = free_cities.11025 } }
			}	
			add_trait = disinherited
			recalc_succession = yes
			if = {
				limit = { NOT = { liege = { character = FROM } } }
				set_defacto_liege = FROM
			}
			FROM = { hidden_tooltip = { character_event = { id = 45361 days = 1 } } }#check for tyranny for going against council
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.05
			}
			modifier = {
				factor = 0
				OR = {
					NOT = { reverse_opinion = { who = FROM value = 0 } }
					NOT = { religion = FROM }
					AND = {
						NOT = { culture_group = FROM }
						FROM = { NOT = { culture = high_valyrian } }
					}
				}	
			}
		}
	}

	wedding_0 = {
		ai_target_filter = home_court
		filter = home_court
		is_high_prio = yes
		only_playable = yes
		
		from_potential = {
			is_playable = yes
		}
		potential = {
			dynasty = FROM
			age = 14
			is_married = yes
			has_character_modifier = wedding		
			spouse = {
				age = 14
				OR = {
					NOT = { age = 16 }
					NOT = { has_regent = yes }
				}	
				OR = {
					is_female = no
					is_main_spouse = yes
				}
			}
			OR = {
				NOT = { age = 16 }
				NOT = { has_regent = yes }
			}	
			OR = {
				is_female = no
				is_main_spouse = yes
			}
			OR = {
				character = FROM
				AND = {		
					is_ruler = no		
					liege = { character = FROM }
					OR = {
						is_child_of = FROM
						father_even_if_dead = { is_child_of = FROM is_ruler = no }
						mother_even_if_dead = { is_child_of = FROM is_ruler = no }
						AND = {
							is_primary_heir = FROM
							FROM = { primary_title = { NOT = { has_law = succ_feudal_elective } } }
						}	
					}				
				}
			}	
		}
		allow = {
			FROM = {
				capital_holding = { is_occupied = no }
				prisoner = no
				NOT = { is_inaccessible_trigger = yes }
				NOT = { has_character_modifier = holding_ball }
				#prestige = 50
				custom_tooltip = {
					text = is_not_busy_trigger_tooltip
					hidden_tooltip = { NOT = { has_character_flag = do_not_disturb } }
				}
			}	
			prisoner = no
			NOT = { is_inaccessible_trigger = yes }
		}
		effect = {
			custom_tooltip = { text = TOOLTIPWEDDING_0 }
			FROM = {
				add_character_modifier = {
					name = holding_ball
					duration = 365
				}	
				hidden_tooltip = { 
					character_event = { id = wedding.999 days = 500 } #flag safety catch
					character_event = { id = wedding.599 } #set host scope
					set_character_flag = do_not_disturb				
				} 
				if = {
					limit = { higher_tier_than = DUKE }
					wealth = -75
				}
				if = {
					limit = { tier = DUKE }
					wealth = -40
				}
				if = {
					limit = { lower_tier_than = DUKE }
					wealth = -20
				}
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			
			modifier = {
				factor = 0.2
			}
			modifier = {
				factor = 1.5
				FROM = {
					OR = {
						has_character_modifier = wedding
						current_heir = {
							has_character_modifier = wedding
							dynasty = FROM
							liege = { character = FROM }
							is_ruler = no	
						}					
					}	
				}
			}	
			modifier = {
				factor = 0
				FROM = {
					OR = {
						AND = {
							higher_tier_than = DUKE
							NOT = { wealth = 200 }
						}
						AND = {
							tier = DUKE
							NOT = { wealth = 100 }
						}
						AND = {
							lower_tier_than = DUKE
							NOT = { wealth = 50 }
						}							
						has_character_modifier = loan_timer
					}	
					OR = {
						stewardship = 9
						trait = temperate
						NOT = { 
							OR = {
								trait = gluttonous 
								trait = hedonist
								trait = slothful
							}	
						}	
					}	
				}
			}					
			modifier = {
				factor = 0.5
				FROM = {
					OR = {
						trait = shy
						trait = greedy
						trait = temperate
						trait = humble
					}	
				}
			}	
			modifier = {
				factor = 5
				FROM = {
					OR = {
						trait = gregarious
						trait = charitable
						trait = gluttonous 
						trait = hedonist
						trait = proud
					}
				}
			}
		}
	}
	#Unrestricted disinheritance
	disinherit_child = {
		ai_target_filter = dynasty
		filter = dynasty
		only_playable = yes
		
		from_potential = {
			is_playable = yes
			has_game_rule = { name = disinheritance_decisions value = unrestricted }	
			is_patrician = no #can nominate heir
			NOT = { primary_title = { has_law = succ_feudal_elective } }
			OR = {
				ai = no
				NOR = { 
					trait = just 
					trait = honorable
					trait = content
				}
			}
			NOT = { nightswatch_culture_trigger = yes }	
		}
		potential = {
			FROM = { #AI will consider heir only
				OR = {
					ai = no
					current_heir = { character = ROOT }
				}
			}	
			OR = {
				is_child_of = FROM
				father_even_if_dead = { is_child_of = FROM }
				mother_even_if_dead = { is_child_of = FROM }
				FROM = { current_heir = { character = ROOT } }
			}	
			NOR = {
				father_even_if_dead = { is_alive = yes NOT = { character = FROM } NOT = { lower_tier_than = FROM } }
				mother_even_if_dead = { is_alive = yes NOT = { character = FROM } NOT = { lower_tier_than = FROM } }
				any_heir_title = { holder_scope = { is_alive = yes NOT = { character = FROM } NOT = { lower_tier_than = FROM } } }
			}			
			is_liege_or_above = FROM
			dynasty = FROM
			age = 10
			is_ruler = no
			can_inherit_titles_trigger = yes		
		}
		allow = {
			FROM = { 
				is_adult = yes
				NOT = { is_incapable = yes }
				prisoner = no
			}		
			NOT = { has_minor_title = title_triarch }	
			NOT = { is_inaccessible_trigger = yes }
			NOT = { trait = incapable }
		}
		
		effect = {
			add_trait = disinherited
			prestige = -100
			if = {
				limit = { 
					NOR = {
						trait = ambitious
						trait = wroth
						trait = proud
						trait = greedy
						trait = just
					}	
				}
				opinion = {
					who = FROM
					modifier = opinion_disinherited_me
					months = 600
				}
			}	
			if = {
				limit = { 
					OR = {
						trait = ambitious
						trait = wroth
						trait = proud
						trait = greedy
						trait = just
					}	
				}
				opinion = {
					who = FROM
					modifier = opinion_disinherited_me
					months = 600
					multiplier = 2
				}
			}	
			FROM = { recalc_succession = yes }
		}
		
		ai_will_do = { 
			factor = 1
			modifier = {
				factor = 0.01
			}
			modifier = {
				factor = 0
				FROM = { #motives
					reverse_opinion = { who = ROOT value = -79 } #intense dislike
					OR = { #useless
						is_adult = no
						stewardship = 8
						martial = 8
						diplomacy = 8
						intrigue = 8
					}	
				}
			}
			modifier = {
				factor = 0
				FROM = { 
					OR = {
						opinion = { who = ROOT value = 25 }					
						NOT = { #no spare heir
							any_child = {
								is_alive = yes
								reverse_opinion = { who = ROOT value = -79 } #intense dislike
								OR = { #useless
									is_adult = no
									stewardship = 8
									martial = 8
									diplomacy = 8
									intrigue = 8
								}
								can_inherit_titles_trigger = yes
							}
						}
					}	
				}
			}
			modifier = {
				factor = 5
				FROM = { 
					OR = {
						trait = ambitious
						trait = ruthless
						trait = wroth
					}	
				}
			}
		}
	}
	send_to_the_citadel = {
		ai_target_filter = dynasty
		filter = dynasty
		only_playable = yes
		
		from_potential = {
			ai = no
			has_game_rule = { name = disinheritance_decisions value = unrestricted }	
			maester_culture_trigger = yes
		}
		potential = {
			OR = {
				is_child_of = FROM
				father_even_if_dead = { is_child_of = FROM }
				mother_even_if_dead = { is_child_of = FROM }
				FROM = { current_heir = { character = ROOT } }
			}	
			NOR = {
				father_even_if_dead = { is_alive = yes NOT = { character = FROM } NOT = { lower_tier_than = FROM } }
				mother_even_if_dead = { is_alive = yes NOT = { character = FROM } NOT = { lower_tier_than = FROM } }
				any_heir_title = { holder_scope = { is_alive = yes NOT = { character = FROM } NOT = { lower_tier_than = FROM } } }
			}	
			is_liege_or_above = FROM
			is_female = no
			dynasty = FROM
			age = 10
			NOT = { age = 25 }
			is_ruler = no
			NOT = { has_character_modifier = maester_education }	
			can_press_claims_trigger = yes		
		}
		allow = {
			FROM = { 
				is_adult = yes
				NOT = { is_incapable = yes }
				prisoner = no
			}		
			learning = 8
			NOT = { age = 25 }
			is_married = no
			is_betrothed = no			
			prisoner = no
			NOT = { trait = incapable }
			NOT = { has_minor_title = title_triarch }	
			NOT = { is_inaccessible_trigger = yes }
		}
		
		effect = {
			add_trait = disinherited
			add_character_modifier = {
				name = maester_education
				duration = -1
			}
			set_character_flag = maester_education
			c_the_citadel = {
				holder_scope = {
					ROOT = { move_character = PREV }
				}
			}
			if = {
				limit = {
					NOT = { trait = content }
					NOT = { trait = incapable }
					NOT = { trait = honorable }
					NOT = { trait = scholar }
					OR = {
						is_primary_heir = yes
						trait = ambitious
						is_councillor = yes
						is_voter = yes
						has_ambition = obj_get_married
						has_ambition = obj_wants_landed_title
						has_ambition = obj_become_heir
					}
				}
				opinion = { who = FROM modifier = opinion_sent_me_to_the_citadel }
			}	
			FROM = { recalc_succession = yes }
		}
		
		ai_will_do = { 
			factor = 0
		}
	}
}
